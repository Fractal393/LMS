{"version":3,"file":"CommandBar.Lazy.Example.js","sourceRoot":"../src/","sources":["components/CommandBar/examples/CommandBar.Lazy.Example.tsx"],"names":[],"mappings":";;;IAKa,QAAA,qBAAqB,GAA4B;QACtD,IAAA,8BAAyF,EAAxF,iBAAS,EAAE,oBAA6E,CAAC;QAEhG,IAAM,UAAU,GAAG,KAAK,CAAC,MAAM,EAAiB,CAAC;QAEjD,IAAM,eAAe,GAAG,8BAAgB,CAAC;YACvC,YAAY,CAAC,SAAS,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAC;QAEH,IAAM,SAAS,GAAG,8BAAgB,CAAC;YACjC,IAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;YAEpD,IAAM,YAAY,GAA2B,EAAE,CAAC;YAEhD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,EAAE,CAAC,EAAE,EAAE;gBAClC,YAAY,CAAC,IAAI,CAAC;oBAChB,GAAG,EAAE,cAAY,CAAG;oBACpB,IAAI,EAAE,UAAQ,CAAG;iBAClB,CAAC,CAAC;aACJ;YAED,IAAI,UAAU,CAAC,OAAO,EAAE;gBACtB,YAAY,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;aAClC;YAED,UAAU,CAAC,OAAO,GAAI,UAAU,CAAC;gBAC/B,YAAY,CAAC,YAAY,CAAC,CAAC;YAC7B,CAAC,EAAE,IAAI,CAAuB,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC;YAC1B,OAAO;gBACL;oBACE,GAAG,EAAE,GAAG;oBACR,IAAI,EAAE,MAAM;iBACb;gBACD;oBACE,GAAG,EAAE,MAAM;oBACX,IAAI,EAAE,kBAAkB;oBACxB,YAAY,EAAE;wBACZ,KAAK,EAAE,SAAS;4BACd,CAAC,wBACM,SAAS;gCACZ;oCACE,GAAG,EAAE,SAAS;oCACd,IAAI,EAAE,GAAG;oCACT,QAAQ,EAAE,uCAAsB,CAAC,OAAO;iCACzC;gCACD;oCACE,GAAG,EAAE,WAAW;oCAChB,IAAI,EAAE,kBAAkB;iCACzB;+BAEL,CAAC,CAAC,EAAE;wBACN,YAAY,EAAE,SAAS;wBACvB,eAAe,EAAE,eAAe;qBACjC;iBACF;aACF,CAAC;QACJ,CAAC,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,eAAe,CAAC,CAAC,CAAC;QAE5C,OAAO,CACL;YACE,oBAAC,uBAAU,IAAC,KAAK,EAAE,KAAK,GAAI,CACxB,CACP,CAAC;IACJ,CAAC,CAAC","sourcesContent":["import * as React from 'react';\nimport { CommandBar, ICommandBarItemProps } from 'office-ui-fabric-react/lib/CommandBar';\nimport { ContextualMenuItemType } from 'office-ui-fabric-react/lib/ContextualMenu';\nimport { useConstCallback } from '@uifabric/react-hooks';\n\nexport const CommandBarLazyExample: React.FunctionComponent = () => {\n  const [menuItems, setMenuItems] = React.useState<ICommandBarItemProps[] | undefined>(undefined);\n\n  const timeoutRef = React.useRef<number | null>();\n\n  const onMenuDismissed = useConstCallback(() => {\n    setMenuItems(undefined);\n  });\n\n  const loadItems = useConstCallback(() => {\n    const itemCount = Math.floor(Math.random() * 5) + 1;\n\n    const newMenuItems: ICommandBarItemProps[] = [];\n\n    for (let i = 0; i < itemCount; i++) {\n      newMenuItems.push({\n        key: `sub-item-${i}`,\n        name: `Item ${i}`,\n      });\n    }\n\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    timeoutRef.current = (setTimeout(() => {\n      setMenuItems(newMenuItems);\n    }, 2000) as unknown) as number;\n  });\n\n  const items = React.useMemo((): ICommandBarItemProps[] => {\n    return [\n      {\n        key: 'a',\n        name: 'Test',\n      },\n      {\n        key: 'menu',\n        name: 'Lazy-loaded menu',\n        subMenuProps: {\n          items: menuItems\n            ? [\n                ...menuItems,\n                {\n                  key: 'divider',\n                  name: '-',\n                  itemType: ContextualMenuItemType.Divider,\n                },\n                {\n                  key: 'permanent',\n                  name: 'Permanent option',\n                },\n              ]\n            : [],\n          onMenuOpened: loadItems,\n          onMenuDismissed: onMenuDismissed,\n        },\n      },\n    ];\n  }, [menuItems, loadItems, onMenuDismissed]);\n\n  return (\n    <div>\n      <CommandBar items={items} />\n    </div>\n  );\n};\n"]}