{"version":3,"file":"ResizeGroup.OverflowSet.Example.js","sourceRoot":"../src/","sources":["components/ResizeGroup/examples/ResizeGroup.OverflowSet.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { CommandBarButton } from 'office-ui-fabric-react/lib/Button';\nimport { ResizeGroup } from 'office-ui-fabric-react/lib/ResizeGroup';\nimport { OverflowSet, IOverflowSetStyles } from 'office-ui-fabric-react/lib/OverflowSet';\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\nimport { mergeStyleSets } from 'office-ui-fabric-react';\nimport { useBoolean } from '@uifabric/react-hooks';\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\n\nconst styles = mergeStyleSets({\n  root: {\n    display: 'block',\n  },\n  settingsGroup: {\n    paddingTop: '20px',\n  },\n  itemCountDropdown: {\n    width: '180px',\n  },\n});\n\nconst overflowSetStyles: Partial<IOverflowSetStyles> = { root: { height: 40 } };\nconst dropdownOptions = [\n  { key: '20', text: '20' },\n  { key: '30', text: '30' },\n  { key: '40', text: '40' },\n  { key: '50', text: '50' },\n  { key: '75', text: '75' },\n  { key: '100', text: '100' },\n  { key: '200', text: '200' },\n];\nexport interface IOverflowData {\n  primary: IContextualMenuItem[];\n  overflow: IContextualMenuItem[];\n  cacheKey?: string;\n}\n\nconst generateData = (count: number, cachingEnabled: boolean, checked: boolean): IOverflowData => {\n  const icons = ['Add', 'Share', 'Upload'];\n  const dataItems = [];\n  let cacheKey = '';\n  for (let index = 0; index < count; index++) {\n    const item = {\n      key: `item${index}`,\n      name: `Item ${index}`,\n      icon: icons[index % icons.length],\n      checked: checked,\n    };\n    cacheKey = cacheKey + item.key;\n    dataItems.push(item);\n  }\n  let result: IOverflowData = {\n    primary: dataItems,\n    overflow: [] as any[],\n  };\n  if (cachingEnabled) {\n    result = { ...result, cacheKey };\n  }\n  return result;\n};\n\nconst computeCacheKey = (primaryControls: IContextualMenuItem[]): string => {\n  return primaryControls.reduce((acc, current) => acc + current.key, '');\n};\n\nconst onRenderItem = (item: any) => (\n  <CommandBarButton\n    role=\"menuitem\"\n    text={item.name}\n    iconProps={{ iconName: item.icon }}\n    onClick={item.onClick}\n    checked={item.checked}\n  />\n);\n\nexport const ResizeGroupOverflowSetExample: React.FunctionComponent = () => {\n  const [numberOfItems, setNumberOfItems] = React.useState(20);\n  const [buttonsChecked, { toggle: toggleButtonsChecked }] = useBoolean(false);\n  const [cachingEnabled, { toggle: toggleCachingEnabled }] = useBoolean(false);\n  const [onGrowDataEnabled, { toggle: toggleOnGrowDataEnabled }] = useBoolean(false);\n  const dataToRender = generateData(numberOfItems, cachingEnabled, buttonsChecked);\n\n  const onReduceData = (currentData: any) => {\n    if (currentData.primary.length === 0) {\n      return undefined;\n    }\n    const overflow = [...currentData.primary.slice(-1), ...currentData.overflow];\n    const primary = currentData.primary.slice(0, -1);\n    let cacheKey = undefined;\n    if (cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  };\n\n  const onGrowData = (currentData: any) => {\n    if (currentData.overflow.length === 0) {\n      return undefined;\n    }\n    const overflow = currentData.overflow.slice(1);\n    const primary = [...currentData.primary, ...currentData.overflow.slice(0, 1)];\n    let cacheKey = undefined;\n    if (cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  };\n\n  const onRenderOverflowButton = (overflowItems: any) => (\n    <CommandBarButton role=\"menuitem\" menuProps={{ items: overflowItems! }} />\n  );\n\n  const onRenderData = (data: any) => {\n    return (\n      <OverflowSet\n        role=\"menubar\"\n        items={data.primary}\n        overflowItems={data.overflow.length ? data.overflow : null}\n        onRenderItem={onRenderItem}\n        // eslint-disable-next-line react/jsx-no-bind\n        onRenderOverflowButton={onRenderOverflowButton}\n        styles={overflowSetStyles}\n      />\n    );\n  };\n\n  const onNumberOfItemsChanged = (event: React.FormEvent<HTMLDivElement>, option: IDropdownOption): void => {\n    setNumberOfItems(parseInt(option.text, 10));\n  };\n\n  return (\n    <div>\n      <ResizeGroup\n        role=\"tabpanel\"\n        aria-label=\"Resize Group with an Overflow Set\"\n        data={dataToRender}\n        // eslint-disable-next-line react/jsx-no-bind\n        onReduceData={onReduceData}\n        onGrowData={onGrowDataEnabled ? onGrowData : undefined}\n        // eslint-disable-next-line react/jsx-no-bind\n        onRenderData={onRenderData}\n      />\n      <div className={styles.settingsGroup}>\n        <Toggle label=\"Enable caching\" onChange={toggleCachingEnabled} checked={cachingEnabled} />\n        <Toggle label=\"Enable onGrowData\" onChange={toggleOnGrowDataEnabled} checked={onGrowDataEnabled} />\n        <Toggle label=\"Buttons checked\" onChange={toggleButtonsChecked} checked={buttonsChecked} />\n        <div className={styles.itemCountDropdown}>\n          <Dropdown\n            label=\"Number of items to render\"\n            selectedKey={numberOfItems.toString()}\n            // eslint-disable-next-line react/jsx-no-bind\n            onChange={onNumberOfItemsChanged}\n            options={dropdownOptions}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n"]}