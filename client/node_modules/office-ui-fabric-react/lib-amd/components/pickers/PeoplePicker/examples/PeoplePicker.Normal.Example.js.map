{"version":3,"file":"PeoplePicker.Normal.Example.js","sourceRoot":"../src/","sources":["components/pickers/PeoplePicker/examples/PeoplePicker.Normal.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\nimport { IBasePickerSuggestionsProps, NormalPeoplePicker, ValidationState } from 'office-ui-fabric-react/lib/Pickers';\nimport { people, mru } from '@uifabric/example-data';\n\nconst suggestionProps: IBasePickerSuggestionsProps = {\n  suggestionsHeaderText: 'Suggested People',\n  mostRecentlyUsedHeaderText: 'Suggested Contacts',\n  noResultsFoundText: 'No results found',\n  loadingText: 'Loading',\n  showRemoveButtons: true,\n  suggestionsAvailableAlertText: 'People Picker Suggestions available',\n  suggestionsContainerAriaLabel: 'Suggested contacts',\n};\n\nconst checkboxStyles = {\n  root: {\n    marginTop: 10,\n  },\n};\n\nexport const PeoplePickerNormalExample: React.FunctionComponent = () => {\n  const [delayResults, setDelayResults] = React.useState(false);\n  const [isPickerDisabled, setIsPickerDisabled] = React.useState(false);\n  const [mostRecentlyUsed, setMostRecentlyUsed] = React.useState<IPersonaProps[]>(mru);\n  const [peopleList, setPeopleList] = React.useState<IPersonaProps[]>(people);\n\n  const picker = React.useRef(null);\n\n  const onFilterChanged = (\n    filterText: string,\n    currentPersonas: IPersonaProps[],\n    limitResults?: number,\n  ): IPersonaProps[] | Promise<IPersonaProps[]> => {\n    if (filterText) {\n      let filteredPersonas: IPersonaProps[] = filterPersonasByText(filterText);\n\n      filteredPersonas = removeDuplicates(filteredPersonas, currentPersonas);\n      filteredPersonas = limitResults ? filteredPersonas.slice(0, limitResults) : filteredPersonas;\n      return filterPromise(filteredPersonas);\n    } else {\n      return [];\n    }\n  };\n\n  const filterPersonasByText = (filterText: string): IPersonaProps[] => {\n    return peopleList.filter(item => doesTextStartWith(item.text as string, filterText));\n  };\n\n  const filterPromise = (personasToReturn: IPersonaProps[]): IPersonaProps[] | Promise<IPersonaProps[]> => {\n    if (delayResults) {\n      return convertResultsToPromise(personasToReturn);\n    } else {\n      return personasToReturn;\n    }\n  };\n\n  const returnMostRecentlyUsed = (currentPersonas: IPersonaProps[]): IPersonaProps[] | Promise<IPersonaProps[]> => {\n    return filterPromise(removeDuplicates(mostRecentlyUsed, currentPersonas));\n  };\n\n  const onRemoveSuggestion = (item: IPersonaProps): void => {\n    const indexPeopleList: number = peopleList.indexOf(item);\n    const indexMostRecentlyUsed: number = mostRecentlyUsed.indexOf(item);\n\n    if (indexPeopleList >= 0) {\n      const newPeople: IPersonaProps[] = peopleList\n        .slice(0, indexPeopleList)\n        .concat(peopleList.slice(indexPeopleList + 1));\n      setPeopleList(newPeople);\n    }\n\n    if (indexMostRecentlyUsed >= 0) {\n      const newSuggestedPeople: IPersonaProps[] = mostRecentlyUsed\n        .slice(0, indexMostRecentlyUsed)\n        .concat(mostRecentlyUsed.slice(indexMostRecentlyUsed + 1));\n      setMostRecentlyUsed(newSuggestedPeople);\n    }\n  };\n\n  const onDisabledButtonClick = (): void => {\n    setIsPickerDisabled(!isPickerDisabled);\n  };\n\n  const onToggleDelayResultsChange = (): void => {\n    setDelayResults(!delayResults);\n  };\n\n  return (\n    <div>\n      <NormalPeoplePicker\n        // eslint-disable-next-line react/jsx-no-bind\n        onResolveSuggestions={onFilterChanged}\n        // eslint-disable-next-line react/jsx-no-bind\n        onEmptyInputFocus={returnMostRecentlyUsed}\n        getTextFromItem={getTextFromItem}\n        pickerSuggestionsProps={suggestionProps}\n        className={'ms-PeoplePicker'}\n        key={'normal'}\n        // eslint-disable-next-line react/jsx-no-bind\n        onRemoveSuggestion={onRemoveSuggestion}\n        onValidateInput={validateInput}\n        removeButtonAriaLabel={'Remove'}\n        inputProps={{\n          onBlur: (ev: React.FocusEvent<HTMLInputElement>) => console.log('onBlur called'),\n          onFocus: (ev: React.FocusEvent<HTMLInputElement>) => console.log('onFocus called'),\n          'aria-label': 'People Picker',\n        }}\n        componentRef={picker}\n        onInputChange={onInputChange}\n        resolveDelay={300}\n        disabled={isPickerDisabled}\n      />\n      <Checkbox\n        label=\"Disable People Picker\"\n        checked={isPickerDisabled}\n        // eslint-disable-next-line react/jsx-no-bind\n        onChange={onDisabledButtonClick}\n        styles={checkboxStyles}\n      />\n      <Checkbox\n        label=\"Delay Suggestion Results\"\n        defaultChecked={delayResults}\n        // eslint-disable-next-line react/jsx-no-bind\n        onChange={onToggleDelayResultsChange}\n        styles={checkboxStyles}\n      />\n    </div>\n  );\n};\n\nfunction doesTextStartWith(text: string, filterText: string): boolean {\n  return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\n}\n\nfunction removeDuplicates(personas: IPersonaProps[], possibleDupes: IPersonaProps[]) {\n  return personas.filter(persona => !listContainsPersona(persona, possibleDupes));\n}\n\nfunction listContainsPersona(persona: IPersonaProps, personas: IPersonaProps[]) {\n  if (!personas || !personas.length || personas.length === 0) {\n    return false;\n  }\n  return personas.filter(item => item.text === persona.text).length > 0;\n}\n\nfunction convertResultsToPromise(results: IPersonaProps[]): Promise<IPersonaProps[]> {\n  return new Promise<IPersonaProps[]>((resolve, reject) => setTimeout(() => resolve(results), 2000));\n}\n\nfunction getTextFromItem(persona: IPersonaProps): string {\n  return persona.text as string;\n}\n\nfunction validateInput(input: string): ValidationState {\n  if (input.indexOf('@') !== -1) {\n    return ValidationState.valid;\n  } else if (input.length > 1) {\n    return ValidationState.warning;\n  } else {\n    return ValidationState.invalid;\n  }\n}\n\n/**\n * Takes in the picker input and modifies it in whichever way\n * the caller wants, i.e. parsing entries copied from Outlook (sample\n * input: \"Aaron Reid <aaron>\").\n *\n * @param input The text entered into the picker.\n */\nfunction onInputChange(input: string): string {\n  const outlookRegEx = /<.*>/g;\n  const emailAddress = outlookRegEx.exec(input);\n\n  if (emailAddress && emailAddress[0]) {\n    return emailAddress[0].substring(1, emailAddress[0].length - 1);\n  }\n\n  return input;\n}\n"]}