{"version":3,"file":"Shimmer.Application.Example.js","sourceRoot":"../src/","sources":["components/Shimmer/examples/Shimmer.Application.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { createListItems, IExampleItem } from '@uifabric/example-data';\nimport { IColumn, buildColumns, SelectionMode, Toggle, IListProps } from 'office-ui-fabric-react/lib/index';\nimport { ShimmeredDetailsList } from 'office-ui-fabric-react/lib/ShimmeredDetailsList';\nimport { useSetInterval, useConst, useConstCallback } from '@uifabric/react-hooks';\n\ninterface IShimmerApplicationExampleState {\n  lastIntervalId: number;\n  visibleCount: number;\n}\n\nconst ITEMS_COUNT: number = 200;\nconst INTERVAL_DELAY: number = 1200;\nconst toggleStyle: React.CSSProperties = {\n  marginBottom: '20px',\n};\nconst shimmeredDetailsListProps: IListProps = {\n  renderedWindowsAhead: 0,\n  renderedWindowsBehind: 0,\n};\n\nconst fileIcons: { name: string }[] = [\n  { name: 'accdb' },\n  { name: 'audio' },\n  { name: 'code' },\n  { name: 'csv' },\n  { name: 'docx' },\n  { name: 'dotx' },\n  { name: 'mpt' },\n  { name: 'model' },\n  { name: 'one' },\n  { name: 'onetoc' },\n  { name: 'pdf' },\n  { name: 'photo' },\n  { name: 'pptx' },\n  { name: 'presentation' },\n  { name: 'potx' },\n  { name: 'pub' },\n  { name: 'rtf' },\n  { name: 'spreadsheet' },\n  { name: 'txt' },\n  { name: 'vector' },\n  { name: 'vsdx' },\n  { name: 'xlsx' },\n  { name: 'xltx' },\n  { name: 'xsn' },\n];\n\nconst randomFileIcon = (): { docType: string; url: string } => {\n  const docType: string = fileIcons[Math.floor(Math.random() * fileIcons.length) + 0].name;\n  return {\n    docType,\n    url: `https://static2.sharepointonline.com/files/fabric/assets/item-types/16/${docType}.svg`,\n  };\n};\n\nconst onRenderItemColumn = (item: IExampleItem, index: number, column: IColumn): JSX.Element | string | number => {\n  if (column.key === 'thumbnail') {\n    return <img src={item.thumbnail} />;\n  }\n  return item[column.key as keyof IExampleItem];\n};\n\nconst exampleItems: IExampleItem[] = createListItems(ITEMS_COUNT).map((item: IExampleItem) => {\n  const randomFileType = randomFileIcon();\n  return { ...item, thumbnail: randomFileType.url };\n});\n\nexport const ShimmerApplicationExample: React.FunctionComponent = () => {\n  const { current: state } = React.useRef<IShimmerApplicationExampleState>({\n    lastIntervalId: 0,\n    visibleCount: 0,\n  });\n\n  const [items, setItems] = React.useState<(IExampleItem | null)[] | undefined>(undefined);\n\n  const shimmerColumns: IColumn[] = useConst(() => {\n    const currentItems = createListItems(1);\n    const columns: IColumn[] = buildColumns(currentItems);\n    for (const column of columns) {\n      if (column.key === 'thumbnail') {\n        column.name = 'FileType';\n        column.minWidth = 16;\n        column.maxWidth = 16;\n        column.isIconOnly = true;\n        column.iconName = 'Page';\n        break;\n      }\n    }\n    return columns;\n  });\n\n  const { setInterval, clearInterval } = useSetInterval();\n\n  const loadMoreItems = (): void => {\n    state.visibleCount = Math.min(exampleItems.length, state.visibleCount + 2);\n\n    setItems(exampleItems.map((current, index) => (index < state.visibleCount ? current : null)) as IExampleItem[]);\n  };\n\n  const onLoadData = useConstCallback((ev: React.MouseEvent<HTMLElement>, checked: boolean): void => {\n    state.visibleCount = 0;\n    if (checked) {\n      loadMoreItems();\n      state.lastIntervalId = setInterval(loadMoreItems, INTERVAL_DELAY);\n    } else {\n      setItems(undefined);\n      clearInterval(state.lastIntervalId);\n    }\n  });\n\n  return (\n    <>\n      <Toggle\n        style={toggleStyle}\n        label=\"Toggle to load content\"\n        onChange={onLoadData}\n        onText=\"Content\"\n        offText=\"Shimmer\"\n      />\n      <div>\n        <ShimmeredDetailsList\n          setKey=\"items\"\n          items={items || []}\n          columns={shimmerColumns}\n          selectionMode={SelectionMode.none}\n          onRenderItemColumn={onRenderItemColumn}\n          enableShimmer={!items}\n          ariaLabelForShimmer=\"Content is being fetched\"\n          ariaLabelForGrid=\"Item details\"\n          listProps={shimmeredDetailsListProps}\n        />\n      </div>\n    </>\n  );\n};\n"]}