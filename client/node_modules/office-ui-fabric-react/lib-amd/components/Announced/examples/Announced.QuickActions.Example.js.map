{"version":3,"file":"Announced.QuickActions.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.QuickActions.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Announced } from 'office-ui-fabric-react/lib/Announced';\nimport {\n  DetailsList,\n  DetailsListLayoutMode,\n  Selection,\n  IColumn,\n  IDetailsList,\n} from 'office-ui-fabric-react/lib/DetailsList';\nimport { IconButton, PrimaryButton, IButtonStyles } from 'office-ui-fabric-react/lib/Button';\nimport { Dialog, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\nimport { TextField, ITextField } from 'office-ui-fabric-react/lib/TextField';\nimport { createArray } from 'office-ui-fabric-react/lib/Utilities';\nimport { useConst, useConstCallback } from '@uifabric/react-hooks';\n\nconst iconButtonStyles: Partial<IButtonStyles> = { root: { float: 'right', height: 'inherit' } };\n\ninterface IExampleItem {\n  key: number;\n  name: string;\n}\n\nexport const AnnouncedQuickActionsExample: React.FunctionComponent = () => {\n  const detailsList = React.useRef<IDetailsList>(null);\n  const textField = React.useRef<ITextField>(null);\n  const selection = useConst(() => new Selection());\n  const [items, setItems] = React.useState<IExampleItem[]>(() =>\n    createArray(20, i => ({\n      key: i,\n      name: 'Item ' + i,\n    })),\n  );\n\n  const [dialogContent, setDialogContent] = React.useState<JSX.Element | undefined>(undefined);\n  const [announced, setAnnounced] = React.useState<JSX.Element | undefined>(undefined);\n\n  const deleteItem = useConstCallback((index: number): void => {\n    setItems(prevItems => prevItems.filter((item, i) => i !== index));\n    setAnnounced(<Announced message=\"Item deleted\" aria-live=\"assertive\" />);\n  });\n\n  const renameItem = useConstCallback((item: IExampleItem, index: number): void => {\n    setDialogContent(\n      <>\n        <TextField componentRef={textField} label=\"Rename\" defaultValue={item.name} />\n        <DialogFooter>\n          <PrimaryButton\n            // eslint-disable-next-line react/jsx-no-bind\n            onClick={() => updateItemName(index)}\n            text=\"Save\"\n          />\n        </DialogFooter>\n      </>,\n    );\n    return;\n  });\n\n  const columns = useConst((): IColumn[] => [\n    {\n      name: 'Name',\n      fieldName: 'name',\n      key: 'name',\n      minWidth: 100,\n      maxWidth: 200,\n      onRender: (item: IExampleItem, index: number) => (\n        <div>\n          {item.name}\n          <IconButton\n            menuIconProps={{ iconName: 'MoreVertical' }}\n            role=\"button\"\n            aria-haspopup\n            aria-label=\"Show actions\"\n            styles={iconButtonStyles}\n            menuProps={{\n              items: [\n                {\n                  key: 'delete',\n                  text: 'Delete',\n                  onClick: () => deleteItem(index),\n                },\n                {\n                  key: 'rename',\n                  text: 'Rename',\n                  onClick: () => renameItem(item, index),\n                },\n              ],\n            }}\n          />\n        </div>\n      ),\n    },\n  ]);\n\n  const updateItemName = useConstCallback((index: number) => {\n    if (textField && textField.current) {\n      setItems(prevItems => {\n        const renamedItems = [...prevItems];\n        renamedItems[index] = { ...prevItems[index], name: textField.current?.value || renamedItems[index].name };\n        return renamedItems;\n      });\n      setDialogContent(undefined);\n      setAnnounced(<Announced message=\"Item renamed\" aria-live=\"assertive\" />);\n    }\n  });\n\n  const closeRenameDialog = useConstCallback((): void => {\n    setDialogContent(undefined);\n  });\n\n  return (\n    <>\n      {announced}\n      <DetailsList\n        componentRef={detailsList}\n        items={items}\n        columns={columns}\n        layoutMode={DetailsListLayoutMode.fixedColumns}\n        selection={selection}\n        selectionPreservedOnEmptyClick\n        ariaLabelForSelectionColumn=\"Toggle selection\"\n        ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n      />\n      <Dialog hidden={!dialogContent} onDismiss={closeRenameDialog} closeButtonAriaLabel=\"Close\">\n        {dialogContent}\n      </Dialog>\n    </>\n  );\n};\n"]}