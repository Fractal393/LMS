{"version":3,"file":"ExtendedPeoplePicker.Basic.Example.js","sourceRoot":"../src/","sources":["components/ExtendedPicker/examples/ExtendedPeoplePicker.Basic.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\nimport { ExtendedPeoplePicker } from 'office-ui-fabric-react/lib/ExtendedPicker';\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\nimport { SuggestionsStore, FloatingPeoplePicker } from 'office-ui-fabric-react/lib/FloatingPicker';\nimport { SelectedPeopleList, IExtendedPersonaProps } from 'office-ui-fabric-react/lib/SelectedItemsList';\nimport { FocusZoneTabbableElements } from 'office-ui-fabric-react/lib/FocusZone';\nimport { mergeStyleSets, getTheme } from 'office-ui-fabric-react/lib/Styling';\nimport { people, mru, groupOne, groupTwo } from '@uifabric/example-data';\nimport { useConst } from '@uifabric/react-hooks';\n\nconst theme = getTheme();\n\nconst startsWith = (text: string, filterText: string): boolean => {\n  return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\n};\n\nconst classNames = mergeStyleSets({\n  picker: { maxWidth: 400, marginBottom: 15 },\n  headerItem: {\n    borderBottom: '1px solid ' + theme.palette.neutralLight,\n    padding: '8px 12px',\n  },\n  footerItem: {\n    borderBottom: '1px solid ' + theme.palette.neutralLight,\n    height: 60,\n    paddingLeft: 12,\n  },\n  to: { padding: '0 10px' },\n});\n\nconst focusZoneProps = {\n  shouldInputLoseFocusOnArrowKey: () => true,\n  handleTabKey: FocusZoneTabbableElements.all,\n};\n\nexport const ExtendedPeoplePickerBasicExample: React.FunctionComponent = () => {\n  const picker = React.useRef<ExtendedPeoplePicker>(null);\n  const [peopleList, setPeopleList] = React.useState<IPersonaProps[]>(people);\n  const [mostRecentlyUsed, setMostRecentlyUsed] = React.useState<IPersonaProps[]>(mru);\n  const [searchMoreAvailable, setSearchMoreAvailable] = React.useState<boolean>(true);\n\n  const getEditingItemText = (item: IExtendedPersonaProps): string => {\n    return item.text as string;\n  };\n\n  const onSetFocusButtonClicked = React.useCallback((): void => {\n    picker.current?.focus();\n  }, []);\n\n  const onExpandItem = (item: IExtendedPersonaProps): void => {\n    const selectedItemsList = picker.current?.selectedItemsList.current;\n    if (selectedItemsList) {\n      (selectedItemsList as SelectedPeopleList).replaceItem(item, getExpandedGroupItems(item));\n    }\n  };\n\n  const onRemoveSuggestion = (item: IPersonaProps): void => {\n    const itemIndex = peopleList.indexOf(item);\n    const itemMruIndex = mostRecentlyUsed.indexOf(item);\n    if (itemIndex >= 0) {\n      setPeopleList(peopleList.slice(0, itemIndex).concat(peopleList.slice(itemIndex + 1)));\n    }\n    if (itemMruIndex >= 0) {\n      setMostRecentlyUsed(mostRecentlyUsed.slice(0, itemMruIndex).concat(mostRecentlyUsed.slice(itemMruIndex + 1)));\n    }\n  };\n\n  const onFilterChanged = (filterText: string, currentPersonas?: IPersonaProps[]): Promise<IPersonaProps[]> | null => {\n    let filteredPersonas: IPersonaProps[] = [];\n    if (filterText) {\n      filteredPersonas = peopleList.filter((item: IPersonaProps) => startsWith(item.text || '', filterText));\n      filteredPersonas = removeDuplicates(filteredPersonas, currentPersonas);\n    }\n    return convertResultsToPromise(filteredPersonas);\n  };\n\n  const returnMostRecentlyUsed = (): IPersonaProps[] | Promise<IPersonaProps[]> | null => {\n    let currentMostRecentlyUsed = mostRecentlyUsed;\n    const items = picker.current?.items || [];\n    currentMostRecentlyUsed = removeDuplicates(currentMostRecentlyUsed, items);\n    return convertResultsToPromise(currentMostRecentlyUsed);\n  };\n\n  const onCopyItems = (items: IExtendedPersonaProps[]): string => {\n    return items.map(item => item.text).join(', ');\n  };\n\n  const shouldShowForceResolve = (): boolean => {\n    const floatingPicker = picker.current?.floatingPicker.current;\n    return !!floatingPicker && validateInput(floatingPicker.inputText) && floatingPicker.suggestions.length === 0;\n  };\n\n  const shouldShowSuggestedContacts = (): boolean => {\n    return picker.current?.inputElement?.value === '';\n  };\n\n  const listContainsPersona = (persona: IPersonaProps, personas?: IPersonaProps[]): boolean => {\n    return !!personas && personas.some((item: IPersonaProps) => item.text === persona.text);\n  };\n\n  const removeDuplicates = (personas: IPersonaProps[], possibleDupes?: IPersonaProps[]): IPersonaProps[] => {\n    return personas.filter((persona: IPersonaProps) => !listContainsPersona(persona, possibleDupes));\n  };\n\n  const onInputChanged = (): void => {\n    setSearchMoreAvailable(true);\n  };\n\n  const convertResultsToPromise = (results: IPersonaProps[]): Promise<IPersonaProps[]> => {\n    return new Promise<IPersonaProps[]>(resolve => setTimeout(() => resolve(results), 150));\n  };\n\n  const validateInput = (input: string): boolean => {\n    return input.indexOf('@') !== -1;\n  };\n\n  const getExpandedGroupItems = (item: IExtendedPersonaProps): IExtendedPersonaProps[] => {\n    return item.text === 'Group One' ? groupOne : item.text === 'Group Two' ? groupTwo : [];\n  };\n\n  const suggestionProps = useConst({\n    showRemoveButtons: true,\n    headerItemsProps: [\n      {\n        renderItem: () => {\n          return (\n            <div className={classNames.headerItem}>Use this address: {picker.current?.inputElement?.value || ''}</div>\n          );\n        },\n        shouldShow: () => {\n          return !!picker.current?.inputElement && picker.current.inputElement.value.indexOf('@') > -1;\n        },\n        onExecute: () => {\n          const floatingPicker = picker.current?.floatingPicker.current;\n          if (floatingPicker) {\n            floatingPicker.forceResolveSuggestion();\n          }\n        },\n        ariaLabel: 'Use the typed address',\n      },\n      {\n        renderItem: () => {\n          return <div className={classNames.headerItem}>Suggested Contacts</div>;\n        },\n        shouldShow: shouldShowSuggestedContacts,\n      },\n    ],\n    footerItemsProps: [\n      {\n        renderItem: () => {\n          return <div className={classNames.footerItem}>No results</div>;\n        },\n        shouldShow: () => {\n          const floatingPicker = picker.current?.floatingPicker.current;\n          return !!floatingPicker && floatingPicker.suggestions.length === 0;\n        },\n      },\n      {\n        renderItem: () => {\n          return <div className={classNames.footerItem}>Search for more</div>;\n        },\n        onExecute: () => {\n          setSearchMoreAvailable(false);\n        },\n        shouldShow: () => {\n          return searchMoreAvailable && !shouldShowSuggestedContacts();\n        },\n        ariaLabel: 'Search more',\n      },\n    ],\n    shouldSelectFirstItem: () => {\n      return !shouldShowSuggestedContacts();\n    },\n  });\n\n  const floatingPickerProps = {\n    suggestionsStore: new SuggestionsStore<IPersonaProps>(),\n    onResolveSuggestions: onFilterChanged,\n    getTextFromItem: (persona: IPersonaProps) => persona.text || '',\n    pickerSuggestionsProps: suggestionProps,\n    key: 'normal',\n    onRemoveSuggestion: onRemoveSuggestion,\n    onValidateInput: validateInput,\n    onZeroQuerySuggestion: returnMostRecentlyUsed,\n    showForceResolve: shouldShowForceResolve,\n    onInputChanged: onInputChanged,\n    onSuggestionsHidden: () => {\n      console.log('FLOATINGPICKER: hidden');\n    },\n    onSuggestionsShown: () => {\n      console.log('FLOATINGPICKER: shown');\n    },\n  };\n\n  const selectedItemsListProps = {\n    onCopyItems: onCopyItems,\n    onExpandGroup: onExpandItem,\n    removeMenuItemText: 'Remove',\n    copyMenuItemText: 'Copy name',\n    editMenuItemText: 'Edit',\n    getEditingItemText: getEditingItemText,\n    onRenderFloatingPicker: FloatingPeoplePicker,\n    floatingPickerProps: floatingPickerProps,\n  };\n\n  return (\n    <div>\n      <ExtendedPeoplePicker\n        floatingPickerProps={floatingPickerProps}\n        selectedItemsListProps={selectedItemsListProps}\n        onRenderFloatingPicker={FloatingPeoplePicker}\n        onRenderSelectedItems={SelectedPeopleList}\n        className={classNames.picker}\n        key=\"normal\"\n        inputProps={{\n          onBlur: () => console.log('onBlur called'),\n          onFocus: () => console.log('onFocus called'),\n          'aria-label': 'People Picker',\n        }}\n        componentRef={picker}\n        headerComponent={\n          <div className={classNames.to} data-is-focusable>\n            To:\n          </div>\n        }\n        focusZoneProps={focusZoneProps}\n      />\n      <PrimaryButton text=\"Set focus\" onClick={onSetFocusButtonClicked} />\n    </div>\n  );\n};\n"]}