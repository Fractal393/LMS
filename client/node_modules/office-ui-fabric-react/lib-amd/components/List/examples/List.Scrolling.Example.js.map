{"version":3,"file":"List.Scrolling.Example.js","sourceRoot":"../src/","sources":["components/List/examples/List.Scrolling.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { FocusZone, FocusZoneDirection } from 'office-ui-fabric-react/lib/FocusZone';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\nimport { List, ScrollToMode, IList } from 'office-ui-fabric-react/lib/List';\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\nimport { createListItems, IExampleItem } from '@uifabric/example-data';\nimport { mergeStyleSets, getTheme, normalize } from 'office-ui-fabric-react/lib/Styling';\nimport { useConst } from '@uifabric/react-hooks';\n\nconst evenItemHeight = 25;\nconst oddItemHeight = 50;\nconst numberOfItemsOnPage = 10;\nconst theme = getTheme();\nconst dropdownOptions = [\n  { key: 'auto', text: 'Auto' },\n  { key: 'top', text: 'Top' },\n  { key: 'bottom', text: 'Bottom' },\n  { key: 'center', text: 'Center' },\n];\n\nconst styles = mergeStyleSets({\n  container: {\n    overflow: 'auto',\n    maxHeight: 400,\n    border: '1px solid #CCC',\n    marginTop: 20,\n    selectors: {\n      '.ms-List-cell:nth-child(odd)': {\n        height: 50,\n        lineHeight: 50,\n        background: theme.palette.neutralLighter,\n      },\n      '.ms-List-cell:nth-child(even)': {\n        height: 25,\n        lineHeight: 25,\n      },\n    },\n  },\n  itemContent: [\n    theme.fonts.medium,\n    normalize,\n    {\n      position: 'relative',\n      boxSizing: 'border-box',\n      display: 'block',\n      borderLeft: '3px solid ' + theme.palette.themePrimary,\n      paddingLeft: 27,\n    },\n  ],\n});\n\nconst onRenderCell = (item: IExampleItem, index: number): JSX.Element => {\n  return (\n    <div data-is-focusable>\n      <div className={styles.itemContent}>\n        {index} &nbsp; {item.name}\n      </div>\n    </div>\n  );\n};\n\nexport const ListScrollingExample: React.FunctionComponent = () => {\n  const items = useConst(() => createListItems(5000));\n  const [selectedIndex, setSelectedIndex] = React.useState(0);\n  const [scrollToMode, setScrollToMode] = React.useState<ScrollToMode>(ScrollToMode.auto);\n  const listRef: React.RefObject<IList> = React.useRef(null);\n\n  const scroll = (index: number, propScrollToMode: ScrollToMode): void => {\n    const updatedSelectedIndex = Math.min(Math.max(index, 0), items.length - 1);\n    setSelectedIndex(updatedSelectedIndex);\n    setScrollToMode(propScrollToMode);\n\n    listRef.current?.scrollToIndex(\n      updatedSelectedIndex,\n      idx => (idx % 2 === 0 ? evenItemHeight : oddItemHeight),\n      scrollToMode,\n    );\n  };\n\n  const getPageHeight = (idx: number): number => {\n    let h = 0;\n    for (let i = idx; i < idx + numberOfItemsOnPage; ++i) {\n      const isEvenRow = i % 2 === 0;\n\n      h += isEvenRow ? evenItemHeight : oddItemHeight;\n    }\n    return h;\n  };\n\n  const scrollRelative = (delta: number): (() => void) => {\n    return (): void => {\n      scroll(selectedIndex + delta, scrollToMode);\n    };\n  };\n\n  const onChangeText = (ev: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, value: string): void => {\n    scroll(parseInt(value, 10) || 0, scrollToMode);\n  };\n\n  const onDropdownChange = (event: React.FormEvent<HTMLDivElement>, option: IDropdownOption) => {\n    let scrollMode = scrollToMode;\n    switch (option.key) {\n      case 'auto':\n        scrollMode = ScrollToMode.auto;\n        break;\n      case 'top':\n        scrollMode = ScrollToMode.top;\n        break;\n      case 'bottom':\n        scrollMode = ScrollToMode.bottom;\n        break;\n      case 'center':\n        scrollMode = ScrollToMode.center;\n        break;\n    }\n    scroll(selectedIndex, scrollMode);\n  };\n\n  return (\n    <FocusZone direction={FocusZoneDirection.vertical}>\n      <div>\n        <DefaultButton onClick={scrollRelative(-10)}>-10</DefaultButton>\n        <DefaultButton onClick={scrollRelative(-1)}>-1</DefaultButton>\n        <DefaultButton onClick={scrollRelative(1)}>+1</DefaultButton>\n        <DefaultButton onClick={scrollRelative(10)}>+10</DefaultButton>\n      </div>\n      <Dropdown\n        placeholder=\"Select an Option\"\n        label=\"Scroll To Mode:\"\n        ariaLabel=\"Scroll To Mode\"\n        defaultSelectedKey={'auto'}\n        options={dropdownOptions}\n        // eslint-disable-next-line react/jsx-no-bind\n        onChange={onDropdownChange}\n      />\n      <div>\n        Scroll item index:\n        <TextField\n          value={selectedIndex.toString(10)}\n          // eslint-disable-next-line react/jsx-no-bind\n          onChange={onChangeText}\n        />\n      </div>\n      <div className={styles.container} data-is-scrollable>\n        <List\n          componentRef={listRef}\n          items={items}\n          // eslint-disable-next-line react/jsx-no-bind\n          getPageHeight={getPageHeight}\n          onRenderCell={onRenderCell}\n        />\n      </div>\n    </FocusZone>\n  );\n};\n"]}