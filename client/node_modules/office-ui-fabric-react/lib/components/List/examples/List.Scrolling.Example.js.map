{"version":3,"file":"List.Scrolling.Example.js","sourceRoot":"../src/","sources":["components/List/examples/List.Scrolling.Example.tsx"],"names":[],"mappings":"AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAC/B,OAAO,EAAE,SAAS,EAAE,kBAAkB,EAAE,MAAM,sCAAsC,CAAC;AACrF,OAAO,EAAE,aAAa,EAAE,MAAM,mCAAmC,CAAC;AAClE,OAAO,EAAE,QAAQ,EAAmB,MAAM,qCAAqC,CAAC;AAChF,OAAO,EAAE,IAAI,EAAE,YAAY,EAAS,MAAM,iCAAiC,CAAC;AAC5E,OAAO,EAAE,SAAS,EAAE,MAAM,sCAAsC,CAAC;AACjE,OAAO,EAAE,eAAe,EAAgB,MAAM,wBAAwB,CAAC;AACvE,OAAO,EAAE,cAAc,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,oCAAoC,CAAC;AACzF,OAAO,EAAE,QAAQ,EAAE,MAAM,uBAAuB,CAAC;AAEjD,IAAM,cAAc,GAAG,EAAE,CAAC;AAC1B,IAAM,aAAa,GAAG,EAAE,CAAC;AACzB,IAAM,mBAAmB,GAAG,EAAE,CAAC;AAC/B,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAC;AACzB,IAAM,eAAe,GAAG;IACtB,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE;IAC7B,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE;IAC3B,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE;IACjC,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE;CAClC,CAAC;AAEF,IAAM,MAAM,GAAG,cAAc,CAAC;IAC5B,SAAS,EAAE;QACT,QAAQ,EAAE,MAAM;QAChB,SAAS,EAAE,GAAG;QACd,MAAM,EAAE,gBAAgB;QACxB,SAAS,EAAE,EAAE;QACb,SAAS,EAAE;YACT,8BAA8B,EAAE;gBAC9B,MAAM,EAAE,EAAE;gBACV,UAAU,EAAE,EAAE;gBACd,UAAU,EAAE,KAAK,CAAC,OAAO,CAAC,cAAc;aACzC;YACD,+BAA+B,EAAE;gBAC/B,MAAM,EAAE,EAAE;gBACV,UAAU,EAAE,EAAE;aACf;SACF;KACF;IACD,WAAW,EAAE;QACX,KAAK,CAAC,KAAK,CAAC,MAAM;QAClB,SAAS;QACT;YACE,QAAQ,EAAE,UAAU;YACpB,SAAS,EAAE,YAAY;YACvB,OAAO,EAAE,OAAO;YAChB,UAAU,EAAE,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC,YAAY;YACrD,WAAW,EAAE,EAAE;SAChB;KACF;CACF,CAAC,CAAC;AAEH,IAAM,YAAY,GAAG,UAAC,IAAkB,EAAE,KAAa;IACrD,OAAO,CACL;QACE,6BAAK,SAAS,EAAE,MAAM,CAAC,WAAW;YAC/B,KAAK;;YAAU,IAAI,CAAC,IAAI,CACrB,CACF,CACP,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,oBAAoB,GAA4B;IAC3D,IAAM,KAAK,GAAG,QAAQ,CAAC,cAAM,OAAA,eAAe,CAAC,IAAI,CAAC,EAArB,CAAqB,CAAC,CAAC;IAC9C,IAAA,sBAAqD,EAApD,qBAAa,EAAE,wBAAqC,CAAC;IACtD,IAAA,sCAAiF,EAAhF,oBAAY,EAAE,uBAAkE,CAAC;IACxF,IAAM,OAAO,GAA2B,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAE3D,IAAM,MAAM,GAAG,UAAC,KAAa,EAAE,gBAA8B;;QAC3D,IAAM,oBAAoB,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC,EAAE,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAC5E,gBAAgB,CAAC,oBAAoB,CAAC,CAAC;QACvC,eAAe,CAAC,gBAAgB,CAAC,CAAC;QAElC,MAAA,OAAO,CAAC,OAAO,0CAAE,aAAa,CAC5B,oBAAoB,EACpB,UAAA,GAAG,IAAI,OAAA,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,aAAa,CAAC,EAAhD,CAAgD,EACvD,YAAY,EACZ;IACJ,CAAC,CAAC;IAEF,IAAM,aAAa,GAAG,UAAC,GAAW;QAChC,IAAI,CAAC,GAAG,CAAC,CAAC;QACV,KAAK,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC,GAAG,GAAG,GAAG,mBAAmB,EAAE,EAAE,CAAC,EAAE;YACpD,IAAM,SAAS,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YAE9B,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,aAAa,CAAC;SACjD;QACD,OAAO,CAAC,CAAC;IACX,CAAC,CAAC;IAEF,IAAM,cAAc,GAAG,UAAC,KAAa;QACnC,OAAO;YACL,MAAM,CAAC,aAAa,GAAG,KAAK,EAAE,YAAY,CAAC,CAAC;QAC9C,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,IAAM,YAAY,GAAG,UAAC,EAA2D,EAAE,KAAa;QAC9F,MAAM,CAAC,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,YAAY,CAAC,CAAC;IACjD,CAAC,CAAC;IAEF,IAAM,gBAAgB,GAAG,UAAC,KAAsC,EAAE,MAAuB;QACvF,IAAI,UAAU,GAAG,YAAY,CAAC;QAC9B,QAAQ,MAAM,CAAC,GAAG,EAAE;YAClB,KAAK,MAAM;gBACT,UAAU,GAAG,YAAY,CAAC,IAAI,CAAC;gBAC/B,MAAM;YACR,KAAK,KAAK;gBACR,UAAU,GAAG,YAAY,CAAC,GAAG,CAAC;gBAC9B,MAAM;YACR,KAAK,QAAQ;gBACX,UAAU,GAAG,YAAY,CAAC,MAAM,CAAC;gBACjC,MAAM;YACR,KAAK,QAAQ;gBACX,UAAU,GAAG,YAAY,CAAC,MAAM,CAAC;gBACjC,MAAM;SACT;QACD,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;IACpC,CAAC,CAAC;IAEF,OAAO,CACL,oBAAC,SAAS,IAAC,SAAS,EAAE,kBAAkB,CAAC,QAAQ;QAC/C;YACE,oBAAC,aAAa,IAAC,OAAO,EAAE,cAAc,CAAC,CAAC,EAAE,CAAC,UAAqB;YAChE,oBAAC,aAAa,IAAC,OAAO,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC,SAAoB;YAC9D,oBAAC,aAAa,IAAC,OAAO,EAAE,cAAc,CAAC,CAAC,CAAC,SAAoB;YAC7D,oBAAC,aAAa,IAAC,OAAO,EAAE,cAAc,CAAC,EAAE,CAAC,UAAqB,CAC3D;QACN,oBAAC,QAAQ,IACP,WAAW,EAAC,kBAAkB,EAC9B,KAAK,EAAC,iBAAiB,EACvB,SAAS,EAAC,gBAAgB,EAC1B,kBAAkB,EAAE,MAAM,EAC1B,OAAO,EAAE,eAAe;YACxB,6CAA6C;YAC7C,QAAQ,EAAE,gBAAgB,GAC1B;QACF;;YAEE,oBAAC,SAAS,IACR,KAAK,EAAE,aAAa,CAAC,QAAQ,CAAC,EAAE,CAAC;gBACjC,6CAA6C;gBAC7C,QAAQ,EAAE,YAAY,GACtB,CACE;QACN,6BAAK,SAAS,EAAE,MAAM,CAAC,SAAS;YAC9B,oBAAC,IAAI,IACH,YAAY,EAAE,OAAO,EACrB,KAAK,EAAE,KAAK;gBACZ,6CAA6C;gBAC7C,aAAa,EAAE,aAAa,EAC5B,YAAY,EAAE,YAAY,GAC1B,CACE,CACI,CACb,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import * as React from 'react';\nimport { FocusZone, FocusZoneDirection } from 'office-ui-fabric-react/lib/FocusZone';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\nimport { List, ScrollToMode, IList } from 'office-ui-fabric-react/lib/List';\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\nimport { createListItems, IExampleItem } from '@uifabric/example-data';\nimport { mergeStyleSets, getTheme, normalize } from 'office-ui-fabric-react/lib/Styling';\nimport { useConst } from '@uifabric/react-hooks';\n\nconst evenItemHeight = 25;\nconst oddItemHeight = 50;\nconst numberOfItemsOnPage = 10;\nconst theme = getTheme();\nconst dropdownOptions = [\n  { key: 'auto', text: 'Auto' },\n  { key: 'top', text: 'Top' },\n  { key: 'bottom', text: 'Bottom' },\n  { key: 'center', text: 'Center' },\n];\n\nconst styles = mergeStyleSets({\n  container: {\n    overflow: 'auto',\n    maxHeight: 400,\n    border: '1px solid #CCC',\n    marginTop: 20,\n    selectors: {\n      '.ms-List-cell:nth-child(odd)': {\n        height: 50,\n        lineHeight: 50,\n        background: theme.palette.neutralLighter,\n      },\n      '.ms-List-cell:nth-child(even)': {\n        height: 25,\n        lineHeight: 25,\n      },\n    },\n  },\n  itemContent: [\n    theme.fonts.medium,\n    normalize,\n    {\n      position: 'relative',\n      boxSizing: 'border-box',\n      display: 'block',\n      borderLeft: '3px solid ' + theme.palette.themePrimary,\n      paddingLeft: 27,\n    },\n  ],\n});\n\nconst onRenderCell = (item: IExampleItem, index: number): JSX.Element => {\n  return (\n    <div data-is-focusable>\n      <div className={styles.itemContent}>\n        {index} &nbsp; {item.name}\n      </div>\n    </div>\n  );\n};\n\nexport const ListScrollingExample: React.FunctionComponent = () => {\n  const items = useConst(() => createListItems(5000));\n  const [selectedIndex, setSelectedIndex] = React.useState(0);\n  const [scrollToMode, setScrollToMode] = React.useState<ScrollToMode>(ScrollToMode.auto);\n  const listRef: React.RefObject<IList> = React.useRef(null);\n\n  const scroll = (index: number, propScrollToMode: ScrollToMode): void => {\n    const updatedSelectedIndex = Math.min(Math.max(index, 0), items.length - 1);\n    setSelectedIndex(updatedSelectedIndex);\n    setScrollToMode(propScrollToMode);\n\n    listRef.current?.scrollToIndex(\n      updatedSelectedIndex,\n      idx => (idx % 2 === 0 ? evenItemHeight : oddItemHeight),\n      scrollToMode,\n    );\n  };\n\n  const getPageHeight = (idx: number): number => {\n    let h = 0;\n    for (let i = idx; i < idx + numberOfItemsOnPage; ++i) {\n      const isEvenRow = i % 2 === 0;\n\n      h += isEvenRow ? evenItemHeight : oddItemHeight;\n    }\n    return h;\n  };\n\n  const scrollRelative = (delta: number): (() => void) => {\n    return (): void => {\n      scroll(selectedIndex + delta, scrollToMode);\n    };\n  };\n\n  const onChangeText = (ev: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, value: string): void => {\n    scroll(parseInt(value, 10) || 0, scrollToMode);\n  };\n\n  const onDropdownChange = (event: React.FormEvent<HTMLDivElement>, option: IDropdownOption) => {\n    let scrollMode = scrollToMode;\n    switch (option.key) {\n      case 'auto':\n        scrollMode = ScrollToMode.auto;\n        break;\n      case 'top':\n        scrollMode = ScrollToMode.top;\n        break;\n      case 'bottom':\n        scrollMode = ScrollToMode.bottom;\n        break;\n      case 'center':\n        scrollMode = ScrollToMode.center;\n        break;\n    }\n    scroll(selectedIndex, scrollMode);\n  };\n\n  return (\n    <FocusZone direction={FocusZoneDirection.vertical}>\n      <div>\n        <DefaultButton onClick={scrollRelative(-10)}>-10</DefaultButton>\n        <DefaultButton onClick={scrollRelative(-1)}>-1</DefaultButton>\n        <DefaultButton onClick={scrollRelative(1)}>+1</DefaultButton>\n        <DefaultButton onClick={scrollRelative(10)}>+10</DefaultButton>\n      </div>\n      <Dropdown\n        placeholder=\"Select an Option\"\n        label=\"Scroll To Mode:\"\n        ariaLabel=\"Scroll To Mode\"\n        defaultSelectedKey={'auto'}\n        options={dropdownOptions}\n        // eslint-disable-next-line react/jsx-no-bind\n        onChange={onDropdownChange}\n      />\n      <div>\n        Scroll item index:\n        <TextField\n          value={selectedIndex.toString(10)}\n          // eslint-disable-next-line react/jsx-no-bind\n          onChange={onChangeText}\n        />\n      </div>\n      <div className={styles.container} data-is-scrollable>\n        <List\n          componentRef={listRef}\n          items={items}\n          // eslint-disable-next-line react/jsx-no-bind\n          getPageHeight={getPageHeight}\n          onRenderCell={onRenderCell}\n        />\n      </div>\n    </FocusZone>\n  );\n};\n"]}