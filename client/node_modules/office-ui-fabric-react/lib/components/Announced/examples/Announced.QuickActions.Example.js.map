{"version":3,"file":"Announced.QuickActions.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.QuickActions.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Announced } from 'office-ui-fabric-react/lib/Announced';\nimport {\n  DetailsList,\n  DetailsListLayoutMode,\n  Selection,\n  IColumn,\n  IDetailsList,\n} from 'office-ui-fabric-react/lib/DetailsList';\nimport { IconButton, PrimaryButton, IButtonStyles } from 'office-ui-fabric-react/lib/Button';\nimport { Dialog, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\nimport { TextField, ITextField } from 'office-ui-fabric-react/lib/TextField';\nimport { createArray } from 'office-ui-fabric-react/lib/Utilities';\nimport { useConst, useConstCallback } from '@uifabric/react-hooks';\n\nconst iconButtonStyles: Partial<IButtonStyles> = { root: { float: 'right', height: 'inherit' } };\n\ninterface IExampleItem {\n  key: number;\n  name: string;\n}\n\nexport const AnnouncedQuickActionsExample: React.FunctionComponent = () => {\n  const detailsList = React.useRef<IDetailsList>(null);\n  const textField = React.useRef<ITextField>(null);\n  const selection = useConst(() => new Selection());\n  const [items, setItems] = React.useState<IExampleItem[]>(() =>\n    createArray(20, i => ({\n      key: i,\n      name: 'Item ' + i,\n    })),\n  );\n\n  const [dialogContent, setDialogContent] = React.useState<JSX.Element | undefined>(undefined);\n  const [announced, setAnnounced] = React.useState<JSX.Element | undefined>(undefined);\n\n  const deleteItem = useConstCallback((index: number): void => {\n    setItems(prevItems => prevItems.filter((item, i) => i !== index));\n    setAnnounced(<Announced message=\"Item deleted\" aria-live=\"assertive\" />);\n  });\n\n  const renameItem = useConstCallback((item: IExampleItem, index: number): void => {\n    setDialogContent(\n      <>\n        <TextField componentRef={textField} label=\"Rename\" defaultValue={item.name} />\n        <DialogFooter>\n          <PrimaryButton\n            // eslint-disable-next-line react/jsx-no-bind\n            onClick={() => updateItemName(index)}\n            text=\"Save\"\n          />\n        </DialogFooter>\n      </>,\n    );\n    return;\n  });\n\n  const columns = useConst((): IColumn[] => [\n    {\n      name: 'Name',\n      fieldName: 'name',\n      key: 'name',\n      minWidth: 100,\n      maxWidth: 200,\n      onRender: (item: IExampleItem, index: number) => (\n        <div>\n          {item.name}\n          <IconButton\n            menuIconProps={{ iconName: 'MoreVertical' }}\n            role=\"button\"\n            aria-haspopup\n            aria-label=\"Show actions\"\n            styles={iconButtonStyles}\n            menuProps={{\n              items: [\n                {\n                  key: 'delete',\n                  text: 'Delete',\n                  onClick: () => deleteItem(index),\n                },\n                {\n                  key: 'rename',\n                  text: 'Rename',\n                  onClick: () => renameItem(item, index),\n                },\n              ],\n            }}\n          />\n        </div>\n      ),\n    },\n  ]);\n\n  const updateItemName = useConstCallback((index: number) => {\n    if (textField && textField.current) {\n      setItems(prevItems => {\n        const renamedItems = [...prevItems];\n        renamedItems[index] = { ...prevItems[index], name: textField.current?.value || renamedItems[index].name };\n        return renamedItems;\n      });\n      setDialogContent(undefined);\n      setAnnounced(<Announced message=\"Item renamed\" aria-live=\"assertive\" />);\n    }\n  });\n\n  const closeRenameDialog = useConstCallback((): void => {\n    setDialogContent(undefined);\n  });\n\n  return (\n    <>\n      {announced}\n      <DetailsList\n        componentRef={detailsList}\n        items={items}\n        columns={columns}\n        layoutMode={DetailsListLayoutMode.fixedColumns}\n        selection={selection}\n        selectionPreservedOnEmptyClick\n        ariaLabelForSelectionColumn=\"Toggle selection\"\n        ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n      />\n      <Dialog hidden={!dialogContent} onDismiss={closeRenameDialog} closeButtonAriaLabel=\"Close\">\n        {dialogContent}\n      </Dialog>\n    </>\n  );\n};\n"]}