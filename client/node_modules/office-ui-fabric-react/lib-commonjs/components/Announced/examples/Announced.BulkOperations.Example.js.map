{"version":3,"file":"Announced.BulkOperations.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.BulkOperations.Example.tsx"],"names":[],"mappings":";;AAAA,6BAA+B;AAC/B,kEAAiE;AACjE,qDAAmE;AACnE,sEAAqG;AACrG,kEAAiE;AACjE,wDAAuD;AACvD,0DAAuE;AACvE,4DAAkE;AAClE,kEAAmE;AAOnE,IAAM,OAAO,GAAc;IACzB;QACE,IAAI,EAAE,MAAM;QACZ,SAAS,EAAE,MAAM;QACjB,GAAG,EAAE,MAAM;QACX,QAAQ,EAAE,GAAG;QACb,QAAQ,EAAE,GAAG;KACd;CACF,CAAC;AAEF,IAAM,WAAW,GAAiB,EAAE,WAAW,EAAE,EAAE,EAAE,CAAC;AAEzC,QAAA,8BAA8B,GAA4B;IACrE,IAAM,SAAS,GAAG,sBAAQ,CAAC,cAAM,OAAA,IAAI,qBAAS,EAAE,EAAf,CAAe,CAAC,CAAC;IAC5C,IAAA;;;;;MAKL,EALM,aAAK,EAAE,gBAKb,CAAC;IACI,IAAA,sBAA2D,EAA1D,oBAAY,EAAE,uBAA4C,CAAC;IAElE,IAAM,QAAQ,GAAG,8BAAgB,CAAC;QAChC,eAAe,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACjC,QAAQ,CAAC,UAAA,SAAS;YAChB,IAAM,eAAe,GAAG,SAAS,CAAC,kBAAkB,EAAE,CAAC;YACvD,OAAO,SAAS,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,CAAC,IAAK,OAAA,eAAe,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAjC,CAAiC,CAAC,CAAC;QAC1E,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,OAAO,CACL,oBAAC,aAAK,IAAC,MAAM,EAAE,WAAW;QACxB,oBAAC,WAAI,6EAA0E;QAC/E,oBAAC,WAAI,qKAGE;QACP,oBAAC,aAAK,CAAC,IAAI,IAAC,KAAK,EAAC,OAAO;YACvB,oBAAC,sBAAa,IAAC,OAAO,EAAE,QAAQ,4BAAuC,CAC5D;QACZ,YAAY,GAAG,CAAC,IAAI,CACnB,oBAAC,qBAAS,IAAC,OAAO,EAAK,YAAY,cAAQ,YAAY,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,cAAU,eAAa,WAAW,GAAI,CAC/G;QACD,oBAAC,yBAAW,IACV,MAAM,EAAC,OAAO,EACd,KAAK,EAAE,KAAK,EACZ,OAAO,EAAE,OAAO,EAChB,SAAS,EAAE,SAAS,EACpB,8BAA8B,QAC9B,UAAU,EAAE,mCAAqB,CAAC,YAAY,EAC9C,2BAA2B,EAAC,kBAAkB,EAC9C,6BAA6B,EAAC,gCAAgC,GAC9D,CACI,CACT,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import * as React from 'react';\nimport { Announced } from 'office-ui-fabric-react/lib/Announced';\nimport { useConst, useConstCallback } from '@uifabric/react-hooks';\nimport { DetailsList, DetailsListLayoutMode, IColumn } from 'office-ui-fabric-react/lib/DetailsList';\nimport { Selection } from 'office-ui-fabric-react/lib/Selection';\nimport { Text } from 'office-ui-fabric-react/lib/Text';\nimport { IStackTokens, Stack } from 'office-ui-fabric-react/lib/Stack';\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\nimport { createArray } from 'office-ui-fabric-react/lib/Utilities';\n\ninterface IExampleItem {\n  key: string;\n  name: string;\n}\n\nconst columns: IColumn[] = [\n  {\n    name: 'Name',\n    fieldName: 'name',\n    key: 'name',\n    minWidth: 100,\n    maxWidth: 200,\n  },\n];\n\nconst stackTokens: IStackTokens = { childrenGap: 10 };\n\nexport const AnnouncedBulkOperationsExample: React.FunctionComponent = () => {\n  const selection = useConst(() => new Selection());\n  const [items, setItems] = React.useState<IExampleItem[]>(() =>\n    createArray(20, i => ({\n      key: 'item-' + i,\n      name: 'Item ' + i,\n    })),\n  );\n  const [deletedCount, setDeletedCount] = React.useState<number>(0);\n\n  const onDelete = useConstCallback(() => {\n    setDeletedCount(selection.count);\n    setItems(prevItems => {\n      const selectedIndices = selection.getSelectedIndices();\n      return prevItems.filter((item, i) => selectedIndices.indexOf(i) === -1);\n    });\n  });\n\n  return (\n    <Stack tokens={stackTokens}>\n      <Text>Turn on Narrator, select items, and use the button to delete them.</Text>\n      <Text>\n        Note: This example is to showcase the concept of deleting, copying, uploading, or moving many items and not\n        fully illustrative of the real-world scenario.\n      </Text>\n      <Stack.Item align=\"start\">\n        <PrimaryButton onClick={onDelete}>Delete selected items</PrimaryButton>\n      </Stack.Item>\n      {deletedCount > 0 && (\n        <Announced message={`${deletedCount} item${deletedCount === 1 ? '' : 's'} deleted`} aria-live={'assertive'} />\n      )}\n      <DetailsList\n        setKey=\"items\"\n        items={items}\n        columns={columns}\n        selection={selection}\n        selectionPreservedOnEmptyClick\n        layoutMode={DetailsListLayoutMode.fixedColumns}\n        ariaLabelForSelectionColumn=\"Toggle selection\"\n        ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n      />\n    </Stack>\n  );\n};\n"]}