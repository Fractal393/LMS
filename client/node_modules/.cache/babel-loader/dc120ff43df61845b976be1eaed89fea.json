{"ast":null,"code":"/**\r\n * DevExtreme (core/options/index.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Options = void 0;\n\nvar _type = require(\"../utils/type\");\n\nvar _common = require(\"../utils/common\");\n\nvar _option_manager = require(\"./option_manager\");\n\nvar _object = require(\"../utils/object\");\n\nvar _utils = require(\"./utils\");\n\nvar _extend = require(\"../utils/extend\");\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar Options = exports.Options = function () {\n  function Options(options, defaultOptions, optionsByReference, deprecatedOptions) {\n    var _this = this;\n\n    _classCallCheck(this, Options);\n\n    this._deprecatedCallback;\n    this._startChangeCallback;\n    this._endChangeCallback;\n    this._default = defaultOptions;\n    this._deprecated = deprecatedOptions;\n    this._deprecatedNames = [];\n\n    this._initDeprecatedNames();\n\n    this._optionManager = new _option_manager.OptionManager(options, optionsByReference);\n\n    this._optionManager.onRelevantNamesPrepared(function (options, name, value, silent) {\n      return _this._setRelevantNames(options, name, value, silent);\n    });\n\n    this._cachedOptions = {};\n    this._rules = [];\n  }\n\n  _createClass(Options, [{\n    key: \"_initDeprecatedNames\",\n    value: function () {\n      for (var optionName in this._deprecated) {\n        this._deprecatedNames.push(optionName);\n      }\n    }\n  }, {\n    key: \"_getByRules\",\n    value: function (rules) {\n      rules = Array.isArray(rules) ? this._rules.concat(rules) : this._rules;\n      return (0, _utils.convertRulesToOptions)(rules);\n    }\n  }, {\n    key: \"_notifyDeprecated\",\n    value: function (option) {\n      var info = this._deprecated[option];\n\n      if (info) {\n        this._deprecatedCallback(option, info);\n      }\n    }\n  }, {\n    key: \"_setRelevantNames\",\n    value: function (options, name, value, silent) {\n      if (name) {\n        var normalizedName = this._normalizeName(name, silent);\n\n        if (normalizedName && normalizedName !== name) {\n          this._setField(options, normalizedName, value);\n\n          this._clearField(options, name);\n        }\n      }\n    }\n  }, {\n    key: \"_setField\",\n    value: function (options, fullName, value) {\n      var fieldName = \"\";\n      var fieldObject = null;\n\n      do {\n        fieldName = fieldName ? \".\".concat(fieldName) : \"\";\n        fieldName = (0, _utils.getFieldName)(fullName) + fieldName;\n        fullName = (0, _utils.getParentName)(fullName);\n        fieldObject = fullName ? this._optionManager.get(options, fullName, false) : options;\n      } while (!fieldObject);\n\n      fieldObject[fieldName] = value;\n    }\n  }, {\n    key: \"_clearField\",\n    value: function (options, name) {\n      delete options[name];\n      var previousFieldName = (0, _utils.getParentName)(name);\n      var fieldObject = previousFieldName ? this._optionManager.get(options, previousFieldName, false) : options;\n\n      if (fieldObject) {\n        delete fieldObject[(0, _utils.getFieldName)(name)];\n      }\n    }\n  }, {\n    key: \"_normalizeName\",\n    value: function (name, silent) {\n      if (this._deprecatedNames.length && name) {\n        for (var i = 0; i < this._deprecatedNames.length; i++) {\n          if (this._deprecatedNames[i] === name) {\n            var deprecate = this._deprecated[name];\n\n            if (deprecate) {\n              !silent && this._notifyDeprecated(name);\n              return deprecate.alias || name;\n            }\n          }\n        }\n      }\n\n      return name;\n    }\n  }, {\n    key: \"addRules\",\n    value: function (rules) {\n      this._rules = rules.concat(this._rules);\n    }\n  }, {\n    key: \"applyRules\",\n    value: function (rules) {\n      var options = this._getByRules(rules);\n\n      this.silent(options);\n    }\n  }, {\n    key: \"dispose\",\n    value: function () {\n      this._deprecatedCallback = _common.noop;\n      this._startChangeCallback = _common.noop;\n      this._endChangeCallback = _common.noop;\n\n      this._optionManager.dispose();\n    }\n  }, {\n    key: \"onChanging\",\n    value: function (callBack) {\n      this._optionManager.onChanging(callBack);\n    }\n  }, {\n    key: \"onChanged\",\n    value: function (callBack) {\n      this._optionManager.onChanged(callBack);\n    }\n  }, {\n    key: \"onDeprecated\",\n    value: function (callBack) {\n      this._deprecatedCallback = callBack;\n    }\n  }, {\n    key: \"onStartChange\",\n    value: function (callBack) {\n      this._startChangeCallback = callBack;\n    }\n  }, {\n    key: \"onEndChange\",\n    value: function (callBack) {\n      this._endChangeCallback = callBack;\n    }\n  }, {\n    key: \"isInitial\",\n    value: function (name) {\n      var value = this.silent(name);\n      var initialValue = this.initial(name);\n      var areFunctions = (0, _type.isFunction)(value) && (0, _type.isFunction)(initialValue);\n      return areFunctions ? value.toString() === initialValue.toString() : (0, _common.equalByValue)(value, initialValue);\n    }\n  }, {\n    key: \"initial\",\n    value: function (name) {\n      return (0, _utils.getNestedOptionValue)(this._initial, name);\n    }\n  }, {\n    key: \"option\",\n    value: function (options, value) {\n      var isGetter = arguments.length < 2 && \"object\" !== (0, _type.type)(options);\n\n      if (isGetter) {\n        return this._optionManager.get(void 0, this._normalizeName(options));\n      } else {\n        this._startChangeCallback();\n\n        try {\n          this._optionManager.set(options, value);\n        } finally {\n          this._endChangeCallback();\n        }\n      }\n    }\n  }, {\n    key: \"silent\",\n    value: function (options, value) {\n      var isGetter = arguments.length < 2 && \"object\" !== (0, _type.type)(options);\n\n      if (isGetter) {\n        return this._optionManager.get(void 0, options, void 0, true);\n      } else {\n        this._optionManager.set(options, value, void 0, true);\n      }\n    }\n  }, {\n    key: \"reset\",\n    value: function (name) {\n      var _this2 = this;\n\n      if (name) {\n        var fullPath = name.replace(/\\[([^\\]])\\]/g, \".$1\").split(\".\");\n        var value = fullPath.reduce(function (value, field) {\n          return value ? value[field] : _this2.initial(field);\n        }, null);\n        var defaultValue = (0, _type.isObject)(value) ? (0, _object.clone)(value) : value;\n\n        this._optionManager.set(name, defaultValue, false);\n      }\n    }\n  }, {\n    key: \"getAliasesByName\",\n    value: function (name) {\n      var _this3 = this;\n\n      return Object.keys(this._deprecated).filter(function (aliasName) {\n        return name === _this3._deprecated[aliasName].alias;\n      });\n    }\n  }, {\n    key: \"isDeprecated\",\n    value: function (name) {\n      return Object.prototype.hasOwnProperty.call(this._deprecated, name);\n    }\n  }, {\n    key: \"cache\",\n    value: function (name, options) {\n      var isGetter = arguments.length < 2;\n\n      if (isGetter) {\n        return this._cachedOptions[name];\n      } else {\n        this._cachedOptions[name] = (0, _extend.extend)(this._cachedOptions[name], options);\n      }\n    }\n  }, {\n    key: \"_initial\",\n    set: function (value) {\n      this._initialOptions = value;\n    },\n    get: function () {\n      if (!this._initialOptions) {\n        var rulesOptions = this._getByRules(this.silent(\"defaultOptionsRules\"));\n\n        this._initialOptions = this._default;\n\n        this._optionManager._setByReference(this._initialOptions, rulesOptions);\n      }\n\n      return this._initialOptions;\n    }\n  }]);\n\n  return Options;\n}();","map":null,"metadata":{},"sourceType":"script"}