{"ast":null,"code":"/**\r\n * DevExtreme (core/component.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _config = require(\"./config\");\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _extend = require(\"./utils/extend\");\n\nvar _index = require(\"./options/index\");\n\nvar _utils = require(\"./options/utils\");\n\nvar _class = require(\"./class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _action = require(\"./action\");\n\nvar _action2 = _interopRequireDefault(_action);\n\nvar _errors = require(\"./errors\");\n\nvar _errors2 = _interopRequireDefault(_errors);\n\nvar _callbacks = require(\"./utils/callbacks\");\n\nvar _callbacks2 = _interopRequireDefault(_callbacks);\n\nvar _events_strategy = require(\"./events_strategy\");\n\nvar _public_component = require(\"./utils/public_component\");\n\nvar _public_component2 = _interopRequireDefault(_public_component);\n\nvar _postponed_operations = require(\"./postponed_operations\");\n\nvar _type = require(\"./utils/type\");\n\nvar _common = require(\"./utils/common\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar getEventName = function (actionName) {\n  return actionName.charAt(2).toLowerCase() + actionName.substr(3);\n};\n\nvar Component = _class2.default.inherit({\n  _setDeprecatedOptions: function () {\n    this._deprecatedOptions = {};\n  },\n  _getDeprecatedOptions: function () {\n    return this._deprecatedOptions;\n  },\n  _getDefaultOptions: function () {\n    return {\n      onInitialized: null,\n      onOptionChanged: null,\n      onDisposing: null,\n      defaultOptionsRules: null\n    };\n  },\n  _defaultOptionsRules: function () {\n    return [];\n  },\n  _setOptionsByDevice: function (rules) {\n    this._options.applyRules(rules);\n  },\n  _convertRulesToOptions: function (rules) {\n    return (0, _utils.convertRulesToOptions)(rules);\n  },\n  _isInitialOptionValue: function (name) {\n    return this._options.isInitial(name);\n  },\n  _setOptionsByReference: function () {\n    this._optionsByReference = {};\n  },\n  _getOptionsByReference: function () {\n    return this._optionsByReference;\n  },\n  ctor: function () {\n    var options = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\n    var _optionChangedCallbacks = options._optionChangedCallbacks,\n        _disposingCallbacks = options._disposingCallbacks;\n    this.NAME = _public_component2.default.name(this.constructor);\n    this._eventsStrategy = _events_strategy.EventsStrategy.create(this, options.eventsStrategy);\n    this._updateLockCount = 0;\n    this._optionChangedCallbacks = _optionChangedCallbacks || (0, _callbacks2.default)();\n    this._disposingCallbacks = _disposingCallbacks || (0, _callbacks2.default)();\n    this.postponedOperations = new _postponed_operations.PostponedOperations();\n\n    this._createOptions(options);\n  },\n  _createOptions: function (options) {\n    var _this = this;\n\n    this.beginUpdate();\n\n    try {\n      this._setOptionsByReference();\n\n      this._setDeprecatedOptions();\n\n      this._options = new _index.Options(this._getDefaultOptions(), this._getDefaultOptions(), this._getOptionsByReference(), this._getDeprecatedOptions());\n\n      this._options.onChanging(function (name, previousValue, value) {\n        return _this._initialized && _this._optionChanging(name, previousValue, value);\n      });\n\n      this._options.onDeprecated(function (option, info) {\n        return _this._logDeprecatedOptionWarning(option, info);\n      });\n\n      this._options.onChanged(function (name, value, previousValue) {\n        return _this._notifyOptionChanged(name, value, previousValue);\n      });\n\n      this._options.onStartChange(function () {\n        return _this.beginUpdate();\n      });\n\n      this._options.onEndChange(function () {\n        return _this.endUpdate();\n      });\n\n      this._options.addRules(this._defaultOptionsRules());\n\n      if (options && options.onInitializing) {\n        options.onInitializing.apply(this, [options]);\n      }\n\n      this._setOptionsByDevice(options.defaultOptionsRules);\n\n      this._initOptions(options);\n    } finally {\n      this.endUpdate();\n    }\n  },\n  _initOptions: function (options) {\n    this.option(options);\n  },\n  _init: function () {\n    var _this2 = this;\n\n    this._createOptionChangedAction();\n\n    this.on(\"disposing\", function (args) {\n      _this2._disposingCallbacks.fireWith(_this2, [args]);\n    });\n  },\n  _logDeprecatedOptionWarning: function (option, info) {\n    var message = info.message || \"Use the '\".concat(info.alias, \"' option instead\");\n\n    _errors2.default.log(\"W0001\", this.NAME, option, info.since, message);\n  },\n  _logDeprecatedComponentWarning: function (since, alias) {\n    _errors2.default.log(\"W0000\", this.NAME, since, \"Use the '\".concat(alias, \"' widget instead\"));\n  },\n  _createOptionChangedAction: function () {\n    this._optionChangedAction = this._createActionByOption(\"onOptionChanged\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _createDisposingAction: function () {\n    this._disposingAction = this._createActionByOption(\"onDisposing\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"onDisposing\":\n      case \"onInitialized\":\n        break;\n\n      case \"onOptionChanged\":\n        this._createOptionChangedAction();\n\n        break;\n\n      case \"defaultOptionsRules\":\n    }\n  },\n  _dispose: function () {\n    this._optionChangedCallbacks.empty();\n\n    this._createDisposingAction();\n\n    this._disposingAction();\n\n    this._eventsStrategy.dispose();\n\n    this._options.dispose();\n\n    this._disposed = true;\n  },\n  _lockUpdate: function () {\n    this._updateLockCount++;\n  },\n  _unlockUpdate: function () {\n    this._updateLockCount = Math.max(this._updateLockCount - 1, 0);\n  },\n  _isUpdateAllowed: function () {\n    return 0 === this._updateLockCount;\n  },\n  _isInitializingRequired: function () {\n    return !this._initializing && !this._initialized;\n  },\n  _commitUpdate: function () {\n    this.postponedOperations.callPostponedOperations();\n    this._isInitializingRequired() && this._initializeComponent();\n  },\n  _initializeComponent: function () {\n    this._initializing = true;\n\n    try {\n      this._init();\n    } finally {\n      this._initializing = false;\n\n      this._lockUpdate();\n\n      this._createActionByOption(\"onInitialized\", {\n        excludeValidators: [\"disabled\", \"readOnly\"]\n      })();\n\n      this._unlockUpdate();\n\n      this._initialized = true;\n    }\n  },\n  instance: function () {\n    return this;\n  },\n  beginUpdate: function () {\n    this._lockUpdate();\n  },\n  endUpdate: function () {\n    this._unlockUpdate();\n\n    this._isUpdateAllowed() && this._commitUpdate();\n  },\n  _optionChanging: _common.noop,\n  _notifyOptionChanged: function (option, value, previousValue) {\n    if (this._initialized) {\n      var optionNames = [option].concat(this._options.getAliasesByName(option));\n\n      for (var i = 0; i < optionNames.length; i++) {\n        var name = optionNames[i];\n        var args = {\n          name: name.split(/[.[]/)[0],\n          fullName: name,\n          value: value,\n          previousValue: previousValue\n        };\n\n        this._optionChangedCallbacks.fireWith(this, [(0, _extend.extend)(this._defaultActionArgs(), args)]);\n\n        this._optionChangedAction((0, _extend.extend)({}, args));\n\n        if (!this._disposed && this._cancelOptionChange !== args.name) {\n          this._optionChanged(args);\n        }\n      }\n    }\n  },\n  initialOption: function (name) {\n    return this._options.initial(name);\n  },\n  _defaultActionConfig: function () {\n    return {\n      context: this,\n      component: this\n    };\n  },\n  _defaultActionArgs: function () {\n    return {\n      component: this\n    };\n  },\n  _createAction: function (actionSource, config) {\n    var _this3 = this;\n\n    var action;\n    return function (e) {\n      if (!(0, _type.isDefined)(e)) {\n        e = {};\n      }\n\n      if (!(0, _type.isPlainObject)(e)) {\n        e = {\n          actionValue: e\n        };\n      }\n\n      action = action || new _action2.default(actionSource, (0, _extend.extend)(config, _this3._defaultActionConfig()));\n      return action.execute.call(action, (0, _extend.extend)(e, _this3._defaultActionArgs()));\n    };\n  },\n  _createActionByOption: function (optionName, config) {\n    var _this4 = this;\n\n    var action;\n    var eventName;\n    var actionFunc;\n\n    var result = function () {\n      if (!eventName) {\n        config = config || {};\n\n        if (\"string\" !== typeof optionName) {\n          throw _errors2.default.Error(\"E0008\");\n        }\n\n        if (0 === optionName.indexOf(\"on\")) {\n          eventName = getEventName(optionName);\n        }\n\n        actionFunc = _this4.option(optionName);\n      }\n\n      if (!action && !actionFunc && !config.beforeExecute && !config.afterExecute && !_this4._eventsStrategy.hasEvent(eventName)) {\n        return;\n      }\n\n      if (!action) {\n        var beforeExecute = config.beforeExecute;\n\n        config.beforeExecute = function () {\n          for (var _len2 = arguments.length, props = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            props[_key2] = arguments[_key2];\n          }\n\n          beforeExecute && beforeExecute.apply(_this4, props);\n\n          _this4._eventsStrategy.fireEvent(eventName, props[0].args);\n        };\n\n        action = _this4._createAction(actionFunc, config);\n      }\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if ((0, _config2.default)().wrapActionsBeforeExecute) {\n        var beforeActionExecute = _this4.option(\"beforeActionExecute\") || _common.noop;\n\n        var wrappedAction = beforeActionExecute(_this4, action, config) || action;\n        return wrappedAction.apply(_this4, args);\n      }\n\n      return action.apply(_this4, args);\n    };\n\n    if ((0, _config2.default)().wrapActionsBeforeExecute) {\n      return result;\n    }\n\n    var onActionCreated = this.option(\"onActionCreated\") || _common.noop;\n\n    return onActionCreated(this, result, config) || result;\n  },\n  on: function (eventName, eventHandler) {\n    this._eventsStrategy.on(eventName, eventHandler);\n\n    return this;\n  },\n  off: function (eventName, eventHandler) {\n    this._eventsStrategy.off(eventName, eventHandler);\n\n    return this;\n  },\n  hasActionSubscription: function (actionName) {\n    return !!this._options.silent(actionName) || this._eventsStrategy.hasEvent(getEventName(actionName));\n  },\n  isOptionDeprecated: function (name) {\n    return this._options.isDeprecated(name);\n  },\n  _setOptionWithoutOptionChange: function (name, value) {\n    this._cancelOptionChange = name;\n    this.option(name, value);\n    this._cancelOptionChange = false;\n  },\n  _getOptionValue: function (name, context) {\n    var value = this.option(name);\n\n    if ((0, _type.isFunction)(value)) {\n      return value.bind(context)();\n    }\n\n    return value;\n  },\n  option: function () {\n    var _this$_options;\n\n    return (_this$_options = this._options).option.apply(_this$_options, arguments);\n  },\n  resetOption: function (name) {\n    this.beginUpdate();\n\n    this._options.reset(name);\n\n    this.endUpdate();\n  }\n});\n\nmodule.exports = Component;","map":null,"metadata":{},"sourceType":"script"}