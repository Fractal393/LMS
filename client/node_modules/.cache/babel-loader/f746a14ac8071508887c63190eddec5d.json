{"ast":null,"code":"/**\r\n * DevExtreme (events/double_click.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar eventsEngine = require(\"../events/core/events_engine\");\n\nvar domUtils = require(\"../core/utils/dom\");\n\nvar domAdapter = require(\"../core/dom_adapter\");\n\nvar Class = require(\"../core/class\");\n\nvar registerEvent = require(\"./core/event_registrator\");\n\nvar clickEvent = require(\"./click\");\n\nvar eventUtils = require(\"./utils\");\n\nvar DBLCLICK_EVENT_NAME = \"dxdblclick\";\nvar DBLCLICK_NAMESPACE = \"dxDblClick\";\nvar NAMESPACED_CLICK_EVENT = eventUtils.addNamespace(clickEvent.name, DBLCLICK_NAMESPACE);\nvar DBLCLICK_TIMEOUT = 300;\nvar DblClick = Class.inherit({\n  ctor: function () {\n    this._handlerCount = 0;\n\n    this._forgetLastClick();\n  },\n  _forgetLastClick: function () {\n    this._firstClickTarget = null;\n    this._lastClickTimeStamp = -DBLCLICK_TIMEOUT;\n  },\n  add: function () {\n    if (this._handlerCount <= 0) {\n      eventsEngine.on(domAdapter.getDocument(), NAMESPACED_CLICK_EVENT, this._clickHandler.bind(this));\n    }\n\n    this._handlerCount++;\n  },\n  _clickHandler: function (e) {\n    var timeStamp = e.timeStamp || Date.now();\n\n    if (timeStamp - this._lastClickTimeStamp < DBLCLICK_TIMEOUT) {\n      eventUtils.fireEvent({\n        type: DBLCLICK_EVENT_NAME,\n        target: domUtils.closestCommonParent(this._firstClickTarget, e.target),\n        originalEvent: e\n      });\n\n      this._forgetLastClick();\n    } else {\n      this._firstClickTarget = e.target;\n      this._lastClickTimeStamp = timeStamp;\n    }\n  },\n  remove: function () {\n    this._handlerCount--;\n\n    if (this._handlerCount <= 0) {\n      this._forgetLastClick();\n\n      eventsEngine.off(domAdapter.getDocument(), NAMESPACED_CLICK_EVENT);\n    }\n  }\n});\nregisterEvent(DBLCLICK_EVENT_NAME, new DblClick());\nexports.name = DBLCLICK_EVENT_NAME;","map":null,"metadata":{},"sourceType":"script"}