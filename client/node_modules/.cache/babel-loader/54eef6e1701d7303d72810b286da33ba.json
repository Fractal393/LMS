{"ast":null,"code":"\"use strict\";\n/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ChonkyBusinessLogic = void 0;\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar recoil_1 = require(\"recoil\");\n\nvar drag_and_drop_recoil_1 = require(\"../../recoil/drag-and-drop.recoil\");\n\nvar file_actions_recoil_1 = require(\"../../recoil/file-actions.recoil\");\n\nvar file_list_recoil_1 = require(\"../../recoil/file-list.recoil\");\n\nvar files_recoil_1 = require(\"../../recoil/files.recoil\");\n\nvar selection_recoil_1 = require(\"../../recoil/selection.recoil\");\n\nvar thumbnails_recoil_1 = require(\"../../recoil/thumbnails.recoil\");\n\nvar file_actions_1 = require(\"../../util/file-actions\");\n\nvar file_browser_handle_1 = require(\"../../util/file-browser-handle\");\n\nvar options_1 = require(\"../../util/options\");\n\nvar search_1 = require(\"../../util/search\");\n\nvar selection_1 = require(\"../../util/selection\");\n\nvar sort_1 = require(\"../../util/sort\");\n\nvar special_actions_1 = require(\"../../util/special-actions\");\n\nexports.ChonkyBusinessLogic = react_1.default.memo(react_1.default.forwardRef(function (props, ref) {\n  var files = props.files; // Instance ID used to distinguish between multiple Chonky instances on the\n  // same page const chonkyInstanceId = useStaticValue(shortid.generate);\n  //\n  // ==== Default values assignment\n\n  var folderChain = props.folderChain ? props.folderChain : null;\n  var fileActions = props.fileActions ? props.fileActions : [];\n  var onFileAction = props.onFileAction ? props.onFileAction : null;\n  var thumbnailGenerator = props.thumbnailGenerator ? props.thumbnailGenerator : null;\n  var doubleClickDelay = typeof props.doubleClickDelay === 'number' ? props.doubleClickDelay : 300;\n  var disableSelection = !!props.disableSelection;\n  var enableDragAndDrop = !!props.enableDragAndDrop; //\n  // ==== File array sorting\n\n  var sortedFiles = sort_1.useFileSorting(files); //\n  // ==== File selections\n\n  var _a = selection_1.useSelection(sortedFiles, disableSelection),\n      selection = _a.selection,\n      selectionUtilRef = _a.selectionUtilRef,\n      selectionModifiers = _a.selectionModifiers;\n\n  var setRecoilSelectionModifiers = recoil_1.useSetRecoilState(selection_recoil_1.selectionModifiersState);\n  react_1.useEffect(function () {\n    setRecoilSelectionModifiers(selectionModifiers);\n  }, [selectionModifiers, setRecoilSelectionModifiers]); //\n  // ==== File actions - actions that users can customise as they please\n\n  file_actions_1.useFileActions(fileActions, onFileAction); //\n  // ==== File options - toggleable options based on file actions\n\n  var optionFilteredFiles = options_1.useOptions(sortedFiles); //\n  // ==== File search (aka file array filtering)\n\n  var searchFilteredFiles = search_1.useFileSearch(optionFilteredFiles); //\n  // ==== Special actions - special actions hard-coded into Chonky that users\n  //      cannot customize (easily).\n\n  special_actions_1.useSpecialActionDispatcher(sortedFiles, selection, selectionUtilRef.current, selectionModifiers); //\n  // ==== Setup the imperative handle for external use\n\n  file_browser_handle_1.useFileBrowserHandle(ref, selectionModifiers);\n  var setRecoilFiles = recoil_1.useSetRecoilState(files_recoil_1.filesState);\n  react_1.useEffect(function () {\n    setRecoilFiles(searchFilteredFiles);\n  }, [searchFilteredFiles, setRecoilFiles]);\n  var setFolderChain = recoil_1.useSetRecoilState(files_recoil_1.folderChainState);\n  var setParentFolder = recoil_1.useSetRecoilState(files_recoil_1.parentFolderState);\n  react_1.useEffect(function () {\n    var parentFolder = folderChain && folderChain.length > 1 ? folderChain[(folderChain === null || folderChain === void 0 ? void 0 : folderChain.length) - 2] : null;\n    setFolderChain(folderChain);\n    setParentFolder(parentFolder);\n  }, [folderChain, setFolderChain, setParentFolder]);\n  var setRecoilSelection = recoil_1.useSetRecoilState(selection_recoil_1.selectionState);\n  react_1.useEffect(function () {\n    setRecoilSelection(selection);\n  }, [selection, setRecoilSelection]);\n  var setRecoilThumbnailGenerator = recoil_1.useSetRecoilState(thumbnails_recoil_1.thumbnailGeneratorState);\n  react_1.useEffect(function () {\n    setRecoilThumbnailGenerator(function () {\n      return thumbnailGenerator;\n    });\n  }, [thumbnailGenerator, setRecoilThumbnailGenerator]);\n  var setRecoilDoubleClickDelay = recoil_1.useSetRecoilState(file_actions_recoil_1.doubleClickDelayState);\n  react_1.useEffect(function () {\n    setRecoilDoubleClickDelay(doubleClickDelay);\n  }, [doubleClickDelay, setRecoilDoubleClickDelay]);\n\n  var _b = recoil_1.useRecoilState(file_list_recoil_1.fileEntrySizeState);\n\n  var setRecoilEnableDragAndDrop = recoil_1.useSetRecoilState(drag_and_drop_recoil_1.enableDragAndDropState);\n  react_1.useEffect(function () {\n    setRecoilEnableDragAndDrop(enableDragAndDrop);\n  }, [enableDragAndDrop, setRecoilEnableDragAndDrop]);\n  return null;\n}));","map":null,"metadata":{},"sourceType":"script"}