{"ast":null,"code":"import { Operators } from './pdf-operators';\nimport { PdfNumber } from './../primitives/pdf-number';\nimport { PointF, RectangleF } from './../drawing/pdf-drawing';\nimport { PdfString } from './../primitives/pdf-string';\nimport { PdfName } from './../primitives/pdf-name';\n/**\n * Helper class to `write PDF graphic streams` easily.\n * @private\n */\n\nvar PdfStreamWriter =\n/** @class */\nfunction () {\n  /**\n   * Initialize an instance of `PdfStreamWriter` class.\n   * @private\n   */\n  function PdfStreamWriter(stream) {\n    if (stream == null) {\n      throw new Error('ArgumentNullException:stream');\n    }\n\n    this.stream = stream;\n  } //Implementation\n\n  /**\n   * `Clear` the stream.\n   * @public\n   */\n\n\n  PdfStreamWriter.prototype.clear = function () {\n    this.stream.clearStream();\n  };\n\n  PdfStreamWriter.prototype.setGraphicsState = function (dictionaryName) {\n    if (dictionaryName instanceof PdfName) {\n      this.stream.write(dictionaryName.toString());\n      this.stream.write(Operators.whiteSpace);\n      this.writeOperator(Operators.setGraphicsState);\n    } else {\n      this.stream.write(Operators.slash);\n      this.stream.write(dictionaryName);\n      this.stream.write(Operators.whiteSpace);\n      this.writeOperator(Operators.setGraphicsState);\n    }\n  };\n  /**\n   * `Executes the XObject`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.executeObject = function (name) {\n    this.stream.write(name.toString());\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.paintXObject);\n    this.stream.write(Operators.newLine);\n  };\n  /**\n   * `Closes path object`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.closePath = function () {\n    this.writeOperator(Operators.closePath);\n  };\n  /**\n   * `Clips the path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.clipPath = function (useEvenOddRule) {\n    this.stream.write(Operators.clipPath);\n\n    if (useEvenOddRule) {\n      this.stream.write(Operators.evenOdd);\n    }\n\n    this.stream.write(Operators.whiteSpace);\n    this.stream.write(Operators.endPath);\n    this.stream.write(Operators.newLine);\n  };\n  /**\n   * `Closes, then fills and strokes the path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.closeFillStrokePath = function (useEvenOddRule) {\n    this.stream.write(Operators.closeFillStrokePath);\n\n    if (useEvenOddRule) {\n      this.stream.write(Operators.evenOdd);\n      this.stream.write(Operators.newLine);\n    } else {\n      this.stream.write(Operators.newLine);\n    }\n  };\n  /**\n   * `Fills and strokes path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.fillStrokePath = function (useEvenOddRule) {\n    this.stream.write(Operators.fillStroke);\n\n    if (useEvenOddRule) {\n      this.stream.write(Operators.evenOdd);\n      this.stream.write(Operators.newLine);\n    } else {\n      this.stream.write(Operators.newLine);\n    }\n  };\n  /**\n   * `Fills path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.fillPath = function (useEvenOddRule) {\n    this.stream.write(Operators.fill);\n\n    if (useEvenOddRule) {\n      this.stream.write(Operators.evenOdd);\n      this.stream.write(Operators.newLine);\n    } else {\n      this.stream.write(Operators.newLine);\n    }\n  };\n  /**\n   * `Ends the path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.endPath = function () {\n    this.writeOperator(Operators.n);\n  };\n  /**\n   * `Closes and fills the path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.closeFillPath = function (useEvenOddRule) {\n    this.writeOperator(Operators.closePath);\n    this.stream.write(Operators.fill);\n\n    if (useEvenOddRule) {\n      this.stream.write(Operators.evenOdd);\n      this.stream.write(Operators.newLine);\n    } else {\n      this.stream.write(Operators.newLine);\n    }\n  };\n  /**\n   * `Closes and strokes the path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.closeStrokePath = function () {\n    this.writeOperator(Operators.closeStrokePath);\n  };\n  /**\n   * `Sets the text scaling`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setTextScaling = function (textScaling) {\n    this.stream.write(PdfNumber.floatToString(textScaling));\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setTextScaling);\n  };\n  /**\n   * `Strokes path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.strokePath = function () {\n    this.writeOperator(Operators.stroke);\n  };\n  /**\n   * `Restores` the graphics state.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.restoreGraphicsState = function () {\n    this.writeOperator(Operators.restoreState);\n  };\n  /**\n   * `Saves` the graphics state.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.saveGraphicsState = function () {\n    this.writeOperator(Operators.saveState);\n  };\n\n  PdfStreamWriter.prototype.startNextLine = function (arg1, arg2) {\n    if (typeof arg1 === 'undefined') {\n      this.writeOperator(Operators.goToNextLine);\n    } else if (arg1 instanceof PointF) {\n      this.writePoint(arg1);\n      this.writeOperator(Operators.setCoords);\n    } else {\n      this.writePoint(arg1, arg2);\n      this.writeOperator(Operators.setCoords);\n    }\n  };\n  /**\n   * Shows the `text`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.showText = function (text) {\n    this.checkTextParam(text);\n    this.writeText(text);\n    this.writeOperator(Operators.setText);\n  };\n  /**\n   * Sets `text leading`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setLeading = function (leading) {\n    this.stream.write(PdfNumber.floatToString(leading));\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setTextLeading);\n  };\n  /**\n   * `Begins the path`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.beginPath = function (x, y) {\n    this.writePoint(x, y);\n    this.writeOperator(Operators.beginPath);\n  };\n  /**\n   * `Begins text`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.beginText = function () {\n    this.writeOperator(Operators.beginText);\n  };\n  /**\n   * `Ends text`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.endText = function () {\n    this.writeOperator(Operators.endText);\n  };\n\n  PdfStreamWriter.prototype.appendRectangle = function (arg1, arg2, arg3, arg4) {\n    if (arg1 instanceof RectangleF) {\n      this.appendRectangle(arg1.x, arg1.y, arg1.width, arg1.height);\n    } else {\n      this.writePoint(arg1, arg2);\n      this.writePoint(arg3, arg4);\n      this.writeOperator(Operators.appendRectangle);\n    }\n  };\n\n  PdfStreamWriter.prototype.appendLineSegment = function (arg1, arg2) {\n    if (arg1 instanceof PointF) {\n      this.appendLineSegment(arg1.x, arg1.y);\n    } else {\n      this.writePoint(arg1, arg2);\n      this.writeOperator(Operators.appendLineSegment);\n    }\n  };\n  /**\n   * Sets the `text rendering mode`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setTextRenderingMode = function (renderingMode) {\n    this.stream.write(renderingMode.toString());\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setRenderingMode);\n  };\n  /**\n   * Sets the `character spacing`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setCharacterSpacing = function (charSpacing) {\n    this.stream.write(PdfNumber.floatToString(charSpacing));\n    this.stream.write(Operators.whiteSpace);\n    this.stream.write(Operators.setCharacterSpace);\n    this.stream.write(Operators.newLine);\n  };\n  /**\n   * Sets the `word spacing`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setWordSpacing = function (wordSpacing) {\n    this.stream.write(PdfNumber.floatToString(wordSpacing));\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setWordSpace);\n  };\n\n  PdfStreamWriter.prototype.showNextLineText = function (arg1, arg2) {\n    if (arg1 instanceof PdfString) {\n      this.checkTextParam(arg1);\n      this.writeText(arg1);\n      this.writeOperator(Operators.setTextOnNewLine);\n    } else {\n      this.checkTextParam(arg1);\n      this.writeText(arg1, arg2);\n      this.writeOperator(Operators.setTextOnNewLine);\n    }\n  };\n\n  PdfStreamWriter.prototype.setColorSpace = function (arg1, arg2) {\n    if (arg1 instanceof PdfName && typeof arg2 === 'boolean') {\n      var temparg1 = arg1;\n      var temparg2 = arg2; // if (temparg1 == null) {\n      //     throw new Error('ArgumentNullException:name');\n      // }\n\n      var op = temparg2 ? Operators.selectcolorspaceforstroking : Operators.selectcolorspacefornonstroking;\n      this.stream.write(temparg1.toString());\n      this.stream.write(Operators.whiteSpace);\n      this.stream.write(op);\n      this.stream.write(Operators.newLine);\n    } else {\n      var temparg1 = arg1;\n      var temparg2 = arg2;\n      this.setColorSpace(new PdfName(temparg1), temparg2);\n    }\n  };\n  /**\n   * Modifies current `transformation matrix`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.modifyCtm = function (matrix) {\n    if (matrix == null) {\n      throw new Error('ArgumentNullException:matrix');\n    }\n\n    this.stream.write(matrix.toString());\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.modifyCtm);\n  };\n\n  PdfStreamWriter.prototype.setFont = function (font, name, size) {\n    if (typeof name === 'string') {\n      this.setFont(font, new PdfName(name), size);\n    } else {\n      if (font == null) {\n        throw new Error('ArgumentNullException:font');\n      }\n\n      this.stream.write(name.toString());\n      this.stream.write(Operators.whiteSpace);\n      this.stream.write(PdfNumber.floatToString(size));\n      this.stream.write(Operators.whiteSpace);\n      this.writeOperator(Operators.setFont);\n    }\n  };\n  /**\n   * `Writes the operator`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.writeOperator = function (opcode) {\n    this.stream.write(opcode);\n    this.stream.write(Operators.newLine);\n  };\n\n  PdfStreamWriter.prototype.checkTextParam = function (text) {\n    if (text == null) {\n      throw new Error('ArgumentNullException:text');\n    }\n\n    if (typeof text === 'string' && text === '') {\n      throw new Error('ArgumentException:The text can not be an empty string, text');\n    }\n  };\n\n  PdfStreamWriter.prototype.writeText = function (arg1, arg2) {\n    if (arg1 instanceof PdfString && typeof arg2 === 'undefined') {\n      this.stream.write(arg1.pdfEncode());\n    } else {\n      var start = void 0;\n      var end = void 0;\n\n      if (arg2) {\n        start = PdfString.hexStringMark[0];\n        end = PdfString.hexStringMark[1];\n      } else {\n        start = PdfString.stringMark[0];\n        end = PdfString.stringMark[1];\n      }\n\n      this.stream.write(start);\n      this.stream.write(arg1);\n      this.stream.write(end);\n    }\n  };\n\n  PdfStreamWriter.prototype.writePoint = function (arg1, arg2) {\n    if (arg1 instanceof PointF && typeof arg2 === 'undefined') {\n      this.writePoint(arg1.x, arg1.y);\n    } else {\n      var temparg1 = arg1;\n      this.stream.write(PdfNumber.floatToString(temparg1));\n      this.stream.write(Operators.whiteSpace); // NOTE: Change Y co-ordinate because we shifted co-ordinate system only.\n\n      arg2 = this.updateY(arg2);\n      this.stream.write(PdfNumber.floatToString(arg2));\n      this.stream.write(Operators.whiteSpace);\n    }\n  };\n  /**\n   * `Updates y` co-ordinate.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.updateY = function (arg) {\n    return -arg;\n  };\n  /**\n   * `Writes string` to the file.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.write = function (string) {\n    var builder = '';\n    builder += string;\n    builder += Operators.newLine;\n    this.writeOperator(builder);\n  };\n  /**\n   * `Writes comment` to the file.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.writeComment = function (comment) {\n    if (comment != null && comment.length > 0) {\n      var builder = '';\n      builder += Operators.comment;\n      builder += Operators.whiteSpace;\n      builder += comment; //builder.Append( Operators.NewLine );\n\n      this.writeOperator(builder);\n    } else {\n      throw new Error('Invalid comment');\n    }\n  };\n  /**\n   * Sets the `color and space`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setColorAndSpace = function (color, colorSpace, forStroking) {\n    if (!color.isEmpty) {\n      // bool test = color is PdfExtendedColor;\n      this.stream.write(color.toString(colorSpace, forStroking));\n      this.stream.write(Operators.newLine);\n    }\n  }; // public setLineDashPattern(pattern : number[], patternOffset : number) : void\n  // {\n  //     let pat : PdfArray = new PdfArray(pattern);\n  //     let off : PdfNumber = new PdfNumber(patternOffset);\n  //     this.setLineDashPatternHelper(pat, off);\n  // }\n  // private setLineDashPatternHelper(pattern : PdfArray, patternOffset : PdfNumber) : void\n  // {\n  //     pattern.Save(this);\n  //     this.m_stream.write(Operators.whiteSpace);\n  //     patternOffset.Save(this);\n  //     this.m_stream.write(Operators.whiteSpace);\n  //     this.writeOperator(Operators.setDashPattern);\n  // }\n\n  /**\n   * Sets the `line dash pattern`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setLineDashPattern = function (pattern, patternOffset) {\n    // let pat : PdfArray = new PdfArray(pattern);\n    // let off : PdfNumber = new PdfNumber(patternOffset);\n    // this.setLineDashPatternHelper(pat, off);\n    this.setLineDashPatternHelper(pattern, patternOffset);\n  };\n  /**\n   * Sets the `line dash pattern`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setLineDashPatternHelper = function (pattern, patternOffset) {\n    var tempPattern = '[';\n\n    if (pattern.length > 1) {\n      for (var index = 0; index < pattern.length; index++) {\n        if (index === pattern.length - 1) {\n          tempPattern += pattern[index].toString();\n        } else {\n          tempPattern += pattern[index].toString() + ' ';\n        }\n      }\n    }\n\n    tempPattern += '] ';\n    tempPattern += patternOffset.toString();\n    tempPattern += ' ' + Operators.setDashPattern;\n    this.stream.write(tempPattern);\n    this.stream.write(Operators.newLine);\n  };\n  /**\n   * Sets the `miter limit`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setMiterLimit = function (miterLimit) {\n    this.stream.write(PdfNumber.floatToString(miterLimit));\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setMiterLimit);\n  };\n  /**\n   * Sets the `width of the line`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setLineWidth = function (width) {\n    this.stream.write(PdfNumber.floatToString(width));\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setLineWidth);\n  };\n  /**\n   * Sets the `line cap`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setLineCap = function (lineCapStyle) {\n    this.stream.write(lineCapStyle.toString());\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setLineCapStyle);\n  };\n  /**\n   * Sets the `line join`.\n   * @private\n   */\n\n\n  PdfStreamWriter.prototype.setLineJoin = function (lineJoinStyle) {\n    this.stream.write(lineJoinStyle.toString());\n    this.stream.write(Operators.whiteSpace);\n    this.writeOperator(Operators.setLineJoinStyle);\n  };\n\n  Object.defineProperty(PdfStreamWriter.prototype, \"position\", {\n    //IPdfWriter members\n\n    /**\n     * Gets or sets the current `position` within the stream.\n     * @private\n     */\n    get: function () {\n      return this.stream.position;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PdfStreamWriter.prototype, \"length\", {\n    /**\n     * Gets `stream length`.\n     * @private\n     */\n    get: function () {\n      var returnValue = 0;\n\n      if (this.stream.data.length !== 0 && this.stream.data.length !== -1) {\n        for (var index = 0; index < this.stream.data.length; index++) {\n          returnValue += this.stream.data[index].length;\n        }\n      }\n\n      return returnValue;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PdfStreamWriter.prototype, \"document\", {\n    /**\n     * Gets and Sets the `current document`.\n     * @private\n     */\n    get: function () {\n      return null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /* tslint:disable-next-line:max-line-length */\n\n  PdfStreamWriter.prototype.appendBezierSegment = function (arg1, arg2, arg3, arg4, arg5, arg6) {\n    if (arg1 instanceof PointF && arg2 instanceof PointF && arg3 instanceof PointF) {\n      this.writePoint(arg1.x, arg1.y);\n      this.writePoint(arg2.x, arg2.y);\n      this.writePoint(arg3.x, arg3.y);\n    } else {\n      this.writePoint(arg1, arg2);\n      this.writePoint(arg3, arg4);\n      this.writePoint(arg5, arg6);\n    }\n\n    this.writeOperator(Operators.appendbeziercurve);\n  };\n\n  PdfStreamWriter.prototype.setColourWithPattern = function (colours, patternName, forStroking) {\n    if (colours != null) {\n      var count = colours.length;\n      var i = 0;\n\n      for (i = 0; i < count; ++i) {\n        this.stream.write(colours[i].toString());\n        this.stream.write(Operators.whiteSpace);\n      }\n    }\n\n    if (patternName != null) {\n      this.stream.write(patternName.toString());\n      this.stream.write(Operators.whiteSpace);\n    }\n\n    if (forStroking) {\n      this.writeOperator(Operators.setColorAndPatternStroking);\n    } else {\n      this.writeOperator(Operators.setColorAndPattern);\n    }\n  };\n\n  return PdfStreamWriter;\n}();\n\nexport { PdfStreamWriter };","map":null,"metadata":{},"sourceType":"module"}