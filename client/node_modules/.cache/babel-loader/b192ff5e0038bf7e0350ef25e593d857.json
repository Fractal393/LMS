{"ast":null,"code":"/**\r\n * DevExtreme (ui/tabs.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _devices = require(\"../core/devices\");\n\nvar _devices2 = _interopRequireDefault(_devices);\n\nvar _component_registrator = require(\"../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _button = require(\"./button\");\n\nvar _button2 = _interopRequireDefault(_button);\n\nvar _utils = require(\"./widget/utils.ink_ripple\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _utils3 = require(\"../events/utils\");\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _type = require(\"../core/utils/type\");\n\nvar _pointer = require(\"../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _iterator = require(\"../core/utils/iterator\");\n\nvar _item = require(\"./tabs/item\");\n\nvar _item2 = _interopRequireDefault(_item);\n\nvar _themes = require(\"./themes\");\n\nvar _themes2 = _interopRequireDefault(_themes);\n\nvar _hold = require(\"../events/hold\");\n\nvar _hold2 = _interopRequireDefault(_hold);\n\nvar _ui = require(\"./scroll_view/ui.scrollable\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _uiCollection_widget = require(\"./collection/ui.collection_widget.live_update\");\n\nvar _uiCollection_widget2 = _interopRequireDefault(_uiCollection_widget);\n\nvar _icon = require(\"../core/utils/icon\");\n\nvar _bindable_template = require(\"../core/templates/bindable_template\");\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TABS_CLASS = \"dx-tabs\";\nvar TABS_WRAPPER_CLASS = \"dx-tabs-wrapper\";\nvar TABS_EXPANDED_CLASS = \"dx-tabs-expanded\";\nvar TABS_STRETCHED_CLASS = \"dx-tabs-stretched\";\nvar TABS_SCROLLABLE_CLASS = \"dx-tabs-scrollable\";\nvar TABS_NAV_BUTTONS_CLASS = \"dx-tabs-nav-buttons\";\nvar OVERFLOW_HIDDEN_CLASS = \"dx-overflow-hidden\";\nvar TABS_ITEM_CLASS = \"dx-tab\";\nvar TABS_ITEM_SELECTED_CLASS = \"dx-tab-selected\";\nvar TABS_NAV_BUTTON_CLASS = \"dx-tabs-nav-button\";\nvar TABS_LEFT_NAV_BUTTON_CLASS = \"dx-tabs-nav-button-left\";\nvar TABS_RIGHT_NAV_BUTTON_CLASS = \"dx-tabs-nav-button-right\";\nvar TABS_ITEM_TEXT_CLASS = \"dx-tab-text\";\nvar TABS_ITEM_DATA_KEY = \"dxTabData\";\nvar BUTTON_NEXT_ICON = \"chevronnext\";\nvar BUTTON_PREV_ICON = \"chevronprev\";\nvar FEEDBACK_HIDE_TIMEOUT = 100;\nvar FEEDBACK_DURATION_INTERVAL = 5;\nvar FEEDBACK_SCROLL_TIMEOUT = 300;\nvar TAB_OFFSET = 30;\n\nvar Tabs = _uiCollection_widget2.default.inherit({\n  _activeStateUnit: \".\" + TABS_ITEM_CLASS,\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      hoverStateEnabled: true,\n      showNavButtons: true,\n      scrollByContent: true,\n      scrollingEnabled: true,\n      selectionMode: \"single\",\n      activeStateEnabled: true,\n      selectionRequired: false,\n      selectOnFocus: true,\n      loopItemFocus: false,\n      useInkRipple: false,\n      badgeExpr: function (data) {\n        return data ? data.badge : void 0;\n      }\n    });\n  },\n  _defaultOptionsRules: function () {\n    var themeName = _themes2.default.current();\n\n    return this.callBase().concat([{\n      device: function () {\n        return \"desktop\" !== _devices2.default.real().deviceType;\n      },\n      options: {\n        showNavButtons: false\n      }\n    }, {\n      device: {\n        deviceType: \"desktop\"\n      },\n      options: {\n        scrollByContent: false\n      }\n    }, {\n      device: function () {\n        return \"desktop\" === _devices2.default.real().deviceType && !_devices2.default.isSimulator();\n      },\n      options: {\n        focusStateEnabled: true\n      }\n    }, {\n      device: function () {\n        return _themes2.default.isMaterial(themeName);\n      },\n      options: {\n        useInkRipple: true,\n        selectOnFocus: false\n      }\n    }]);\n  },\n  _init: function () {\n    this.callBase();\n    this.setAria(\"role\", \"tablist\");\n    this.$element().addClass(TABS_CLASS);\n\n    this._renderWrapper();\n\n    this._renderMultiple();\n\n    this._feedbackHideTimeout = FEEDBACK_HIDE_TIMEOUT;\n  },\n  _initTemplates: function () {\n    this.callBase();\n\n    this._templateManager.addDefaultTemplates({\n      item: new _bindable_template.BindableTemplate(function ($container, data) {\n        if ((0, _type.isPlainObject)(data)) {\n          this._prepareDefaultItemTemplate(data, $container);\n        } else {\n          $container.text(String(data));\n        }\n\n        var $iconElement = (0, _icon.getImageContainer)(data.icon);\n        $iconElement && $iconElement.prependTo($container);\n        $container.wrapInner((0, _renderer2.default)(\"<span>\").addClass(TABS_ITEM_TEXT_CLASS));\n      }.bind(this), [\"text\", \"html\", \"icon\"], this.option(\"integrationOptions.watchMethod\"))\n    });\n  },\n  _createItemByTemplate: function (itemTemplate, renderArgs) {\n    var _this = this;\n\n    var itemData = renderArgs.itemData,\n        container = renderArgs.container,\n        index = renderArgs.index;\n    this._deferredTemplates[index] = new _deferred.Deferred();\n    return itemTemplate.render({\n      model: itemData,\n      container: container,\n      index: index,\n      onRendered: function () {\n        return _this._deferredTemplates[index].resolve();\n      }\n    });\n  },\n  _itemClass: function () {\n    return TABS_ITEM_CLASS;\n  },\n  _selectedItemClass: function () {\n    return TABS_ITEM_SELECTED_CLASS;\n  },\n  _itemDataKey: function () {\n    return TABS_ITEM_DATA_KEY;\n  },\n  _initMarkup: function () {\n    this._deferredTemplates = [];\n    this.callBase();\n    this.setAria(\"role\", \"tab\", this.itemElements());\n    this.option(\"useInkRipple\") && this._renderInkRipple();\n    this.$element().addClass(OVERFLOW_HIDDEN_CLASS);\n  },\n  _render: function () {\n    this.callBase();\n\n    this._deferRenderScrolling();\n  },\n  _deferRenderScrolling: function () {\n    var _this2 = this;\n\n    _deferred.when.apply(this, this._deferredTemplates).done(function () {\n      return _this2._renderScrolling();\n    });\n  },\n  _renderScrolling: function () {\n    var removeClasses = [TABS_STRETCHED_CLASS, TABS_EXPANDED_CLASS, OVERFLOW_HIDDEN_CLASS];\n    this.$element().removeClass(removeClasses.join(\" \"));\n\n    if (this.option(\"scrollingEnabled\") && this._isItemsWidthExceeded()) {\n      if (!this._scrollable) {\n        this._renderScrollable();\n\n        this._renderNavButtons();\n      }\n\n      this._scrollable.update();\n\n      this._updateNavButtonsVisibility();\n\n      if (this.option(\"rtlEnabled\")) {\n        this._scrollable.scrollTo({\n          left: this._scrollable.scrollWidth() - this._scrollable.clientWidth()\n        });\n      }\n\n      this._scrollToItem(this.option(\"selectedItem\"));\n    }\n\n    if (!(this.option(\"scrollingEnabled\") && this._isItemsWidthExceeded())) {\n      this._cleanScrolling();\n\n      if (this._needStretchItems() && !this._isItemsWidthExceeded()) {\n        this.$element().addClass(TABS_STRETCHED_CLASS);\n      }\n\n      this.$element().removeClass(TABS_NAV_BUTTONS_CLASS).addClass(TABS_EXPANDED_CLASS);\n    }\n  },\n  _isItemsWidthExceeded: function () {\n    var tabItemsWidth = this._getSummaryItemsWidth(this._getVisibleItems(), true);\n\n    return tabItemsWidth - 1 > this.$element().width();\n  },\n  _needStretchItems: function () {\n    var $visibleItems = this._getVisibleItems();\n\n    var elementWidth = this.$element().width();\n    var itemsWidth = [];\n    (0, _iterator.each)($visibleItems, function (_, item) {\n      itemsWidth.push((0, _renderer2.default)(item).outerWidth(true));\n    });\n    var maxTabWidth = Math.max.apply(null, itemsWidth);\n    return maxTabWidth > elementWidth / $visibleItems.length;\n  },\n  _cleanNavButtons: function () {\n    if (!this._leftButton || !this._rightButton) {\n      return;\n    }\n\n    this._leftButton.$element().remove();\n\n    this._rightButton.$element().remove();\n\n    this._leftButton = null;\n    this._rightButton = null;\n  },\n  _cleanScrolling: function () {\n    if (!this._scrollable) {\n      return;\n    }\n\n    this._$wrapper.appendTo(this.$element());\n\n    this._scrollable.$element().remove();\n\n    this._scrollable = null;\n\n    this._cleanNavButtons();\n  },\n  _renderInkRipple: function () {\n    this._inkRipple = _utils2.default.render();\n  },\n  _toggleActiveState: function ($element, value, e) {\n    this.callBase.apply(this, arguments);\n\n    if (!this._inkRipple) {\n      return;\n    }\n\n    var config = {\n      element: $element,\n      event: e\n    };\n\n    if (value) {\n      this._inkRipple.showWave(config);\n    } else {\n      this._inkRipple.hideWave(config);\n    }\n  },\n  _renderMultiple: function () {\n    if (\"multiple\" === this.option(\"selectionMode\")) {\n      this.option(\"selectOnFocus\", false);\n    }\n  },\n  _renderWrapper: function () {\n    this._$wrapper = (0, _renderer2.default)(\"<div>\").addClass(TABS_WRAPPER_CLASS);\n    this.$element().append(this._$wrapper);\n  },\n  _itemContainer: function () {\n    return this._$wrapper;\n  },\n  _renderScrollable: function () {\n    var $itemContainer = this.$element().wrapInner((0, _renderer2.default)(\"<div>\").addClass(TABS_SCROLLABLE_CLASS)).children();\n    this._scrollable = this._createComponent($itemContainer, _ui2.default, {\n      direction: \"horizontal\",\n      showScrollbar: false,\n      useKeyboard: false,\n      useNative: false,\n      scrollByContent: this.option(\"scrollByContent\"),\n      onScroll: this._updateNavButtonsVisibility.bind(this)\n    });\n    this.$element().append(this._scrollable.$element());\n  },\n  _scrollToItem: function (itemData) {\n    if (!this._scrollable) {\n      return;\n    }\n\n    var $item = this._editStrategy.getItemElement(itemData);\n\n    this._scrollable.scrollToElement($item);\n  },\n  _renderNavButtons: function () {\n    this.$element().toggleClass(TABS_NAV_BUTTONS_CLASS, this.option(\"showNavButtons\"));\n\n    if (!this.option(\"showNavButtons\")) {\n      return;\n    }\n\n    var rtlEnabled = this.option(\"rtlEnabled\");\n    this._leftButton = this._createNavButton(-TAB_OFFSET, rtlEnabled ? BUTTON_NEXT_ICON : BUTTON_PREV_ICON);\n\n    var $leftButton = this._leftButton.$element();\n\n    $leftButton.addClass(TABS_LEFT_NAV_BUTTON_CLASS);\n    this.$element().prepend($leftButton);\n    this._rightButton = this._createNavButton(TAB_OFFSET, rtlEnabled ? BUTTON_PREV_ICON : BUTTON_NEXT_ICON);\n\n    var $rightButton = this._rightButton.$element();\n\n    $rightButton.addClass(TABS_RIGHT_NAV_BUTTON_CLASS);\n    this.$element().append($rightButton);\n  },\n  _updateNavButtonsVisibility: function () {\n    this._leftButton && this._leftButton.option(\"disabled\", this._scrollable.scrollLeft() <= 0);\n    this._rightButton && this._rightButton.option(\"disabled\", this._scrollable.scrollLeft() >= Math.round(this._scrollable.scrollWidth() - this._scrollable.clientWidth()));\n  },\n  _updateScrollPosition: function (offset, duration) {\n    this._scrollable.update();\n\n    this._scrollable.scrollBy(offset / duration);\n  },\n  _createNavButton: function (offset, icon) {\n    var that = this;\n\n    var holdAction = that._createAction(function () {\n      that._holdInterval = setInterval(function () {\n        that._updateScrollPosition(offset, FEEDBACK_DURATION_INTERVAL);\n      }, FEEDBACK_DURATION_INTERVAL);\n    });\n\n    var holdEventName = (0, _utils3.addNamespace)(_hold2.default.name, \"dxNavButton\");\n    var pointerUpEventName = (0, _utils3.addNamespace)(_pointer2.default.up, \"dxNavButton\");\n    var pointerOutEventName = (0, _utils3.addNamespace)(_pointer2.default.out, \"dxNavButton\");\n\n    var navButton = this._createComponent((0, _renderer2.default)(\"<div>\").addClass(TABS_NAV_BUTTON_CLASS), _button2.default, {\n      focusStateEnabled: false,\n      icon: icon,\n      onClick: function () {\n        that._updateScrollPosition(offset, 1);\n      },\n      integrationOptions: {}\n    });\n\n    var $navButton = navButton.$element();\n\n    _events_engine2.default.on($navButton, holdEventName, {\n      timeout: FEEDBACK_SCROLL_TIMEOUT\n    }, function (e) {\n      holdAction({\n        event: e\n      });\n    }.bind(this));\n\n    _events_engine2.default.on($navButton, pointerUpEventName, function () {\n      that._clearInterval();\n    });\n\n    _events_engine2.default.on($navButton, pointerOutEventName, function () {\n      that._clearInterval();\n    });\n\n    return navButton;\n  },\n  _clearInterval: function () {\n    if (this._holdInterval) {\n      clearInterval(this._holdInterval);\n    }\n  },\n  _updateSelection: function (addedSelection) {\n    this._scrollable && this._scrollable.scrollToElement(this.itemElements().eq(addedSelection[0]), {\n      left: 1,\n      right: 1\n    });\n  },\n  _visibilityChanged: function (visible) {\n    if (visible) {\n      this._dimensionChanged();\n    }\n  },\n  _dimensionChanged: function () {\n    this._renderScrolling();\n  },\n  _itemSelectHandler: function (e) {\n    if (\"single\" === this.option(\"selectionMode\") && this.isItemSelected(e.currentTarget)) {\n      return;\n    }\n\n    this.callBase(e);\n  },\n  _clean: function () {\n    this._deferredTemplates = [];\n\n    this._cleanScrolling();\n\n    this.callBase();\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"useInkRipple\":\n      case \"scrollingEnabled\":\n      case \"showNavButtons\":\n        this._invalidate();\n\n        break;\n\n      case \"scrollByContent\":\n        this._scrollable && this._scrollable.option(args.name, args.value);\n        break;\n\n      case \"width\":\n        this.callBase(args);\n\n        this._dimensionChanged();\n\n        break;\n\n      case \"selectionMode\":\n        this._renderMultiple();\n\n        this.callBase(args);\n        break;\n\n      case \"badgeExpr\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _afterItemElementInserted: function () {\n    this.callBase();\n\n    this._deferRenderScrolling();\n  },\n  _afterItemElementDeleted: function ($item, deletedActionArgs) {\n    this.callBase($item, deletedActionArgs);\n\n    this._renderScrolling();\n  }\n});\n\nTabs.ItemClass = _item2.default;\n(0, _component_registrator2.default)(\"dxTabs\", Tabs);\nmodule.exports = Tabs;\nmodule.exports.getTabsExpandedClass = TABS_EXPANDED_CLASS;\nmodule.exports.default = module.exports;","map":null,"metadata":{},"sourceType":"script"}