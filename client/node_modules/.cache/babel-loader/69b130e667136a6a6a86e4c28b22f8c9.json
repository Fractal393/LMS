{"ast":null,"code":"/**\r\n * DevExtreme (ui/form/ui.form.layout_manager.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _guid = require(\"../../core/guid\");\n\nvar _guid2 = _interopRequireDefault(_guid);\n\nvar _uiForm = require(\"./ui.form.items_runtime_info\");\n\nvar _uiForm2 = _interopRequireDefault(_uiForm);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _variable_wrapper = require(\"../../core/utils/variable_wrapper\");\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _string = require(\"../../core/utils/string\");\n\nvar _string2 = _interopRequireDefault(_string);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _data2 = _interopRequireDefault(_data);\n\nvar _remove_event = require(\"../../core/remove_event\");\n\nvar _remove_event2 = _interopRequireDefault(_remove_event);\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _style = require(\"../../core/utils/style\");\n\nvar _style2 = _interopRequireDefault(_style);\n\nvar _inflector = require(\"../../core/utils/inflector\");\n\nvar _inflector2 = _interopRequireDefault(_inflector);\n\nvar _ui3 = require(\"../widget/ui.widget\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _validator = require(\"../validator\");\n\nvar _validator2 = _interopRequireDefault(_validator);\n\nvar _responsive_box = require(\"../responsive_box\");\n\nvar _responsive_box2 = _interopRequireDefault(_responsive_box);\n\nvar _themes = require(\"../themes\");\n\nvar _themes2 = _interopRequireDefault(_themes);\n\nrequire(\"../text_box\");\n\nrequire(\"../number_box\");\n\nrequire(\"../check_box\");\n\nrequire(\"../date_box\");\n\nrequire(\"../button\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) {\n    return;\n  }\n\n  if (\"string\" === typeof o) {\n    return _arrayLikeToArray(o, minLen);\n  }\n\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n\n  if (\"Object\" === n && o.constructor) {\n    n = o.constructor.name;\n  }\n\n  if (\"Map\" === n || \"Set\" === n) {\n    return Array.from(o);\n  }\n\n  if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\n    return _arrayLikeToArray(o, minLen);\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (\"undefined\" !== typeof Symbol && Symbol.iterator in Object(iter)) {\n    return Array.from(iter);\n  }\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    return _arrayLikeToArray(arr);\n  }\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (null == len || len > arr.length) {\n    len = arr.length;\n  }\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nvar FORM_EDITOR_BY_DEFAULT = \"dxTextBox\";\nvar FIELD_ITEM_CLASS = \"dx-field-item\";\nvar FIELD_EMPTY_ITEM_CLASS = \"dx-field-empty-item\";\nvar FIELD_BUTTON_ITEM_CLASS = \"dx-field-button-item\";\nvar FIELD_ITEM_REQUIRED_CLASS = \"dx-field-item-required\";\nvar FIELD_ITEM_OPTIONAL_CLASS = \"dx-field-item-optional\";\nvar FIELD_ITEM_REQUIRED_MARK_CLASS = \"dx-field-item-required-mark\";\nvar FIELD_ITEM_OPTIONAL_MARK_CLASS = \"dx-field-item-optional-mark\";\nvar FIELD_ITEM_LABEL_CLASS = \"dx-field-item-label\";\nvar FIELD_ITEM_LABEL_ALIGN_CLASS = \"dx-field-item-label-align\";\nvar FIELD_ITEM_LABEL_CONTENT_CLASS = \"dx-field-item-label-content\";\nvar FIELD_ITEM_LABEL_TEXT_CLASS = \"dx-field-item-label-text\";\nvar FIELD_ITEM_LABEL_LOCATION_CLASS = \"dx-field-item-label-location-\";\nvar FIELD_ITEM_CONTENT_CLASS = \"dx-field-item-content\";\nvar FIELD_ITEM_CONTENT_LOCATION_CLASS = \"dx-field-item-content-location-\";\nvar FIELD_ITEM_CONTENT_WRAPPER_CLASS = \"dx-field-item-content-wrapper\";\nvar FIELD_ITEM_HELP_TEXT_CLASS = \"dx-field-item-help-text\";\nvar SINGLE_COLUMN_ITEM_CONTENT = \"dx-single-column-item-content\";\nvar LABEL_HORIZONTAL_ALIGNMENT_CLASS = \"dx-label-h-align\";\nvar LABEL_VERTICAL_ALIGNMENT_CLASS = \"dx-label-v-align\";\nvar FORM_LAYOUT_MANAGER_CLASS = \"dx-layout-manager\";\nvar LAYOUT_MANAGER_FIRST_ROW_CLASS = \"dx-first-row\";\nvar LAYOUT_MANAGER_LAST_ROW_CLASS = \"dx-last-row\";\nvar LAYOUT_MANAGER_FIRST_COL_CLASS = \"dx-first-col\";\nvar LAYOUT_MANAGER_LAST_COL_CLASS = \"dx-last-col\";\nvar LAYOUT_MANAGER_ONE_COLUMN = \"dx-layout-manager-one-col\";\nvar FLEX_LAYOUT_CLASS = \"dx-flex-layout\";\nvar INVALID_CLASS = \"dx-invalid\";\nvar LAYOUT_STRATEGY_FLEX = \"flex\";\nvar LAYOUT_STRATEGY_FALLBACK = \"fallback\";\nvar SIMPLE_ITEM_TYPE = \"simple\";\nvar TEMPLATE_WRAPPER_CLASS = \"dx-template-wrapper\";\nvar DATA_OPTIONS = [\"dataSource\", \"items\"];\nvar EDITORS_WITH_ARRAY_VALUE = [\"dxTagBox\", \"dxRangeSlider\"];\n\nvar LayoutManager = _ui4.default.inherit({\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      layoutData: {},\n      readOnly: false,\n      colCount: 1,\n      colCountByScreen: void 0,\n      labelLocation: \"left\",\n      onFieldDataChanged: null,\n      onEditorEnterKey: null,\n      customizeItem: null,\n      alignItemLabels: true,\n      minColWidth: 200,\n      showRequiredMark: true,\n      screenByWidth: null,\n      showOptionalMark: false,\n      requiredMark: \"*\",\n      optionalMark: _message2.default.format(\"dxForm-optionalMark\"),\n      requiredMessage: _message2.default.getFormatter(\"dxForm-requiredMessage\")\n    });\n  },\n  _setOptionsByReference: function () {\n    this.callBase();\n    (0, _extend.extend)(this._optionsByReference, {\n      layoutData: true,\n      validationGroup: true\n    });\n  },\n  _init: function () {\n    var layoutData = this.option(\"layoutData\");\n    this.callBase();\n    this._itemWatchers = [];\n    this._itemsRunTimeInfo = new _uiForm2.default();\n\n    this._updateReferencedOptions(layoutData);\n\n    this._initDataAndItems(layoutData);\n  },\n  _dispose: function () {\n    this.callBase();\n\n    this._cleanItemWatchers();\n  },\n  _initDataAndItems: function (initialData) {\n    this._syncDataWithItems();\n\n    this._updateItems(initialData);\n  },\n  _syncDataWithItems: function () {\n    var _this = this;\n\n    var layoutData = this.option(\"layoutData\");\n    var userItems = this.option(\"items\");\n\n    if ((0, _type.isDefined)(userItems)) {\n      userItems.forEach(function (item) {\n        if (item.dataField && void 0 === _this._getDataByField(item.dataField)) {\n          var value;\n\n          if (item.editorOptions) {\n            value = item.editorOptions.value;\n          }\n\n          if ((0, _type.isDefined)(value) || item.dataField in layoutData) {\n            _this._updateFieldValue(item.dataField, value);\n          }\n        }\n      });\n    }\n  },\n  _getDataByField: function (dataField) {\n    return dataField ? this.option(\"layoutData.\" + dataField) : null;\n  },\n  _isCheckboxUndefinedStateEnabled: function (editorOption) {\n    if (true === editorOption.allowIndeterminateState && \"dxCheckBox\" === editorOption.editorType) {\n      var nameParts = [\"layoutData\"].concat(_toConsumableArray(editorOption.dataField.split(\".\")));\n      var propertyName = nameParts.pop();\n      var layoutData = this.option(nameParts.join(\".\"));\n      return propertyName in layoutData;\n    }\n\n    return false;\n  },\n  _updateFieldValue: function (dataField, value) {\n    var layoutData = this.option(\"layoutData\");\n    var newValue = value;\n\n    if (!(0, _variable_wrapper.isWrapped)(layoutData[dataField]) && (0, _type.isDefined)(dataField)) {\n      this.option(\"layoutData.\" + dataField, newValue);\n    } else {\n      if ((0, _variable_wrapper.isWritableWrapped)(layoutData[dataField])) {\n        newValue = (0, _type.isFunction)(newValue) ? newValue() : newValue;\n        layoutData[dataField](newValue);\n      }\n    }\n\n    this._triggerOnFieldDataChanged({\n      dataField: dataField,\n      value: newValue\n    });\n  },\n  _triggerOnFieldDataChanged: function (args) {\n    this._createActionByOption(\"onFieldDataChanged\")(args);\n  },\n  _updateItems: function (layoutData) {\n    var that = this;\n    var userItems = this.option(\"items\");\n    var isUserItemsExist = (0, _type.isDefined)(userItems);\n    var customizeItem = that.option(\"customizeItem\");\n    var items = isUserItemsExist ? userItems : this._generateItemsByData(layoutData);\n\n    if ((0, _type.isDefined)(items)) {\n      var processedItems = [];\n      (0, _iterator.each)(items, function (index, item) {\n        if (that._isAcceptableItem(item)) {\n          item = that._processItem(item);\n          customizeItem && customizeItem(item);\n\n          if ((0, _type.isObject)(item) && false !== (0, _variable_wrapper.unwrap)(item.visible)) {\n            processedItems.push(item);\n          }\n        }\n      });\n\n      if (!that._itemWatchers.length || !isUserItemsExist) {\n        that._updateItemWatchers(items);\n      }\n\n      this._items = processedItems;\n\n      this._sortItems();\n    }\n  },\n  _cleanItemWatchers: function () {\n    this._itemWatchers.forEach(function (dispose) {\n      dispose();\n    });\n\n    this._itemWatchers = [];\n  },\n  _updateItemWatchers: function (items) {\n    var that = this;\n\n    var watch = that._getWatch();\n\n    items.forEach(function (item) {\n      if ((0, _type.isObject)(item) && (0, _type.isDefined)(item.visible) && (0, _type.isFunction)(watch)) {\n        that._itemWatchers.push(watch(function () {\n          return (0, _variable_wrapper.unwrap)(item.visible);\n        }, function () {\n          that._updateItems(that.option(\"layoutData\"));\n\n          that.repaint();\n        }, {\n          skipImmediate: true\n        }));\n      }\n    });\n  },\n  _generateItemsByData: function (layoutData) {\n    var result = [];\n\n    if ((0, _type.isDefined)(layoutData)) {\n      (0, _iterator.each)(layoutData, function (dataField) {\n        result.push({\n          dataField: dataField\n        });\n      });\n    }\n\n    return result;\n  },\n  _isAcceptableItem: function (item) {\n    var itemField = item.dataField || item;\n\n    var itemData = this._getDataByField(itemField);\n\n    return !((0, _type.isFunction)(itemData) && !(0, _variable_wrapper.isWrapped)(itemData));\n  },\n  _processItem: function (item) {\n    if (\"string\" === typeof item) {\n      item = {\n        dataField: item\n      };\n    }\n\n    if (\"object\" === _typeof(item) && !item.itemType) {\n      item.itemType = SIMPLE_ITEM_TYPE;\n    }\n\n    if (!(0, _type.isDefined)(item.editorType) && (0, _type.isDefined)(item.dataField)) {\n      var value = this._getDataByField(item.dataField);\n\n      item.editorType = (0, _type.isDefined)(value) ? this._getEditorTypeByDataType((0, _type.type)(value)) : FORM_EDITOR_BY_DEFAULT;\n    }\n\n    if (\"dxCheckBox\" === item.editorType) {\n      var _item$allowIndetermin;\n\n      item.allowIndeterminateState = null !== (_item$allowIndetermin = item.allowIndeterminateState) && void 0 !== _item$allowIndetermin ? _item$allowIndetermin : true;\n    }\n\n    return item;\n  },\n  _getEditorTypeByDataType: function (dataType) {\n    switch (dataType) {\n      case \"number\":\n        return \"dxNumberBox\";\n\n      case \"date\":\n        return \"dxDateBox\";\n\n      case \"boolean\":\n        return \"dxCheckBox\";\n\n      default:\n        return \"dxTextBox\";\n    }\n  },\n  _sortItems: function () {\n    (0, _array.normalizeIndexes)(this._items, \"visibleIndex\");\n\n    this._sortIndexes();\n  },\n  _sortIndexes: function () {\n    this._items.sort(function (itemA, itemB) {\n      var indexA = itemA.visibleIndex;\n      var indexB = itemB.visibleIndex;\n      var result;\n\n      if (indexA > indexB) {\n        result = 1;\n      } else {\n        if (indexA < indexB) {\n          result = -1;\n        } else {\n          result = 0;\n        }\n      }\n\n      return result;\n    });\n  },\n  _initMarkup: function () {\n    this._itemsRunTimeInfo.clear();\n\n    this.$element().addClass(FORM_LAYOUT_MANAGER_CLASS);\n    this.callBase();\n\n    this._renderResponsiveBox();\n  },\n  _hasBrowserFlex: function () {\n    return _style2.default.styleProp(LAYOUT_STRATEGY_FLEX) === LAYOUT_STRATEGY_FLEX;\n  },\n  _renderResponsiveBox: function () {\n    var that = this;\n    var templatesInfo = [];\n\n    if (that._items && that._items.length) {\n      var colCount = that._getColCount();\n\n      var $container = (0, _renderer2.default)(\"<div>\").appendTo(that.$element());\n\n      that._prepareItemsWithMerging(colCount);\n\n      var layoutItems = that._generateLayoutItems();\n\n      that._extendItemsWithDefaultTemplateOptions(layoutItems, that._items);\n\n      that._responsiveBox = that._createComponent($container, _responsive_box2.default, that._getResponsiveBoxConfig(layoutItems, colCount, templatesInfo));\n\n      if (!_window2.default.hasWindow()) {\n        that._renderTemplates(templatesInfo);\n      }\n    }\n  },\n  _extendItemsWithDefaultTemplateOptions: function (targetItems, sourceItems) {\n    sourceItems.forEach(function (item) {\n      if (!item.merged) {\n        if ((0, _type.isDefined)(item.disabled)) {\n          targetItems[item.visibleIndex].disabled = item.disabled;\n        }\n\n        if ((0, _type.isDefined)(item.visible)) {\n          targetItems[item.visibleIndex].visible = item.visible;\n        }\n      }\n    });\n  },\n  _itemStateChangedHandler: function (e) {\n    this._refresh();\n  },\n  _renderTemplate: function ($container, item) {\n    switch (item.itemType) {\n      case \"empty\":\n        this._renderEmptyItem($container);\n\n        break;\n\n      case \"button\":\n        this._renderButtonItem(item, $container);\n\n        break;\n\n      default:\n        this._renderFieldItem(item, $container);\n\n    }\n  },\n  _renderTemplates: function (templatesInfo) {\n    var that = this;\n    (0, _iterator.each)(templatesInfo, function (index, info) {\n      that._renderTemplate(info.container, info.formItem);\n    });\n  },\n  _getResponsiveBoxConfig: function (layoutItems, colCount, templatesInfo) {\n    var that = this;\n    var colCountByScreen = that.option(\"colCountByScreen\");\n    var xsColCount = colCountByScreen && colCountByScreen.xs;\n    return {\n      onItemStateChanged: this._itemStateChangedHandler.bind(this),\n      _layoutStrategy: that._hasBrowserFlex() ? LAYOUT_STRATEGY_FLEX : LAYOUT_STRATEGY_FALLBACK,\n      onLayoutChanged: function onLayoutChanged() {\n        var onLayoutChanged = that.option(\"onLayoutChanged\");\n        var isSingleColumnMode = that.isSingleColumnMode();\n\n        if (onLayoutChanged) {\n          that.$element().toggleClass(LAYOUT_MANAGER_ONE_COLUMN, isSingleColumnMode);\n          onLayoutChanged(isSingleColumnMode);\n        }\n      },\n      onContentReady: function (e) {\n        if (_window2.default.hasWindow()) {\n          that._renderTemplates(templatesInfo);\n        }\n\n        if (that.option(\"onLayoutChanged\")) {\n          that.$element().toggleClass(LAYOUT_MANAGER_ONE_COLUMN, that.isSingleColumnMode(e.component));\n        }\n      },\n      itemTemplate: function (e, itemData, itemElement) {\n        if (!e.location) {\n          return;\n        }\n\n        var $itemElement = (0, _renderer2.default)(itemElement);\n        var itemRenderedCountInPreviousRows = e.location.row * colCount;\n        var item = that._items[e.location.col + itemRenderedCountInPreviousRows];\n        var $fieldItem = (0, _renderer2.default)(\"<div>\").addClass(item.cssClass).appendTo($itemElement);\n        templatesInfo.push({\n          container: $fieldItem,\n          formItem: item\n        });\n        $itemElement.toggleClass(SINGLE_COLUMN_ITEM_CONTENT, that.isSingleColumnMode(this));\n\n        if (0 === e.location.row) {\n          $fieldItem.addClass(LAYOUT_MANAGER_FIRST_ROW_CLASS);\n        }\n\n        if (0 === e.location.col) {\n          $fieldItem.addClass(LAYOUT_MANAGER_FIRST_COL_CLASS);\n        }\n\n        var isLastColumn = e.location.col === colCount - 1 || e.location.col + e.location.colspan === colCount;\n\n        var rowsCount = that._getRowsCount();\n\n        var isLastRow = e.location.row === rowsCount - 1;\n\n        if (isLastColumn) {\n          $fieldItem.addClass(LAYOUT_MANAGER_LAST_COL_CLASS);\n        }\n\n        if (isLastRow) {\n          $fieldItem.addClass(LAYOUT_MANAGER_LAST_ROW_CLASS);\n        }\n      },\n      cols: that._generateRatio(colCount),\n      rows: that._generateRatio(that._getRowsCount(), true),\n      dataSource: layoutItems,\n      screenByWidth: that.option(\"screenByWidth\"),\n      singleColumnScreen: xsColCount ? false : \"xs\"\n    };\n  },\n  _getColCount: function () {\n    var colCount = this.option(\"colCount\");\n    var colCountByScreen = this.option(\"colCountByScreen\");\n\n    if (colCountByScreen) {\n      var screenFactor = this.option(\"form\").getTargetScreenFactor();\n\n      if (!screenFactor) {\n        screenFactor = _window2.default.hasWindow() ? _window2.default.getCurrentScreenFactor(this.option(\"screenByWidth\")) : \"lg\";\n      }\n\n      colCount = colCountByScreen[screenFactor] || colCount;\n    }\n\n    if (\"auto\" === colCount) {\n      if (this._cashedColCount) {\n        return this._cashedColCount;\n      }\n\n      this._cashedColCount = colCount = this._getMaxColCount();\n    }\n\n    return colCount < 1 ? 1 : colCount;\n  },\n  _getMaxColCount: function () {\n    if (!_window2.default.hasWindow()) {\n      return 1;\n    }\n\n    var minColWidth = this.option(\"minColWidth\");\n    var width = this.$element().width();\n    var itemsCount = this._items.length;\n    var maxColCount = Math.floor(width / minColWidth) || 1;\n    return itemsCount < maxColCount ? itemsCount : maxColCount;\n  },\n  isCachedColCountObsolete: function () {\n    return this._cashedColCount && this._getMaxColCount() !== this._cashedColCount;\n  },\n  _prepareItemsWithMerging: function (colCount) {\n    var items = this._items.slice(0);\n\n    var item;\n    var itemsMergedByCol;\n    var result = [];\n    var j;\n    var i;\n\n    for (i = 0; i < items.length; i++) {\n      item = items[i];\n      result.push(item);\n\n      if (this.option(\"alignItemLabels\") || item.alignItemLabels || item.colSpan) {\n        item.col = this._getColByIndex(result.length - 1, colCount);\n      }\n\n      if (item.colSpan > 1 && item.col + item.colSpan <= colCount) {\n        itemsMergedByCol = [];\n\n        for (j = 0; j < item.colSpan - 1; j++) {\n          itemsMergedByCol.push({\n            merged: true\n          });\n        }\n\n        result = result.concat(itemsMergedByCol);\n      } else {\n        delete item.colSpan;\n      }\n    }\n\n    this._items = result;\n  },\n  _getColByIndex: function (index, colCount) {\n    return index % colCount;\n  },\n  _generateLayoutItems: function () {\n    var items = this._items;\n\n    var colCount = this._getColCount();\n\n    var result = [];\n    var item;\n    var i;\n\n    for (i = 0; i < items.length; i++) {\n      item = items[i];\n\n      if (!item.merged) {\n        var generatedItem = {\n          location: {\n            row: parseInt(i / colCount),\n            col: this._getColByIndex(i, colCount)\n          }\n        };\n\n        if ((0, _type.isDefined)(item.colSpan)) {\n          generatedItem.location.colspan = item.colSpan;\n        }\n\n        if ((0, _type.isDefined)(item.rowSpan)) {\n          generatedItem.location.rowspan = item.rowSpan;\n        }\n\n        result.push(generatedItem);\n      }\n    }\n\n    return result;\n  },\n  _renderEmptyItem: function ($container) {\n    return $container.addClass(FIELD_EMPTY_ITEM_CLASS).html(\"&nbsp;\");\n  },\n  _getButtonHorizontalAlignment: function (item) {\n    if ((0, _type.isDefined)(item.horizontalAlignment)) {\n      return item.horizontalAlignment;\n    }\n\n    if ((0, _type.isDefined)(item.alignment)) {\n      _ui2.default.log(\"W0001\", \"dxForm\", \"alignment\", \"18.1\", \"Use the 'horizontalAlignment' option in button items instead.\");\n\n      return item.alignment;\n    }\n\n    return \"right\";\n  },\n  _getButtonVerticalAlignment: function (item) {\n    switch (item.verticalAlignment) {\n      case \"center\":\n        return \"center\";\n\n      case \"bottom\":\n        return \"flex-end\";\n\n      default:\n        return \"flex-start\";\n    }\n  },\n  _renderButtonItem: function (item, $container) {\n    var $button = (0, _renderer2.default)(\"<div>\").appendTo($container);\n    var defaultOptions = {\n      validationGroup: this.option(\"validationGroup\")\n    };\n    $container.addClass(FIELD_BUTTON_ITEM_CLASS).css(\"textAlign\", this._getButtonHorizontalAlignment(item));\n    $container.parent().css(\"justifyContent\", this._getButtonVerticalAlignment(item));\n\n    var instance = this._createComponent($button, \"dxButton\", (0, _extend.extend)(defaultOptions, item.buttonOptions));\n\n    this._itemsRunTimeInfo.add({\n      item: item,\n      widgetInstance: instance,\n      guid: item.guid,\n      $itemContainer: $container\n    });\n\n    this._addItemClasses($container, item.col);\n\n    return $button;\n  },\n  _addItemClasses: function ($item, column) {\n    $item.addClass(FIELD_ITEM_CLASS).addClass(this.option(\"cssItemClass\")).addClass((0, _type.isDefined)(column) ? \"dx-col-\" + column : \"\");\n  },\n  _renderFieldItem: function (item, $container) {\n    var that = this;\n\n    var name = that._getName(item);\n\n    var id = that.getItemID(name);\n    var isRequired = (0, _type.isDefined)(item.isRequired) ? item.isRequired : !!that._hasRequiredRuleInSet(item.validationRules);\n\n    var labelOptions = that._getLabelOptions(item, id, isRequired);\n\n    var $editor = (0, _renderer2.default)(\"<div>\");\n    var helpID = item.helpText ? \"dx-\" + new _guid2.default() : null;\n    var $label;\n\n    this._addItemClasses($container, item.col);\n\n    $container.addClass(isRequired ? FIELD_ITEM_REQUIRED_CLASS : FIELD_ITEM_OPTIONAL_CLASS);\n\n    if (labelOptions.visible && labelOptions.text) {\n      $label = that._renderLabel(labelOptions).appendTo($container);\n    }\n\n    if (item.itemType === SIMPLE_ITEM_TYPE) {\n      if (that._isLabelNeedBaselineAlign(item) && \"top\" !== labelOptions.location) {\n        $container.addClass(FIELD_ITEM_LABEL_ALIGN_CLASS);\n      }\n\n      that._hasBrowserFlex() && $container.addClass(FLEX_LAYOUT_CLASS);\n    }\n\n    $editor.data(\"dx-form-item\", item);\n\n    that._appendEditorToField({\n      $fieldItem: $container,\n      $label: $label,\n      $editor: $editor,\n      labelOptions: labelOptions\n    });\n\n    var instance = that._renderEditor({\n      $container: $editor,\n      dataField: item.dataField,\n      name: item.name,\n      editorType: item.editorType,\n      editorOptions: item.editorOptions,\n      template: that._getTemplateByFieldItem(item),\n      isRequired: isRequired,\n      helpID: helpID,\n      labelID: labelOptions.labelID,\n      id: id,\n      validationBoundary: that.option(\"validationBoundary\"),\n      allowIndeterminateState: item.allowIndeterminateState\n    });\n\n    this._itemsRunTimeInfo.add({\n      item: item,\n      widgetInstance: instance,\n      guid: item.guid,\n      $itemContainer: $container\n    });\n\n    var editorElem = $editor.children().first();\n    var $validationTarget = editorElem.hasClass(TEMPLATE_WRAPPER_CLASS) ? editorElem.children().first() : editorElem;\n\n    if ($validationTarget && $validationTarget.data(\"dx-validation-target\")) {\n      that._renderValidator($validationTarget, item);\n    }\n\n    that._renderHelpText(item, $editor, helpID);\n\n    that._attachClickHandler($label, $editor, item.editorType);\n  },\n  _hasRequiredRuleInSet: function (rules) {\n    var hasRequiredRule;\n\n    if (rules && rules.length) {\n      (0, _iterator.each)(rules, function (index, rule) {\n        if (\"required\" === rule.type) {\n          hasRequiredRule = true;\n          return false;\n        }\n      });\n    }\n\n    return hasRequiredRule;\n  },\n  _getName: function (item) {\n    return item.dataField || item.name;\n  },\n  _isLabelNeedBaselineAlign: function (item) {\n    var largeEditors = [\"dxTextArea\", \"dxRadioGroup\", \"dxCalendar\", \"dxHtmlEditor\"];\n    return !!item.helpText && !this._hasBrowserFlex() || (0, _array.inArray)(item.editorType, largeEditors) !== -1;\n  },\n  _isLabelNeedId: function (item) {\n    var editorsRequiringIdForLabel = [\"dxRadioGroup\", \"dxCheckBox\", \"dxLookup\", \"dxSlider\", \"dxRangeSlider\", \"dxSwitch\", \"dxHtmlEditor\"];\n    return (0, _array.inArray)(item.editorType, editorsRequiringIdForLabel) !== -1;\n  },\n  _getLabelOptions: function (item, id, isRequired) {\n    var labelOptions = (0, _extend.extend)({\n      showColon: this.option(\"showColonAfterLabel\"),\n      location: this.option(\"labelLocation\"),\n      id: id,\n      visible: true,\n      isRequired: isRequired\n    }, item ? item.label : {});\n\n    if (this._isLabelNeedId(item)) {\n      labelOptions.labelID = \"dx-label-\".concat(new _guid2.default());\n    }\n\n    if (!labelOptions.text && item.dataField) {\n      labelOptions.text = _inflector2.default.captionize(item.dataField);\n    }\n\n    if (labelOptions.text) {\n      labelOptions.text += labelOptions.showColon ? \":\" : \"\";\n    }\n\n    return labelOptions;\n  },\n  _renderLabel: function (options) {\n    var text = options.text,\n        id = options.id,\n        location = options.location,\n        alignment = options.alignment,\n        isRequired = options.isRequired,\n        _options$labelID = options.labelID,\n        labelID = void 0 === _options$labelID ? null : _options$labelID;\n\n    if ((0, _type.isDefined)(text) && text.length > 0) {\n      var labelClasses = FIELD_ITEM_LABEL_CLASS + \" \" + FIELD_ITEM_LABEL_LOCATION_CLASS + location;\n      var $label = (0, _renderer2.default)(\"<label>\").addClass(labelClasses).attr(\"for\", id).attr(\"id\", labelID);\n      var $labelContent = (0, _renderer2.default)(\"<span>\").addClass(FIELD_ITEM_LABEL_CONTENT_CLASS).appendTo($label);\n      (0, _renderer2.default)(\"<span>\").addClass(FIELD_ITEM_LABEL_TEXT_CLASS).text(text).appendTo($labelContent);\n\n      if (alignment) {\n        $label.css(\"textAlign\", alignment);\n      }\n\n      $labelContent.append(this._renderLabelMark(isRequired));\n      return $label;\n    }\n  },\n  _renderLabelMark: function (isRequired) {\n    var $mark;\n\n    var requiredMarksConfig = this._getRequiredMarksConfig();\n\n    var isRequiredMark = requiredMarksConfig.showRequiredMark && isRequired;\n    var isOptionalMark = requiredMarksConfig.showOptionalMark && !isRequired;\n\n    if (isRequiredMark || isOptionalMark) {\n      var markClass = isRequiredMark ? FIELD_ITEM_REQUIRED_MARK_CLASS : FIELD_ITEM_OPTIONAL_MARK_CLASS;\n      var markText = isRequiredMark ? requiredMarksConfig.requiredMark : requiredMarksConfig.optionalMark;\n      $mark = (0, _renderer2.default)(\"<span>\").addClass(markClass).html(\"&nbsp\" + markText);\n    }\n\n    return $mark;\n  },\n  _getRequiredMarksConfig: function () {\n    if (!this._cashedRequiredConfig) {\n      this._cashedRequiredConfig = {\n        showRequiredMark: this.option(\"showRequiredMark\"),\n        showOptionalMark: this.option(\"showOptionalMark\"),\n        requiredMark: this.option(\"requiredMark\"),\n        optionalMark: this.option(\"optionalMark\")\n      };\n    }\n\n    return this._cashedRequiredConfig;\n  },\n  _renderEditor: function (options) {\n    var dataValue = this._getDataByField(options.dataField);\n\n    var defaultEditorOptions = void 0 !== dataValue || this._isCheckboxUndefinedStateEnabled(options) ? {\n      value: dataValue\n    } : {};\n    var isDeepExtend = true;\n\n    if (EDITORS_WITH_ARRAY_VALUE.indexOf(options.editorType) !== -1) {\n      defaultEditorOptions.value = defaultEditorOptions.value || [];\n    }\n\n    var formInstance = this.option(\"form\");\n    var editorOptions = (0, _extend.extend)(isDeepExtend, defaultEditorOptions, options.editorOptions, {\n      inputAttr: {\n        id: options.id\n      },\n      validationBoundary: options.validationBoundary,\n      stylingMode: formInstance && formInstance.option(\"stylingMode\")\n    });\n\n    this._replaceDataOptions(options.editorOptions, editorOptions);\n\n    var renderOptions = {\n      editorType: options.editorType,\n      dataField: options.dataField,\n      template: options.template,\n      name: options.name,\n      helpID: options.helpID,\n      labelID: options.labelID,\n      isRequired: options.isRequired\n    };\n    return this._createEditor(options.$container, renderOptions, editorOptions);\n  },\n  _replaceDataOptions: function (originalOptions, resultOptions) {\n    if (originalOptions) {\n      DATA_OPTIONS.forEach(function (item) {\n        if (resultOptions[item]) {\n          resultOptions[item] = originalOptions[item];\n        }\n      });\n    }\n  },\n  _renderValidator: function ($editor, item) {\n    var fieldName = this._getFieldLabelName(item);\n\n    var validationRules = this._prepareValidationRules(item.validationRules, item.isRequired, item.itemType, fieldName);\n\n    if (Array.isArray(validationRules) && validationRules.length) {\n      this._createComponent($editor, _validator2.default, {\n        validationRules: validationRules,\n        validationGroup: this.option(\"validationGroup\"),\n        dataGetter: function () {\n          return {\n            formItem: item\n          };\n        }\n      });\n    }\n  },\n  _getFieldLabelName: function (item) {\n    var isItemHaveCustomLabel = item.label && item.label.text;\n    var itemName = isItemHaveCustomLabel ? null : this._getName(item);\n    return isItemHaveCustomLabel ? item.label.text : itemName && _inflector2.default.captionize(itemName);\n  },\n  _prepareValidationRules: function (userValidationRules, isItemRequired, itemType, itemName) {\n    var isSimpleItem = itemType === SIMPLE_ITEM_TYPE;\n    var validationRules;\n\n    if (isSimpleItem) {\n      if (userValidationRules) {\n        validationRules = userValidationRules;\n      } else {\n        var requiredMessage = _string2.default.format(this.option(\"requiredMessage\"), itemName || \"\");\n\n        validationRules = isItemRequired ? [{\n          type: \"required\",\n          message: requiredMessage\n        }] : null;\n      }\n    }\n\n    return validationRules;\n  },\n  _addWrapperInvalidClass: function (editorInstance) {\n    var wrapperClass = \".\" + FIELD_ITEM_CONTENT_WRAPPER_CLASS;\n\n    var toggleInvalidClass = function (e) {\n      (0, _renderer2.default)(e.element).parents(wrapperClass).toggleClass(INVALID_CLASS, e.component._isFocused() && false === e.component.option(\"isValid\"));\n    };\n\n    editorInstance.on(\"focusIn\", toggleInvalidClass).on(\"focusOut\", toggleInvalidClass).on(\"enterKey\", toggleInvalidClass);\n  },\n  _createEditor: function ($container, renderOptions, editorOptions) {\n    var that = this;\n    var template = renderOptions.template;\n    var editorInstance;\n\n    if (renderOptions.dataField && !editorOptions.name) {\n      editorOptions.name = renderOptions.dataField;\n    }\n\n    that._addItemContentClasses($container);\n\n    if (template) {\n      var data = {\n        dataField: renderOptions.dataField,\n        editorType: renderOptions.editorType,\n        editorOptions: editorOptions,\n        component: that._getComponentOwner(),\n        name: renderOptions.name\n      };\n      template.render({\n        model: data,\n        container: _dom2.default.getPublicElement($container)\n      });\n    } else {\n      var $editor = (0, _renderer2.default)(\"<div>\").appendTo($container);\n\n      try {\n        editorInstance = that._createComponent($editor, renderOptions.editorType, editorOptions);\n        editorInstance.setAria(\"describedby\", renderOptions.helpID);\n        editorInstance.setAria(\"labelledby\", renderOptions.labelID);\n        editorInstance.setAria(\"required\", renderOptions.isRequired);\n\n        if (_themes2.default.isMaterial()) {\n          that._addWrapperInvalidClass(editorInstance);\n        }\n\n        if (renderOptions.dataField) {\n          that._bindDataField(editorInstance, renderOptions, $container);\n        }\n      } catch (e) {\n        _ui2.default.log(\"E1035\", e.message);\n      }\n    }\n\n    return editorInstance;\n  },\n  _getComponentOwner: function () {\n    return this.option(\"form\") || this;\n  },\n  _bindDataField: function (editorInstance, renderOptions, $container) {\n    var componentOwner = this._getComponentOwner();\n\n    editorInstance.on(\"enterKey\", function (args) {\n      componentOwner._createActionByOption(\"onEditorEnterKey\")((0, _extend.extend)(args, {\n        dataField: renderOptions.dataField\n      }));\n    });\n\n    this._createWatcher(editorInstance, $container, renderOptions);\n\n    this.linkEditorToDataField(editorInstance, renderOptions.dataField, renderOptions.editorType);\n  },\n  _createWatcher: function (editorInstance, $container, renderOptions) {\n    var that = this;\n\n    var watch = that._getWatch();\n\n    if (!(0, _type.isFunction)(watch)) {\n      return;\n    }\n\n    var dispose = watch(function () {\n      return that._getDataByField(renderOptions.dataField);\n    }, function () {\n      editorInstance.option(\"value\", that._getDataByField(renderOptions.dataField));\n    }, {\n      deep: true,\n      skipImmediate: true\n    });\n\n    _events_engine2.default.on($container, _remove_event2.default, dispose);\n  },\n  _getWatch: function () {\n    if (!(0, _type.isDefined)(this._watch)) {\n      var formInstance = this.option(\"form\");\n      this._watch = formInstance && formInstance.option(\"integrationOptions.watchMethod\");\n    }\n\n    return this._watch;\n  },\n  _addItemContentClasses: function ($itemContent) {\n    var locationSpecificClass = this._getItemContentLocationSpecificClass();\n\n    $itemContent.addClass([FIELD_ITEM_CONTENT_CLASS, locationSpecificClass].join(\" \"));\n  },\n  _getItemContentLocationSpecificClass: function () {\n    var labelLocation = this.option(\"labelLocation\");\n    var oppositeClasses = {\n      right: \"left\",\n      left: \"right\",\n      top: \"bottom\"\n    };\n    return FIELD_ITEM_CONTENT_LOCATION_CLASS + oppositeClasses[labelLocation];\n  },\n  _createComponent: function ($editor, type, editorOptions) {\n    var that = this;\n    var readOnlyState = this.option(\"readOnly\");\n    var instance = that.callBase($editor, type, editorOptions);\n    readOnlyState && instance.option(\"readOnly\", readOnlyState);\n    that.on(\"optionChanged\", function (args) {\n      if (\"readOnly\" === args.name && !(0, _type.isDefined)(editorOptions.readOnly)) {\n        instance.option(args.name, args.value);\n      }\n    });\n    return instance;\n  },\n  _getTemplateByFieldItem: function (fieldItem) {\n    return fieldItem.template ? this._getTemplate(fieldItem.template) : null;\n  },\n  _appendEditorToField: function (params) {\n    if (params.$label) {\n      var location = params.labelOptions.location;\n\n      if (\"top\" === location || \"left\" === location) {\n        params.$fieldItem.append(params.$editor);\n      }\n\n      if (\"right\" === location) {\n        params.$fieldItem.prepend(params.$editor);\n      }\n\n      this._addInnerItemAlignmentClass(params.$fieldItem, location);\n    } else {\n      params.$fieldItem.append(params.$editor);\n    }\n  },\n  _addInnerItemAlignmentClass: function ($fieldItem, location) {\n    if (\"top\" === location) {\n      $fieldItem.addClass(LABEL_VERTICAL_ALIGNMENT_CLASS);\n    } else {\n      $fieldItem.addClass(LABEL_HORIZONTAL_ALIGNMENT_CLASS);\n    }\n  },\n  _renderHelpText: function (fieldItem, $editor, helpID) {\n    var helpText = fieldItem.helpText;\n    var isSimpleItem = fieldItem.itemType === SIMPLE_ITEM_TYPE;\n\n    if (helpText && isSimpleItem) {\n      var $editorWrapper = (0, _renderer2.default)(\"<div>\").addClass(FIELD_ITEM_CONTENT_WRAPPER_CLASS);\n      $editor.wrap($editorWrapper);\n      (0, _renderer2.default)(\"<div>\").addClass(FIELD_ITEM_HELP_TEXT_CLASS).attr(\"id\", helpID).text(helpText).appendTo($editor.parent());\n    }\n  },\n  _attachClickHandler: function ($label, $editor, editorType) {\n    var isBooleanEditors = \"dxCheckBox\" === editorType || \"dxSwitch\" === editorType;\n\n    if ($label && isBooleanEditors) {\n      _events_engine2.default.on($label, _click2.default.name, function () {\n        _events_engine2.default.trigger($editor.children(), _click2.default.name);\n      });\n    }\n  },\n  _generateRatio: function (count, isAutoSize) {\n    var result = [];\n    var ratio;\n    var i;\n\n    for (i = 0; i < count; i++) {\n      ratio = {\n        ratio: 1\n      };\n\n      if (isAutoSize) {\n        ratio.baseSize = \"auto\";\n      }\n\n      result.push(ratio);\n    }\n\n    return result;\n  },\n  _getRowsCount: function () {\n    return Math.ceil(this._items.length / this._getColCount());\n  },\n  _updateReferencedOptions: function (newLayoutData) {\n    var _this2 = this;\n\n    var layoutData = this.option(\"layoutData\");\n\n    if ((0, _type.isObject)(layoutData)) {\n      Object.getOwnPropertyNames(layoutData).forEach(function (property) {\n        return delete _this2._optionsByReference[\"layoutData.\" + property];\n      });\n    }\n\n    if ((0, _type.isObject)(newLayoutData)) {\n      Object.getOwnPropertyNames(newLayoutData).forEach(function (property) {\n        return _this2._optionsByReference[\"layoutData.\" + property] = true;\n      });\n    }\n  },\n  _resetWidget: function (instance) {\n    this._disableEditorValueChangedHandler = true;\n    instance.reset();\n    this._disableEditorValueChangedHandler = false;\n    instance.option(\"isValid\", true);\n  },\n  _optionChanged: function (args) {\n    var _this3 = this;\n\n    if (0 === args.fullName.search(\"layoutData.\")) {\n      return;\n    }\n\n    switch (args.name) {\n      case \"showRequiredMark\":\n      case \"showOptionalMark\":\n      case \"requiredMark\":\n      case \"optionalMark\":\n        this._cashedRequiredConfig = null;\n\n        this._invalidate();\n\n        break;\n\n      case \"layoutData\":\n        this._updateReferencedOptions(args.value);\n\n        if (this.option(\"items\")) {\n          if (!(0, _type.isEmptyObject)(args.value)) {\n            this._itemsRunTimeInfo.each(function (_, itemRunTimeInfo) {\n              if ((0, _type.isDefined)(itemRunTimeInfo.item)) {\n                var dataField = itemRunTimeInfo.item.dataField;\n\n                if (dataField && (0, _type.isDefined)(itemRunTimeInfo.widgetInstance)) {\n                  var valueGetter = _data2.default.compileGetter(dataField);\n\n                  var dataValue = valueGetter(args.value);\n\n                  if (void 0 !== dataValue || _this3._isCheckboxUndefinedStateEnabled(itemRunTimeInfo.item)) {\n                    itemRunTimeInfo.widgetInstance.option(\"value\", dataValue);\n                  } else {\n                    _this3._resetWidget(itemRunTimeInfo.widgetInstance);\n                  }\n                }\n              }\n            });\n          }\n        } else {\n          this._initDataAndItems(args.value);\n\n          this._invalidate();\n        }\n\n        break;\n\n      case \"items\":\n        this._cleanItemWatchers();\n\n        this._initDataAndItems(args.value);\n\n        this._invalidate();\n\n        break;\n\n      case \"alignItemLabels\":\n      case \"labelLocation\":\n      case \"requiredMessage\":\n        this._invalidate();\n\n        break;\n\n      case \"customizeItem\":\n        this._updateItems(this.option(\"layoutData\"));\n\n        this._invalidate();\n\n        break;\n\n      case \"colCount\":\n        this._resetColCount();\n\n        break;\n\n      case \"minColWidth\":\n        if (\"auto\" === this.option(\"colCount\")) {\n          this._resetColCount();\n        }\n\n        break;\n\n      case \"readOnly\":\n        break;\n\n      case \"width\":\n        this.callBase(args);\n\n        if (\"auto\" === this.option(\"colCount\")) {\n          this._resetColCount();\n        }\n\n        break;\n\n      case \"onFieldDataChanged\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _resetColCount: function () {\n    this._cashedColCount = null;\n\n    this._invalidate();\n  },\n  linkEditorToDataField: function (editorInstance, dataField) {\n    var _this4 = this;\n\n    this.on(\"optionChanged\", function (args) {\n      if (args.fullName === \"layoutData.\".concat(dataField)) {\n        editorInstance._setOptionWithoutOptionChange(\"value\", args.value);\n      }\n    });\n    editorInstance.on(\"valueChanged\", function (args) {\n      var isValueReferenceType = (0, _type.isObject)(args.value) || Array.isArray(args.value);\n\n      if (!_this4._disableEditorValueChangedHandler && !(isValueReferenceType && args.value === args.previousValue)) {\n        _this4._updateFieldValue(dataField, args.value);\n      }\n    });\n  },\n  _dimensionChanged: function () {\n    if (\"auto\" === this.option(\"colCount\") && this.isCachedColCountObsolete()) {\n      this._eventsStrategy.fireEvent(\"autoColCountChanged\");\n    }\n  },\n  getItemID: function (name) {\n    var formInstance = this.option(\"form\");\n    return formInstance && formInstance.getItemID(name);\n  },\n  updateData: function (data, value) {\n    var that = this;\n\n    if ((0, _type.isObject)(data)) {\n      (0, _iterator.each)(data, function (dataField, fieldValue) {\n        that._updateFieldValue(dataField, fieldValue);\n      });\n    } else {\n      if (\"string\" === typeof data) {\n        that._updateFieldValue(data, value);\n      }\n    }\n  },\n  getEditor: function (field) {\n    return this._itemsRunTimeInfo.findWidgetInstanceByDataField(field) || this._itemsRunTimeInfo.findWidgetInstanceByName(field);\n  },\n  isSingleColumnMode: function (component) {\n    var responsiveBox = this._responsiveBox || component;\n\n    if (responsiveBox) {\n      return responsiveBox.option(\"currentScreenFactor\") === responsiveBox.option(\"singleColumnScreen\");\n    }\n  },\n  getItemsRunTimeInfo: function () {\n    return this._itemsRunTimeInfo;\n  }\n});\n\n(0, _component_registrator2.default)(\"dxLayoutManager\", LayoutManager);\nmodule.exports = LayoutManager;","map":null,"metadata":{},"sourceType":"script"}