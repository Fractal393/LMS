{"ast":null,"code":"/**\r\n * DevExtreme (core/action.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _renderer = require(\"./renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _config = require(\"./config\");\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _window = require(\"./utils/window\");\n\nvar _type = require(\"./utils/type\");\n\nvar _iterator = require(\"./utils/iterator\");\n\nvar _errors = require(\"./errors\");\n\nvar _errors2 = _interopRequireDefault(_errors);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar Action = function () {\n  function Action(action, config) {\n    _classCallCheck(this, Action);\n\n    config = config || {};\n    this._action = action;\n    this._context = config.context || (0, _window.getWindow)();\n    this._beforeExecute = config.beforeExecute;\n    this._afterExecute = config.afterExecute;\n    this._component = config.component;\n    this._validatingTargetName = config.validatingTargetName;\n    var excludeValidators = this._excludeValidators = {};\n\n    if (config.excludeValidators) {\n      for (var i = 0; i < config.excludeValidators.length; i++) {\n        excludeValidators[config.excludeValidators[i]] = true;\n      }\n    }\n  }\n\n  _createClass(Action, [{\n    key: \"execute\",\n    value: function () {\n      var e = {\n        action: this._action,\n        args: Array.prototype.slice.call(arguments),\n        context: this._context,\n        component: this._component,\n        validatingTargetName: this._validatingTargetName,\n        cancel: false,\n        handled: false\n      };\n      var beforeExecute = this._beforeExecute;\n      var afterExecute = this._afterExecute;\n      var argsBag = e.args[0] || {};\n\n      if (!(\"jQueryEvent\" in argsBag) && argsBag.event && (0, _config2.default)().useJQuery) {\n        Object.defineProperty(argsBag, \"jQueryEvent\", {\n          get: function () {\n            _errors2.default.log(\"W0003\", \"Handler argument\", \"jQueryEvent\", \"17.2\", \"Use the 'event' field instead\");\n\n            return argsBag.event;\n          },\n          set: function (value) {\n            _errors2.default.log(\"W0003\", \"Handler argument\", \"jQueryEvent\", \"17.2\", \"Use the 'event' field instead\");\n\n            argsBag.event = value;\n          }\n        });\n      }\n\n      if (!this._validateAction(e)) {\n        return;\n      }\n\n      null === beforeExecute || void 0 === beforeExecute ? void 0 : beforeExecute.call(this._context, e);\n\n      if (e.cancel) {\n        return;\n      }\n\n      var result = this._executeAction(e);\n\n      if (argsBag.cancel) {\n        return;\n      }\n\n      null === afterExecute || void 0 === afterExecute ? void 0 : afterExecute.call(this._context, e);\n      return result;\n    }\n  }, {\n    key: \"_validateAction\",\n    value: function (e) {\n      var excludeValidators = this._excludeValidators;\n      var executors = Action.executors;\n\n      for (var name in executors) {\n        if (!excludeValidators[name]) {\n          var _executor$validate;\n\n          var executor = executors[name];\n          null === (_executor$validate = executor.validate) || void 0 === _executor$validate ? void 0 : _executor$validate.call(executor, e);\n\n          if (e.cancel) {\n            return false;\n          }\n        }\n      }\n\n      return true;\n    }\n  }, {\n    key: \"_executeAction\",\n    value: function (e) {\n      var result;\n      var executors = Action.executors;\n\n      for (var name in executors) {\n        var _executor$execute;\n\n        var executor = executors[name];\n        null === (_executor$execute = executor.execute) || void 0 === _executor$execute ? void 0 : _executor$execute.call(executor, e);\n\n        if (e.handled) {\n          result = e.result;\n          break;\n        }\n      }\n\n      return result;\n    }\n  }], [{\n    key: \"registerExecutor\",\n    value: function (name, executor) {\n      if ((0, _type.isPlainObject)(name)) {\n        (0, _iterator.each)(name, Action.registerExecutor);\n        return;\n      }\n\n      Action.executors[name] = executor;\n    }\n  }, {\n    key: \"unregisterExecutor\",\n    value: function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      (0, _iterator.each)(args, function () {\n        delete Action.executors[this];\n      });\n    }\n  }]);\n\n  return Action;\n}();\n\nexports.default = Action;\nAction.executors = {};\n\nvar createValidatorByTargetElement = function (condition) {\n  return function (e) {\n    if (!e.args.length) {\n      return;\n    }\n\n    var args = e.args[0];\n    var element = args[e.validatingTargetName] || args.element;\n\n    if (element && condition((0, _renderer2.default)(element))) {\n      e.cancel = true;\n    }\n  };\n};\n\nAction.registerExecutor({\n  disabled: {\n    validate: createValidatorByTargetElement(function ($target) {\n      return $target.is(\".dx-state-disabled, .dx-state-disabled *\");\n    })\n  },\n  readOnly: {\n    validate: createValidatorByTargetElement(function ($target) {\n      return $target.is(\".dx-state-readonly, .dx-state-readonly *\");\n    })\n  },\n  undefined: {\n    execute: function (e) {\n      if (!e.action) {\n        e.result = void 0;\n        e.handled = true;\n      }\n    }\n  },\n  func: {\n    execute: function (e) {\n      if ((0, _type.isFunction)(e.action)) {\n        e.result = e.action.call(e.context, e.args[0]);\n        e.handled = true;\n      }\n    }\n  }\n});","map":null,"metadata":{},"sourceType":"script"}