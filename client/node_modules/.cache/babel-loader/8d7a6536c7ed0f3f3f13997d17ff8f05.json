{"ast":null,"code":"/**\r\n * DevExtreme (events/core/keyboard_processor.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _class = require(\"../../core/class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _utils = require(\"../../events/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar COMPOSITION_START_EVENT = \"compositionstart\";\nvar COMPOSITION_END_EVENT = \"compositionend\";\nvar KEYDOWN_EVENT = \"keydown\";\nvar NAMESPACE = \"KeyboardProcessor\";\n\nvar KeyboardProcessor = _class2.default.inherit({\n  _keydown: (0, _utils.addNamespace)(KEYDOWN_EVENT, NAMESPACE),\n  _compositionStart: (0, _utils.addNamespace)(COMPOSITION_START_EVENT, NAMESPACE),\n  _compositionEnd: (0, _utils.addNamespace)(COMPOSITION_END_EVENT, NAMESPACE),\n  ctor: function (options) {\n    var _this = this;\n\n    options = options || {};\n\n    if (options.element) {\n      this._element = (0, _renderer2.default)(options.element);\n    }\n\n    if (options.focusTarget) {\n      this._focusTarget = options.focusTarget;\n    }\n\n    this._handler = options.handler;\n\n    if (this._element) {\n      this._processFunction = function (e) {\n        var isNotFocusTarget = _this._focusTarget && _this._focusTarget !== e.target && (0, _array.inArray)(e.target, _this._focusTarget) < 0;\n        var shouldSkipProcessing = _this._isComposingJustFinished && 229 === e.which || _this._isComposing || isNotFocusTarget;\n        _this._isComposingJustFinished = false;\n\n        if (!shouldSkipProcessing) {\n          _this.process(e);\n        }\n      };\n\n      this._toggleProcessingWithContext = this.toggleProcessing.bind(this);\n\n      _events_engine2.default.on(this._element, this._keydown, this._processFunction);\n\n      _events_engine2.default.on(this._element, this._compositionStart, this._toggleProcessingWithContext);\n\n      _events_engine2.default.on(this._element, this._compositionEnd, this._toggleProcessingWithContext);\n    }\n  },\n  dispose: function () {\n    if (this._element) {\n      _events_engine2.default.off(this._element, this._keydown, this._processFunction);\n\n      _events_engine2.default.off(this._element, this._compositionStart, this._toggleProcessingWithContext);\n\n      _events_engine2.default.off(this._element, this._compositionEnd, this._toggleProcessingWithContext);\n    }\n\n    this._element = void 0;\n    this._handler = void 0;\n  },\n  process: function (e) {\n    this._handler({\n      keyName: (0, _utils.normalizeKeyName)(e),\n      key: e.key,\n      code: e.code,\n      ctrl: e.ctrlKey,\n      location: e.location,\n      metaKey: e.metaKey,\n      shift: e.shiftKey,\n      alt: e.altKey,\n      which: e.which,\n      originalEvent: e\n    });\n  },\n  toggleProcessing: function (_ref) {\n    var type = _ref.type;\n    this._isComposing = type === COMPOSITION_START_EVENT;\n    this._isComposingJustFinished = !this._isComposing;\n  }\n});\n\nmodule.exports = KeyboardProcessor;","map":null,"metadata":{},"sourceType":"script"}