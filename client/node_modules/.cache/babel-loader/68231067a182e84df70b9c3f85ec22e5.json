{"ast":null,"code":"/**\r\n * DevExtreme (ui/menu/ui.menu.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _utils = require(\"../overlay/utils\");\n\nvar _utils2 = require(\"../../events/utils\");\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _hover = require(\"../../events/hover\");\n\nvar _hover2 = _interopRequireDefault(_hover);\n\nvar _ui = require(\"../context_menu/ui.menu_base\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _overlay = require(\"../overlay\");\n\nvar _overlay2 = _interopRequireDefault(_overlay);\n\nvar _ui3 = require(\"./ui.submenu\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _button = require(\"../button\");\n\nvar _button2 = _interopRequireDefault(_button);\n\nvar _tree_view = require(\"../tree_view\");\n\nvar _tree_view2 = _interopRequireDefault(_tree_view);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (\"undefined\" !== typeof Reflect && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function (target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) {\n        return;\n      }\n\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n\n    if (null === object) {\n      break;\n    }\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var result,\n        Super = _getPrototypeOf(Derived);\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (\"undefined\" === typeof Reflect || !Reflect.construct) {\n    return false;\n  }\n\n  if (Reflect.construct.sham) {\n    return false;\n  }\n\n  if (\"function\" === typeof Proxy) {\n    return true;\n  }\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar DX_MENU_CLASS = \"dx-menu\";\nvar DX_MENU_VERTICAL_CLASS = DX_MENU_CLASS + \"-vertical\";\nvar DX_MENU_HORIZONTAL_CLASS = DX_MENU_CLASS + \"-horizontal\";\nvar DX_MENU_ITEM_CLASS = DX_MENU_CLASS + \"-item\";\nvar DX_MENU_ITEMS_CONTAINER_CLASS = DX_MENU_CLASS + \"-items-container\";\nvar DX_MENU_ITEM_EXPANDED_CLASS = DX_MENU_ITEM_CLASS + \"-expanded\";\nvar DX_CONTEXT_MENU_CLASS = \"dx-context-menu\";\nvar DX_CONTEXT_MENU_CONTAINER_BORDER_CLASS = DX_CONTEXT_MENU_CLASS + \"-container-border\";\nvar DX_CONTEXT_MENU_CONTENT_DELIMITER_CLASS = \"dx-context-menu-content-delimiter\";\nvar DX_SUBMENU_CLASS = \"dx-submenu\";\nvar DX_STATE_DISABLED_CLASS = \"dx-state-disabled\";\nvar DX_STATE_HOVER_CLASS = \"dx-state-hover\";\nvar DX_STATE_ACTIVE_CLASS = \"dx-state-active\";\nvar DX_ADAPTIVE_MODE_CLASS = DX_MENU_CLASS + \"-adaptive-mode\";\nvar DX_ADAPTIVE_HAMBURGER_BUTTON_CLASS = DX_MENU_CLASS + \"-hamburger-button\";\nvar DX_ADAPTIVE_MODE_OVERLAY_WRAPPER_CLASS = DX_ADAPTIVE_MODE_CLASS + \"-overlay-wrapper\";\nvar FOCUS_UP = \"up\";\nvar FOCUS_DOWN = \"down\";\nvar FOCUS_LEFT = \"left\";\nvar FOCUS_RIGHT = \"right\";\nvar SHOW_SUBMENU_OPERATION = \"showSubmenu\";\nvar NEXTITEM_OPERATION = \"nextItem\";\nvar PREVITEM_OPERATION = \"prevItem\";\nvar DEFAULT_DELAY = {\n  show: 50,\n  hide: 300\n};\nvar ACTIONS = [\"onSubmenuShowing\", \"onSubmenuShown\", \"onSubmenuHiding\", \"onSubmenuHidden\", \"onItemContextMenu\", \"onItemClick\", \"onSelectionChanged\"];\n\nvar Menu = function (_MenuBase) {\n  _inherits(Menu, _MenuBase);\n\n  var _super = _createSuper(Menu);\n\n  function Menu() {\n    _classCallCheck(this, Menu);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Menu, [{\n    key: \"_getDefaultOptions\",\n    value: function () {\n      return (0, _extend.extend)(_get(_getPrototypeOf(Menu.prototype), \"_getDefaultOptions\", this).call(this), {\n        orientation: \"horizontal\",\n        submenuDirection: \"auto\",\n        showFirstSubmenuMode: {\n          name: \"onClick\",\n          delay: {\n            show: 50,\n            hide: 300\n          }\n        },\n        hideSubmenuOnMouseLeave: false,\n        onSubmenuShowing: null,\n        onSubmenuShown: null,\n        onSubmenuHiding: null,\n        onSubmenuHidden: null,\n        adaptivityEnabled: false\n      });\n    }\n  }, {\n    key: \"_setOptionsByReference\",\n    value: function () {\n      _get(_getPrototypeOf(Menu.prototype), \"_setOptionsByReference\", this).call(this);\n\n      (0, _extend.extend)(this._optionsByReference, {\n        animation: true,\n        selectedItem: true\n      });\n    }\n  }, {\n    key: \"_itemElements\",\n    value: function () {\n      var rootMenuElements = _get(_getPrototypeOf(Menu.prototype), \"_itemElements\", this).call(this);\n\n      var submenuElements = this._submenuItemElements();\n\n      return rootMenuElements.add(submenuElements);\n    }\n  }, {\n    key: \"_submenuItemElements\",\n    value: function () {\n      var elements = [];\n      var itemSelector = \".\".concat(DX_MENU_ITEM_CLASS);\n      var currentSubmenu = this._submenus.length && this._submenus[0];\n\n      if (currentSubmenu && currentSubmenu.itemsContainer()) {\n        elements = currentSubmenu.itemsContainer().find(itemSelector);\n      }\n\n      return elements;\n    }\n  }, {\n    key: \"_focusTarget\",\n    value: function () {\n      return this.$element();\n    }\n  }, {\n    key: \"_isMenuHorizontal\",\n    value: function () {\n      return \"horizontal\" === this.option(\"orientation\");\n    }\n  }, {\n    key: \"_moveFocus\",\n    value: function (location) {\n      var $items = this._getAvailableItems();\n\n      var isMenuHorizontal = this._isMenuHorizontal();\n\n      var $activeItem = this._getActiveItem(true);\n\n      var argument;\n      var operation;\n      var navigationAction;\n      var $newTarget;\n\n      switch (location) {\n        case FOCUS_UP:\n          operation = isMenuHorizontal ? SHOW_SUBMENU_OPERATION : this._getItemsNavigationOperation(PREVITEM_OPERATION);\n          argument = isMenuHorizontal ? $activeItem : $items;\n          navigationAction = this._getKeyboardNavigationAction(operation, argument);\n          $newTarget = navigationAction();\n          break;\n\n        case FOCUS_DOWN:\n          operation = isMenuHorizontal ? SHOW_SUBMENU_OPERATION : this._getItemsNavigationOperation(NEXTITEM_OPERATION);\n          argument = isMenuHorizontal ? $activeItem : $items;\n          navigationAction = this._getKeyboardNavigationAction(operation, argument);\n          $newTarget = navigationAction();\n          break;\n\n        case FOCUS_RIGHT:\n          operation = isMenuHorizontal ? this._getItemsNavigationOperation(NEXTITEM_OPERATION) : SHOW_SUBMENU_OPERATION;\n          argument = isMenuHorizontal ? $items : $activeItem;\n          navigationAction = this._getKeyboardNavigationAction(operation, argument);\n          $newTarget = navigationAction();\n          break;\n\n        case FOCUS_LEFT:\n          operation = isMenuHorizontal ? this._getItemsNavigationOperation(PREVITEM_OPERATION) : SHOW_SUBMENU_OPERATION;\n          argument = isMenuHorizontal ? $items : $activeItem;\n          navigationAction = this._getKeyboardNavigationAction(operation, argument);\n          $newTarget = navigationAction();\n          break;\n\n        default:\n          return _get(_getPrototypeOf(Menu.prototype), \"_moveFocus\", this).call(this, location);\n      }\n\n      if ($newTarget && 0 !== $newTarget.length) {\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($newTarget));\n      }\n    }\n  }, {\n    key: \"_getItemsNavigationOperation\",\n    value: function (operation) {\n      var navOperation = operation;\n\n      if (this.option(\"rtlEnabled\")) {\n        navOperation = operation === PREVITEM_OPERATION ? NEXTITEM_OPERATION : PREVITEM_OPERATION;\n      }\n\n      return navOperation;\n    }\n  }, {\n    key: \"_getKeyboardNavigationAction\",\n    value: function (operation, argument) {\n      var action = _common.noop;\n\n      switch (operation) {\n        case SHOW_SUBMENU_OPERATION:\n          if (!argument.hasClass(DX_STATE_DISABLED_CLASS)) {\n            action = this._showSubmenu.bind(this, argument);\n          }\n\n          break;\n\n        case NEXTITEM_OPERATION:\n          action = this._nextItem.bind(this, argument);\n          break;\n\n        case PREVITEM_OPERATION:\n          action = this._prevItem.bind(this, argument);\n      }\n\n      return action;\n    }\n  }, {\n    key: \"_clean\",\n    value: function () {\n      _get(_getPrototypeOf(Menu.prototype), \"_clean\", this).call(this);\n\n      this.option(\"templatesRenderAsynchronously\") && clearTimeout(this._resizeEventTimer);\n    }\n  }, {\n    key: \"_visibilityChanged\",\n    value: function (visible) {\n      if (visible) {\n        if (!this._menuItemsWidth) {\n          this._updateItemsWidthCache();\n        }\n\n        this._dimensionChanged();\n      }\n    }\n  }, {\n    key: \"_isAdaptivityEnabled\",\n    value: function () {\n      return this.option(\"adaptivityEnabled\") && \"horizontal\" === this.option(\"orientation\");\n    }\n  }, {\n    key: \"_updateItemsWidthCache\",\n    value: function () {\n      var $menuItems = this.$element().find(\"ul\").first().children(\"li\").children(\".\".concat(DX_MENU_ITEM_CLASS));\n      this._menuItemsWidth = this._getSummaryItemsWidth($menuItems, true);\n    }\n  }, {\n    key: \"_dimensionChanged\",\n    value: function () {\n      if (!this._isAdaptivityEnabled()) {\n        return;\n      }\n\n      var containerWidth = this.$element().outerWidth();\n\n      this._toggleAdaptiveMode(this._menuItemsWidth > containerWidth);\n    }\n  }, {\n    key: \"_init\",\n    value: function () {\n      _get(_getPrototypeOf(Menu.prototype), \"_init\", this).call(this);\n\n      this._submenus = [];\n    }\n  }, {\n    key: \"_initActions\",\n    value: function () {\n      var _this = this;\n\n      this._actions = {};\n      (0, _iterator.each)(ACTIONS, function (index, action) {\n        _this._actions[action] = _this._createActionByOption(action);\n      });\n    }\n  }, {\n    key: \"_initMarkup\",\n    value: function () {\n      this._visibleSubmenu = null;\n      this.$element().addClass(DX_MENU_CLASS);\n\n      _get(_getPrototypeOf(Menu.prototype), \"_initMarkup\", this).call(this);\n\n      this.setAria(\"role\", \"menubar\");\n    }\n  }, {\n    key: \"_render\",\n    value: function () {\n      _get(_getPrototypeOf(Menu.prototype), \"_render\", this).call(this);\n\n      this._initAdaptivity();\n    }\n  }, {\n    key: \"_renderHamburgerButton\",\n    value: function () {\n      this._hamburger = new _button2.default((0, _renderer2.default)(\"<div>\").addClass(DX_ADAPTIVE_HAMBURGER_BUTTON_CLASS), {\n        icon: \"menu\",\n        activeStateEnabled: false,\n        onClick: this._toggleTreeView.bind(this)\n      });\n      return this._hamburger.$element();\n    }\n  }, {\n    key: \"_toggleTreeView\",\n    value: function (state) {\n      if ((0, _type.isPlainObject)(state)) {\n        state = !this._overlay.option(\"visible\");\n      }\n\n      this._overlay.option(\"visible\", state);\n\n      this._toggleHamburgerActiveState(state);\n    }\n  }, {\n    key: \"_toggleHamburgerActiveState\",\n    value: function (state) {\n      this._hamburger && this._hamburger.$element().toggleClass(DX_STATE_ACTIVE_CLASS, state);\n    }\n  }, {\n    key: \"_toggleAdaptiveMode\",\n    value: function (state) {\n      var $menuItemsContainer = this.$element().find(\".\".concat(DX_MENU_HORIZONTAL_CLASS));\n      var $adaptiveElements = this.$element().find(\".\".concat(DX_ADAPTIVE_MODE_CLASS));\n\n      if (state) {\n        this._hideVisibleSubmenu();\n      } else {\n        this._treeView && this._treeView.collapseAll();\n        this._overlay && this._toggleTreeView(state);\n      }\n\n      $menuItemsContainer.toggle(!state);\n      $adaptiveElements.toggle(state);\n    }\n  }, {\n    key: \"_removeAdaptivity\",\n    value: function () {\n      if (!this._$adaptiveContainer) {\n        return;\n      }\n\n      this._toggleAdaptiveMode(false);\n\n      this._$adaptiveContainer.remove();\n\n      this._$adaptiveContainer = null;\n      this._treeView = null;\n      this._hamburger = null;\n      this._overlay = null;\n    }\n  }, {\n    key: \"_treeviewItemClickHandler\",\n    value: function (e) {\n      this._actions.onItemClick(e);\n\n      if (!e.node.children.length) {\n        this._toggleTreeView(false);\n      }\n    }\n  }, {\n    key: \"_getAdaptiveOverlayOptions\",\n    value: function () {\n      var _this2 = this;\n\n      var rtl = this.option(\"rtlEnabled\");\n      var position = rtl ? \"right\" : \"left\";\n      return {\n        maxHeight: function () {\n          return (0, _utils.getElementMaxHeightByWindow)(_this2.$element());\n        },\n        deferRendering: false,\n        shading: false,\n        animation: false,\n        closeOnTargetScroll: true,\n        onHidden: function () {\n          _this2._toggleHamburgerActiveState(false);\n        },\n        height: \"auto\",\n        closeOnOutsideClick: function (e) {\n          return !(0, _renderer2.default)(e.target).closest(\".\".concat(DX_ADAPTIVE_HAMBURGER_BUTTON_CLASS)).length;\n        },\n        position: {\n          collision: \"flipfit\",\n          at: \"bottom \" + position,\n          my: \"top \" + position,\n          of: this._hamburger.$element()\n        }\n      };\n    }\n  }, {\n    key: \"_getTreeViewOptions\",\n    value: function () {\n      var _this3 = this;\n\n      var menuOptions = {};\n      var optionsToTransfer = [\"rtlEnabled\", \"width\", \"accessKey\", \"activeStateEnabled\", \"animation\", \"dataSource\", \"disabled\", \"displayExpr\", \"displayExpr\", \"focusStateEnabled\", \"hint\", \"hoverStateEnabled\", \"itemsExpr\", \"items\", \"itemTemplate\", \"selectedExpr\", \"selectionMode\", \"tabIndex\", \"visible\"];\n      var actionsToTransfer = [\"onItemContextMenu\", \"onSelectionChanged\"];\n      (0, _iterator.each)(optionsToTransfer, function (_, option) {\n        menuOptions[option] = _this3.option(option);\n      });\n      (0, _iterator.each)(actionsToTransfer, function (_, actionName) {\n        menuOptions[actionName] = function (e) {\n          _this3._actions[actionName](e);\n        };\n      });\n      return (0, _extend.extend)(menuOptions, {\n        dataSource: this.getDataSource(),\n        animationEnabled: !!this.option(\"animation\"),\n        onItemClick: this._treeviewItemClickHandler.bind(this),\n        onItemExpanded: function (e) {\n          _this3._overlay.repaint();\n\n          _this3._actions.onSubmenuShown(e);\n        },\n        onItemCollapsed: function (e) {\n          _this3._overlay.repaint();\n\n          _this3._actions.onSubmenuHidden(e);\n        },\n        selectNodesRecursive: false,\n        selectByClick: this.option(\"selectByClick\"),\n        expandEvent: \"click\"\n      });\n    }\n  }, {\n    key: \"_initAdaptivity\",\n    value: function () {\n      if (!this._isAdaptivityEnabled()) {\n        return;\n      }\n\n      this._$adaptiveContainer = (0, _renderer2.default)(\"<div>\").addClass(DX_ADAPTIVE_MODE_CLASS);\n\n      var $hamburger = this._renderHamburgerButton();\n\n      this._treeView = this._createComponent((0, _renderer2.default)(\"<div>\"), _tree_view2.default, this._getTreeViewOptions());\n      this._overlay = this._createComponent((0, _renderer2.default)(\"<div>\"), _overlay2.default, this._getAdaptiveOverlayOptions());\n\n      this._overlay.$content().append(this._treeView.$element()).addClass(DX_ADAPTIVE_MODE_CLASS).addClass(this.option(\"cssClass\"));\n\n      this._overlay._wrapper().addClass(DX_ADAPTIVE_MODE_OVERLAY_WRAPPER_CLASS);\n\n      this._$adaptiveContainer.append($hamburger);\n\n      this._$adaptiveContainer.append(this._overlay.$element());\n\n      this.$element().append(this._$adaptiveContainer);\n\n      this._updateItemsWidthCache();\n\n      this._dimensionChanged();\n    }\n  }, {\n    key: \"_getDelay\",\n    value: function (delayType) {\n      var delay = this.option(\"showFirstSubmenuMode\").delay;\n\n      if (!(0, _type.isDefined)(delay)) {\n        return DEFAULT_DELAY[delayType];\n      } else {\n        return (0, _type.isObject)(delay) ? delay[delayType] : delay;\n      }\n    }\n  }, {\n    key: \"_keyboardHandler\",\n    value: function (e) {\n      return _get(_getPrototypeOf(Menu.prototype), \"_keyboardHandler\", this).call(this, e, !!this._visibleSubmenu);\n    }\n  }, {\n    key: \"_renderContainer\",\n    value: function () {\n      var $wrapper = (0, _renderer2.default)(\"<div>\");\n      $wrapper.appendTo(this.$element()).addClass(this._isMenuHorizontal() ? DX_MENU_HORIZONTAL_CLASS : DX_MENU_VERTICAL_CLASS);\n      return _get(_getPrototypeOf(Menu.prototype), \"_renderContainer\", this).call(this, $wrapper);\n    }\n  }, {\n    key: \"_renderSubmenuItems\",\n    value: function (node, $itemFrame) {\n      var submenu = this._createSubmenu(node, $itemFrame);\n\n      this._submenus.push(submenu);\n\n      this._renderBorderElement($itemFrame);\n\n      return submenu;\n    }\n  }, {\n    key: \"_getKeyboardListeners\",\n    value: function () {\n      return _get(_getPrototypeOf(Menu.prototype), \"_getKeyboardListeners\", this).call(this).concat(this._submenus);\n    }\n  }, {\n    key: \"_createSubmenu\",\n    value: function (node, $rootItem) {\n      var $submenuContainer = (0, _renderer2.default)(\"<div>\").addClass(DX_CONTEXT_MENU_CLASS).appendTo($rootItem);\n\n      var items = this._getChildNodes(node);\n\n      var result = this._createComponent($submenuContainer, _ui4.default, (0, _extend.extend)(this._getSubmenuOptions(), {\n        _dataAdapter: this._dataAdapter,\n        _parentKey: node.internalFields.key,\n        items: items,\n        onHoverStart: this._clearTimeouts.bind(this),\n        position: this.getSubmenuPosition($rootItem)\n      }));\n\n      this._attachSubmenuHandlers($rootItem, result);\n\n      return result;\n    }\n  }, {\n    key: \"_getSubmenuOptions\",\n    value: function () {\n      var _this4 = this;\n\n      var $submenuTarget = (0, _renderer2.default)(\"<div>\");\n\n      var isMenuHorizontal = this._isMenuHorizontal();\n\n      return {\n        itemTemplate: this.option(\"itemTemplate\"),\n        target: $submenuTarget,\n        orientation: this.option(\"orientation\"),\n        selectionMode: this.option(\"selectionMode\"),\n        cssClass: this.option(\"cssClass\"),\n        selectByClick: this.option(\"selectByClick\"),\n        hoverStateEnabled: this.option(\"hoverStateEnabled\"),\n        activeStateEnabled: this.option(\"activeStateEnabled\"),\n        focusStateEnabled: this.option(\"focusStateEnabled\"),\n        animation: this.option(\"animation\"),\n        showSubmenuMode: this.option(\"showSubmenuMode\"),\n        displayExpr: this.option(\"displayExpr\"),\n        disabledExpr: this.option(\"disabledExpr\"),\n        selectedExpr: this.option(\"selectedExpr\"),\n        itemsExpr: this.option(\"itemsExpr\"),\n        onFocusedItemChanged: function (e) {\n          if (!e.component.option(\"visible\")) {\n            return;\n          }\n\n          _this4.option(\"focusedElement\", e.component.option(\"focusedElement\"));\n        },\n        onSelectionChanged: this._nestedItemOnSelectionChangedHandler.bind(this),\n        onItemClick: this._nestedItemOnItemClickHandler.bind(this),\n        onItemRendered: this.option(\"onItemRendered\"),\n        onLeftFirstItem: isMenuHorizontal ? null : this._moveMainMenuFocus.bind(this, PREVITEM_OPERATION),\n        onLeftLastItem: isMenuHorizontal ? null : this._moveMainMenuFocus.bind(this, NEXTITEM_OPERATION),\n        onCloseRootSubmenu: this._moveMainMenuFocus.bind(this, isMenuHorizontal ? PREVITEM_OPERATION : null),\n        onExpandLastSubmenu: isMenuHorizontal ? this._moveMainMenuFocus.bind(this, NEXTITEM_OPERATION) : null\n      };\n    }\n  }, {\n    key: \"_getShowFirstSubmenuMode\",\n    value: function () {\n      if (!this._isDesktopDevice()) {\n        return \"onClick\";\n      }\n\n      var optionValue = this.option(\"showFirstSubmenuMode\");\n      return (0, _type.isObject)(optionValue) ? optionValue.name : optionValue;\n    }\n  }, {\n    key: \"_moveMainMenuFocus\",\n    value: function (direction) {\n      var $items = this._getAvailableItems();\n\n      var itemCount = $items.length;\n      var $currentItem = $items.filter(\".\".concat(DX_MENU_ITEM_EXPANDED_CLASS)).eq(0);\n      var itemIndex = $items.index($currentItem);\n\n      this._hideSubmenu(this._visibleSubmenu);\n\n      itemIndex += direction === PREVITEM_OPERATION ? -1 : 1;\n\n      if (itemIndex >= itemCount) {\n        itemIndex = 0;\n      } else {\n        if (itemIndex < 0) {\n          itemIndex = itemCount - 1;\n        }\n      }\n\n      var $newItem = $items.eq(itemIndex);\n      this.option(\"focusedElement\", (0, _dom.getPublicElement)($newItem));\n    }\n  }, {\n    key: \"_nestedItemOnSelectionChangedHandler\",\n    value: function (args) {\n      var selectedItem = args.addedItems.length && args.addedItems[0];\n\n      var submenu = _ui4.default.getInstance(args.element);\n\n      var onSelectionChanged = this._actions.onSelectionChanged;\n      onSelectionChanged(args);\n      selectedItem && this._clearSelectionInSubmenus(selectedItem[0], submenu);\n\n      this._clearRootSelection();\n\n      this._setOptionWithoutOptionChange(\"selectedItem\", selectedItem);\n    }\n  }, {\n    key: \"_clearSelectionInSubmenus\",\n    value: function (item, targetSubmenu) {\n      var _this5 = this;\n\n      var cleanAllSubmenus = !arguments.length;\n      (0, _iterator.each)(this._submenus, function (index, submenu) {\n        var $submenu = submenu._itemContainer();\n\n        var isOtherItem = !$submenu.is(targetSubmenu && targetSubmenu._itemContainer());\n        var $selectedItem = $submenu.find(\".\".concat(_this5._selectedItemClass()));\n\n        if (isOtherItem && $selectedItem.length || cleanAllSubmenus) {\n          $selectedItem.removeClass(_this5._selectedItemClass());\n\n          var selectedItemData = _this5._getItemData($selectedItem);\n\n          if (selectedItemData) {\n            selectedItemData.selected = false;\n          }\n\n          submenu._clearSelectedItems();\n        }\n      });\n    }\n  }, {\n    key: \"_clearRootSelection\",\n    value: function () {\n      var $prevSelectedItem = this.$element().find(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS)).first().children().children().filter(\".\".concat(this._selectedItemClass()));\n\n      if ($prevSelectedItem.length) {\n        var prevSelectedItemData = this._getItemData($prevSelectedItem);\n\n        prevSelectedItemData.selected = false;\n        $prevSelectedItem.removeClass(this._selectedItemClass());\n      }\n    }\n  }, {\n    key: \"_nestedItemOnItemClickHandler\",\n    value: function (e) {\n      this._actions.onItemClick(e);\n    }\n  }, {\n    key: \"_attachSubmenuHandlers\",\n    value: function ($rootItem, submenu) {\n      var _this6 = this;\n\n      var $submenuOverlayContent = submenu.getOverlayContent();\n      var submenus = $submenuOverlayContent.find(\".\".concat(DX_SUBMENU_CLASS));\n      var submenuMouseLeaveName = (0, _utils2.addNamespace)(_hover2.default.end, this.NAME + \"_submenu\");\n      submenu.option({\n        onShowing: this._submenuOnShowingHandler.bind(this, $rootItem, submenu),\n        onShown: this._submenuOnShownHandler.bind(this, $rootItem, submenu),\n        onHiding: this._submenuOnHidingHandler.bind(this, $rootItem, submenu),\n        onHidden: this._submenuOnHiddenHandler.bind(this, $rootItem, submenu)\n      });\n      (0, _iterator.each)(submenus, function (index, submenu) {\n        _events_engine2.default.off(submenu, submenuMouseLeaveName);\n\n        _events_engine2.default.on(submenu, submenuMouseLeaveName, null, _this6._submenuMouseLeaveHandler.bind(_this6, $rootItem));\n      });\n    }\n  }, {\n    key: \"_submenuOnShowingHandler\",\n    value: function ($rootItem, submenu) {\n      var $border = $rootItem.children(\".\".concat(DX_CONTEXT_MENU_CONTAINER_BORDER_CLASS));\n\n      this._actions.onSubmenuShowing({\n        rootItem: (0, _dom.getPublicElement)($rootItem),\n        submenu: submenu\n      });\n\n      $border.show();\n      $rootItem.addClass(DX_MENU_ITEM_EXPANDED_CLASS);\n    }\n  }, {\n    key: \"_submenuOnShownHandler\",\n    value: function ($rootItem, submenu) {\n      this._actions.onSubmenuShown({\n        rootItem: (0, _dom.getPublicElement)($rootItem),\n        submenu: submenu\n      });\n    }\n  }, {\n    key: \"_submenuOnHidingHandler\",\n    value: function ($rootItem, submenu, eventArgs) {\n      var $border = $rootItem.children(\".\".concat(DX_CONTEXT_MENU_CONTAINER_BORDER_CLASS));\n      var args = eventArgs;\n      args.rootItem = (0, _dom.getPublicElement)($rootItem);\n      args.submenu = submenu;\n\n      this._actions.onSubmenuHiding(args);\n\n      eventArgs = args;\n\n      if (!eventArgs.cancel) {\n        if (this._visibleSubmenu === submenu) {\n          this._visibleSubmenu = null;\n        }\n\n        $border.hide();\n        $rootItem.removeClass(DX_MENU_ITEM_EXPANDED_CLASS);\n      }\n    }\n  }, {\n    key: \"_submenuOnHiddenHandler\",\n    value: function ($rootItem, submenu) {\n      this._actions.onSubmenuHidden({\n        rootItem: (0, _dom.getPublicElement)($rootItem),\n        submenu: submenu\n      });\n    }\n  }, {\n    key: \"_submenuMouseLeaveHandler\",\n    value: function ($rootItem, eventArgs) {\n      var target = (0, _renderer2.default)(eventArgs.relatedTarget).parents(\".\".concat(DX_CONTEXT_MENU_CLASS))[0];\n\n      var contextMenu = this._getSubmenuByRootElement($rootItem).getOverlayContent()[0];\n\n      if (this.option(\"hideSubmenuOnMouseLeave\") && target !== contextMenu) {\n        this._clearTimeouts();\n\n        setTimeout(this._hideSubmenuAfterTimeout.bind(this), this._getDelay(\"hide\"));\n      }\n    }\n  }, {\n    key: \"_hideSubmenuAfterTimeout\",\n    value: function () {\n      if (!this._visibleSubmenu) {\n        return;\n      }\n\n      var isRootItemHovered = (0, _renderer2.default)(this._visibleSubmenu.$element().context).hasClass(DX_STATE_HOVER_CLASS);\n\n      var isSubmenuItemHovered = this._visibleSubmenu.getOverlayContent().find(\".\".concat(DX_STATE_HOVER_CLASS)).length;\n\n      var hoveredElementFromSubMenu = this._visibleSubmenu.getOverlayContent().get(0).querySelector(\":hover\");\n\n      if (!hoveredElementFromSubMenu && !isSubmenuItemHovered && !isRootItemHovered) {\n        this._visibleSubmenu.hide();\n      }\n    }\n  }, {\n    key: \"_getSubmenuByRootElement\",\n    value: function ($rootItem) {\n      if (!$rootItem) {\n        return false;\n      }\n\n      var $submenu = $rootItem.children(\".\".concat(DX_CONTEXT_MENU_CLASS));\n      return $submenu.length && _ui4.default.getInstance($submenu);\n    }\n  }, {\n    key: \"getSubmenuPosition\",\n    value: function ($rootItem) {\n      var isHorizontalMenu = this._isMenuHorizontal();\n\n      var submenuDirection = this.option(\"submenuDirection\").toLowerCase();\n      var rtlEnabled = this.option(\"rtlEnabled\");\n      var submenuPosition = {\n        collision: \"flip\",\n        of: $rootItem\n      };\n\n      switch (submenuDirection) {\n        case \"leftortop\":\n          submenuPosition.at = \"left top\";\n          submenuPosition.my = isHorizontalMenu ? \"left bottom\" : \"right top\";\n          break;\n\n        case \"rightorbottom\":\n          submenuPosition.at = isHorizontalMenu ? \"left bottom\" : \"right top\";\n          submenuPosition.my = \"left top\";\n          break;\n\n        default:\n          if (isHorizontalMenu) {\n            submenuPosition.at = rtlEnabled ? \"right bottom\" : \"left bottom\";\n            submenuPosition.my = rtlEnabled ? \"right top\" : \"left top\";\n          } else {\n            submenuPosition.at = rtlEnabled ? \"left top\" : \"right top\";\n            submenuPosition.my = rtlEnabled ? \"right top\" : \"left top\";\n          }\n\n      }\n\n      return submenuPosition;\n    }\n  }, {\n    key: \"_renderBorderElement\",\n    value: function ($item) {\n      (0, _renderer2.default)(\"<div>\").appendTo($item).addClass(DX_CONTEXT_MENU_CONTAINER_BORDER_CLASS).hide();\n    }\n  }, {\n    key: \"_itemPointerDownHandler\",\n    value: function (e) {\n      var $target = (0, _renderer2.default)(e.target);\n      var $closestItem = $target.closest(this._itemElements());\n\n      if ($closestItem.hasClass(\"dx-menu-item-has-submenu\")) {\n        this.option(\"focusedElement\", null);\n        return;\n      }\n\n      _get(_getPrototypeOf(Menu.prototype), \"_itemPointerDownHandler\", this).call(this, e);\n    }\n  }, {\n    key: \"_hoverStartHandler\",\n    value: function (e) {\n      var mouseMoveEventName = (0, _utils2.addNamespace)(_pointer2.default.move, this.NAME);\n\n      var $item = this._getItemElementByEventArgs(e);\n\n      var node = this._dataAdapter.getNodeByItem(this._getItemData($item));\n\n      var isSelectionActive = (0, _type.isDefined)(e.buttons) && 1 === e.buttons || !(0, _type.isDefined)(e.buttons) && 1 === e.which;\n\n      if (this._isItemDisabled($item)) {\n        return;\n      }\n\n      _events_engine2.default.off($item, mouseMoveEventName);\n\n      if (!this._hasChildren(node)) {\n        this._showSubmenuTimer = setTimeout(this._hideSubmenuAfterTimeout.bind(this), this._getDelay(\"hide\"));\n        return;\n      }\n\n      if (\"onHover\" === this._getShowFirstSubmenuMode() && !isSelectionActive) {\n        var submenu = this._getSubmenuByElement($item);\n\n        this._clearTimeouts();\n\n        if (!submenu.isOverlayVisible()) {\n          _events_engine2.default.on($item, mouseMoveEventName, this._itemMouseMoveHandler.bind(this));\n\n          this._showSubmenuTimer = this._getDelay(\"hide\");\n        }\n      }\n    }\n  }, {\n    key: \"_hoverEndHandler\",\n    value: function (eventArg) {\n      var _this7 = this;\n\n      var $item = this._getItemElementByEventArgs(eventArg);\n\n      var relatedTarget = (0, _renderer2.default)(eventArg.relatedTarget);\n\n      _get(_getPrototypeOf(Menu.prototype), \"_hoverEndHandler\", this).call(this, eventArg);\n\n      this._clearTimeouts();\n\n      if (this._isItemDisabled($item)) {\n        return;\n      }\n\n      if (relatedTarget.hasClass(DX_CONTEXT_MENU_CONTENT_DELIMITER_CLASS)) {\n        return;\n      }\n\n      if (this.option(\"hideSubmenuOnMouseLeave\") && !relatedTarget.hasClass(DX_MENU_ITEMS_CONTAINER_CLASS)) {\n        this._hideSubmenuTimer = setTimeout(function () {\n          _this7._hideSubmenuAfterTimeout();\n        }, this._getDelay(\"hide\"));\n      }\n    }\n  }, {\n    key: \"_hideVisibleSubmenu\",\n    value: function () {\n      if (!this._visibleSubmenu) {\n        return false;\n      }\n\n      this._hideSubmenu(this._visibleSubmenu);\n\n      return true;\n    }\n  }, {\n    key: \"_showSubmenu\",\n    value: function ($itemElement) {\n      var submenu = this._getSubmenuByElement($itemElement);\n\n      if (this._visibleSubmenu !== submenu) {\n        this._hideVisibleSubmenu();\n      }\n\n      if (submenu) {\n        submenu.show();\n        this.option(\"focusedElement\", submenu.option(\"focusedElement\"));\n      }\n\n      this._visibleSubmenu = submenu;\n      this._hoveredRootItem = $itemElement;\n    }\n  }, {\n    key: \"_hideSubmenu\",\n    value: function (submenu) {\n      submenu && submenu.hide();\n\n      if (this._visibleSubmenu === submenu) {\n        this._visibleSubmenu = null;\n      }\n\n      this._hoveredRootItem = null;\n    }\n  }, {\n    key: \"_itemMouseMoveHandler\",\n    value: function (e) {\n      var _this8 = this;\n\n      if (e.pointers && e.pointers.length) {\n        return;\n      }\n\n      var $item = (0, _renderer2.default)(e.currentTarget);\n\n      if (!(0, _type.isDefined)(this._showSubmenuTimer)) {\n        return;\n      }\n\n      this._clearTimeouts();\n\n      this._showSubmenuTimer = setTimeout(function () {\n        var submenu = _this8._getSubmenuByElement($item);\n\n        if (submenu && !submenu.isOverlayVisible()) {\n          _this8._showSubmenu($item);\n        }\n      }, this._getDelay(\"show\"));\n    }\n  }, {\n    key: \"_clearTimeouts\",\n    value: function () {\n      clearTimeout(this._hideSubmenuTimer);\n      clearTimeout(this._showSubmenuTimer);\n    }\n  }, {\n    key: \"_getSubmenuByElement\",\n    value: function ($itemElement, itemData) {\n      var submenu = this._getSubmenuByRootElement($itemElement);\n\n      if (submenu) {\n        return submenu;\n      } else {\n        itemData = itemData || this._getItemData($itemElement);\n\n        var node = this._dataAdapter.getNodeByItem(itemData);\n\n        return this._hasChildren(node) && this._renderSubmenuItems(node, $itemElement);\n      }\n    }\n  }, {\n    key: \"_updateSubmenuVisibilityOnClick\",\n    value: function (actionArgs) {\n      var args = actionArgs.args.length && actionArgs.args[0];\n\n      if (!args || this._disabledGetter(args.itemData)) {\n        return;\n      }\n\n      var $itemElement = (0, _renderer2.default)(args.itemElement);\n\n      var currentSubmenu = this._getSubmenuByElement($itemElement, args.itemData);\n\n      this._updateSelectedItemOnClick(actionArgs);\n\n      if (this._visibleSubmenu) {\n        if (this._visibleSubmenu === currentSubmenu) {\n          if (\"onClick\" === this.option(\"showFirstSubmenuMode\")) {\n            this._hideSubmenu(this._visibleSubmenu);\n          }\n\n          return;\n        } else {\n          this._hideSubmenu(this._visibleSubmenu);\n        }\n      }\n\n      if (!currentSubmenu) {\n        return;\n      }\n\n      if (!currentSubmenu.isOverlayVisible()) {\n        this._showSubmenu($itemElement);\n\n        return;\n      }\n    }\n  }, {\n    key: \"_optionChanged\",\n    value: function (args) {\n      switch (args.name) {\n        case \"orientation\":\n        case \"submenuDirection\":\n          this._invalidate();\n\n          break;\n\n        case \"showFirstSubmenuMode\":\n        case \"hideSubmenuOnMouseLeave\":\n          break;\n\n        case \"showSubmenuMode\":\n          this._changeSubmenusOption(args.name, args.value);\n\n          break;\n\n        case \"onSubmenuShowing\":\n        case \"onSubmenuShown\":\n        case \"onSubmenuHiding\":\n        case \"onSubmenuHidden\":\n          this._initActions();\n\n          break;\n\n        case \"adaptivityEnabled\":\n          args.value ? this._initAdaptivity() : this._removeAdaptivity();\n          break;\n\n        case \"width\":\n          if (this._isAdaptivityEnabled()) {\n            this._treeView.option(args.name, args.value);\n\n            this._overlay.option(args.name, args.value);\n          }\n\n          _get(_getPrototypeOf(Menu.prototype), \"_optionChanged\", this).call(this, args);\n\n          this._dimensionChanged();\n\n          break;\n\n        case \"animation\":\n          if (this._isAdaptivityEnabled()) {\n            this._treeView.option(\"animationEnabled\", !!args.value);\n          }\n\n          _get(_getPrototypeOf(Menu.prototype), \"_optionChanged\", this).call(this, args);\n\n          break;\n\n        default:\n          if (this._isAdaptivityEnabled()) {\n            this._treeView.option(args.name, args.value);\n          }\n\n          _get(_getPrototypeOf(Menu.prototype), \"_optionChanged\", this).call(this, args);\n\n      }\n    }\n  }, {\n    key: \"_changeSubmenusOption\",\n    value: function (name, value) {\n      (0, _iterator.each)(this._submenus, function (index, submenu) {\n        submenu.option(name, value);\n      });\n    }\n  }, {\n    key: \"selectItem\",\n    value: function (itemElement) {\n      this._hideSubmenu(this._visibleSubmenu);\n\n      _get(_getPrototypeOf(Menu.prototype), \"selectItem\", this).call(this, itemElement);\n    }\n  }, {\n    key: \"unselectItem\",\n    value: function (itemElement) {\n      this._hideSubmenu(this._visibleSubmenu);\n\n      _get(_getPrototypeOf(Menu.prototype), \"selectItem\", this).call(this, itemElement);\n    }\n  }]);\n\n  return Menu;\n}(_ui2.default);\n\n(0, _component_registrator2.default)(\"dxMenu\", Menu);\nmodule.exports = Menu;","map":null,"metadata":{},"sourceType":"script"}