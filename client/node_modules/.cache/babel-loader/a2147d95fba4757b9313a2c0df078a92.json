{"ast":null,"code":"/**\r\n * DevExtreme (ui/toolbar/ui.toolbar.strategy.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar noop = require(\"../../core/utils/common\").noop;\n\nvar each = require(\"../../core/utils/iterator\").each;\n\nvar errors = require(\"../../core/errors\");\n\nvar compileGetter = require(\"../../core/utils/data\").compileGetter;\n\nvar Class = require(\"../../core/class\");\n\nvar Button = require(\"../button\");\n\nvar abstract = Class.abstract;\nvar TOOLBAR_MENU_CONTAINER_CLASS = \"dx-toolbar-menu-container\";\nvar TOOLBAR_MENU_BUTTON_CLASS = \"dx-toolbar-menu-button\";\nvar ToolbarStrategy = Class.inherit({\n  ctor: function (toolbar) {\n    this._toolbar = toolbar;\n  },\n  render: function () {\n    this._renderMenuButton();\n\n    this._renderWidget();\n  },\n  _widgetOptions: function () {\n    var itemClickAction = this._toolbar._createActionByOption(\"onItemClick\");\n\n    return {\n      itemTemplate: this._getMenuItemTemplate.bind(this),\n      onItemClick: function (e) {\n        this._toggleMenu(false, true);\n\n        itemClickAction(e);\n      }.bind(this)\n    };\n  },\n  _getMenuItemTemplate: function () {\n    return this._toolbar._getTemplateByOption(\"menuItemTemplate\");\n  },\n  _renderWidget: function () {\n    var $menu = $(\"<div>\").appendTo(this._menuContainer());\n    this._menu = this._toolbar._createComponent($menu, this._menuWidgetClass(), this._widgetOptions());\n    this.renderMenuItems();\n  },\n  _menuContainer: abstract,\n  _menuWidgetClass: abstract,\n  _hasVisibleMenuItems: function (items) {\n    var menuItems = items || this._toolbar.option(\"items\");\n\n    var result = false;\n    var optionGetter = compileGetter(\"visible\");\n    var overflowGetter = compileGetter(\"locateInMenu\");\n    var menuLocation = false;\n    each(menuItems, function (index, item) {\n      var itemVisible = optionGetter(item, {\n        functionsAsIs: true\n      });\n      var itemOverflow = overflowGetter(item, {\n        functionsAsIs: true\n      });\n\n      if (\"menu\" === item.location) {\n        menuLocation = true;\n      }\n\n      if (false !== itemVisible && (\"auto\" === itemOverflow || \"always\" === itemOverflow || \"menu\" === item.location)) {\n        result = true;\n      }\n    });\n\n    if (menuLocation) {\n      errors.log(\"W0001\", \"dxToolbar - 'location' item field\", \"menu\", \"16.1\", \"Use 'locateInMenu' item field instead.\");\n    }\n\n    return result;\n  },\n  _getMenuItems: function () {\n    return this._toolbar._getMenuItems();\n  },\n  _updateMenuVisibility: noop,\n  _renderMenuButton: function () {\n    var buttonOptions = this._menuButtonOptions();\n\n    this._renderMenuButtonContainer();\n\n    this._$button = $(\"<div>\").appendTo(this._$menuButtonContainer).addClass(TOOLBAR_MENU_BUTTON_CLASS);\n\n    this._toolbar._createComponent(this._$button, Button, buttonOptions);\n  },\n  _menuButtonOptions: function () {\n    return {\n      onClick: this._menuButtonClickHandler.bind(this)\n    };\n  },\n  _menuButtonClickHandler: function () {\n    this._toggleMenu(!this._menuShown, true);\n  },\n  _renderMenuButtonContainer: function () {\n    var $afterSection = this._toolbar._$afterSection;\n    this._$menuButtonContainer = $(\"<div>\").appendTo($afterSection).addClass(this._toolbar._buttonClass()).addClass(TOOLBAR_MENU_CONTAINER_CLASS);\n  },\n  renderMenuItems: function () {\n    this._menu && this._menu.option(\"items\", this._getMenuItems());\n  },\n  toggleMenuVisibility: function (visible, animate) {\n    this._menu && this._toggleMenu(visible, animate);\n  },\n  _toggleMenu: function (visible) {\n    this._menuShown = visible;\n  },\n  getMenuWidget: function () {\n    return this._menu;\n  },\n  widgetOption: function (name, value) {\n    this._menu && this._menu.option(name, value);\n  },\n  handleToolbarVisibilityChange: noop\n});\nmodule.exports = ToolbarStrategy;","map":null,"metadata":{},"sourceType":"script"}