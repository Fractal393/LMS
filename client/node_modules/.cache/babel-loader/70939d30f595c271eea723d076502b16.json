{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.grid_view.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _position = require(\"../../core/utils/position\");\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _browser = require(\"../../core/utils/browser\");\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _accessibility = require(\"../shared/accessibility\");\n\nvar _accessibility2 = _interopRequireDefault(_accessibility);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TABLE_CLASS = \"table\";\nvar BORDERS_CLASS = \"borders\";\nvar TABLE_FIXED_CLASS = \"table-fixed\";\nvar IMPORTANT_MARGIN_CLASS = \"important-margin\";\nvar TEXT_CONTENT_CLASS = \"text-content\";\nvar HIDDEN_CLASS = \"dx-hidden\";\nvar GRIDBASE_CONTAINER_CLASS = \"dx-gridbase-container\";\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\nvar EDITORS_INPUT_SELECTOR = \"input:not([type='hidden'])\";\nvar VIEW_NAMES = [\"columnsSeparatorView\", \"blockSeparatorView\", \"trackerView\", \"headerPanel\", \"columnHeadersView\", \"rowsView\", \"footerView\", \"columnChooserView\", \"filterPanelView\", \"pagerView\", \"draggingHeaderView\", \"contextMenuView\", \"errorView\", \"headerFilterView\", \"filterBuilderView\"];\n\nvar isPercentWidth = function (width) {\n  return _type2.default.isString(width) && \"%\" === width.slice(-1);\n};\n\nvar isPixelWidth = function (width) {\n  return _type2.default.isString(width) && \"px\" === width.slice(-2);\n};\n\nvar mergeArraysByMaxValue = function (values1, values2) {\n  var result = [];\n\n  if (values1 && values2 && values1.length && values1.length === values2.length) {\n    for (var i = 0; i < values1.length; i++) {\n      result.push(values1[i] > values2[i] ? values1[i] : values2[i]);\n    }\n  } else {\n    if (values1 && values1.length) {\n      result = values1;\n    } else {\n      if (values2) {\n        result = values2;\n      }\n    }\n  }\n\n  return result;\n};\n\nvar getContainerHeight = function ($container) {\n  var clientHeight = $container.get(0).clientHeight;\n  var paddingTop = parseFloat($container.css(\"paddingTop\"));\n  var paddingBottom = parseFloat($container.css(\"paddingBottom\"));\n  return clientHeight - paddingTop - paddingBottom;\n};\n\nvar calculateFreeWidth = function (that, widths) {\n  var contentWidth = that._rowsView.contentWidth();\n\n  var totalWidth = that._getTotalWidth(widths, contentWidth);\n\n  return contentWidth - totalWidth;\n};\n\nvar calculateFreeWidthWithCurrentMinWidth = function (that, columnIndex, currentMinWidth, widths) {\n  return calculateFreeWidth(that, widths.map(function (width, index) {\n    return index === columnIndex ? currentMinWidth : width;\n  }));\n};\n\nvar restoreFocus = function (focusedElement, selectionRange) {\n  _accessibility2.default.hiddenFocus(focusedElement);\n\n  _uiGrid_core4.default.setSelectionRange(focusedElement, selectionRange);\n};\n\nvar ResizingController = _uiGrid_core2.default.ViewController.inherit({\n  _initPostRenderHandlers: function () {\n    var that = this;\n    var dataController = that._dataController;\n\n    if (!that._refreshSizesHandler) {\n      that._refreshSizesHandler = function (e) {\n        dataController.changed.remove(that._refreshSizesHandler);\n        var resizeDeferred;\n        var changeType = e && e.changeType;\n        var isDelayed = e && e.isDelayed;\n        var items = dataController.items();\n\n        if (!e || \"refresh\" === changeType || \"prepend\" === changeType || \"append\" === changeType) {\n          if (!isDelayed) {\n            resizeDeferred = that.resize();\n          }\n        } else {\n          if (\"update\" === changeType && e.changeTypes) {\n            if ((items.length > 1 || \"insert\" !== e.changeTypes[0]) && !(0 === items.length && \"remove\" === e.changeTypes[0]) && !e.needUpdateDimensions) {\n              _common2.default.deferUpdate(function () {\n                that._rowsView.resize();\n              });\n            } else {\n              resizeDeferred = that.resize();\n            }\n          }\n        }\n\n        if (changeType && \"updateSelection\" !== changeType && \"updateFocusedRow\" !== changeType && !isDelayed) {\n          (0, _deferred.when)(resizeDeferred).done(function () {\n            that._setAriaRowColCount();\n\n            that.fireContentReadyAction();\n          });\n        }\n      };\n\n      that._dataController.changed.add(function () {\n        that._dataController.changed.add(that._refreshSizesHandler);\n      });\n    }\n  },\n  fireContentReadyAction: function () {\n    this.component._fireContentReadyAction();\n  },\n  _setAriaRowColCount: function () {\n    var component = this.component;\n    component.setAria({\n      rowCount: this._dataController.totalItemsCount(),\n      colCount: component.columnCount()\n    }, component.$element().children(\".\" + GRIDBASE_CONTAINER_CLASS));\n  },\n  _getBestFitWidths: function () {\n    if (!this.option(\"legacyRendering\")) {\n      return this._rowsView.getColumnWidths();\n    }\n\n    var rowsColumnWidths = this._rowsView.getColumnWidths();\n\n    var headerColumnWidths = this._columnHeadersView && this._columnHeadersView.getColumnWidths();\n\n    var footerColumnWidths = this._footerView && this._footerView.getColumnWidths();\n\n    var resultWidths = mergeArraysByMaxValue(rowsColumnWidths, headerColumnWidths);\n    resultWidths = mergeArraysByMaxValue(resultWidths, footerColumnWidths);\n    return resultWidths;\n  },\n  _setVisibleWidths: function (visibleColumns, widths) {\n    var columnsController = this._columnsController;\n    columnsController.beginUpdate();\n    (0, _iterator.each)(visibleColumns, function (index, column) {\n      var columnId = columnsController.getColumnId(column);\n      columnsController.columnOption(columnId, \"visibleWidth\", widths[index]);\n    });\n    columnsController.endUpdate();\n  },\n  _toggleBestFitModeForView: function (view, className, isBestFit) {\n    var _this = this;\n\n    if (!view || !view.isVisible()) {\n      return;\n    }\n\n    var $rowsTables = this._rowsView.getTableElements();\n\n    var $viewTables = view.getTableElements();\n    (0, _iterator.each)($rowsTables, function (index, tableElement) {\n      var $tableBody;\n      var $rowsTable = (0, _renderer2.default)(tableElement);\n      var $viewTable = $viewTables.eq(index);\n\n      if ($viewTable && $viewTable.length) {\n        if (isBestFit) {\n          $tableBody = $viewTable.children(\"tbody\").appendTo($rowsTable);\n        } else {\n          $tableBody = $rowsTable.children(\".\" + className).appendTo($viewTable);\n        }\n\n        $tableBody.toggleClass(className, isBestFit);\n        $tableBody.toggleClass(_this.addWidgetPrefix(\"best-fit\"), isBestFit);\n      }\n    });\n  },\n  _toggleBestFitMode: function (isBestFit) {\n    var $element = this.component.$element();\n    var that = this;\n\n    if (!that.option(\"legacyRendering\")) {\n      var $rowsTable = that._rowsView._getTableElement();\n\n      var $rowsFixedTable = that._rowsView.getTableElements().eq(1);\n\n      if (!$rowsTable) {\n        return;\n      }\n\n      $rowsTable.css(\"tableLayout\", isBestFit ? \"auto\" : \"fixed\");\n      $rowsTable.children(\"colgroup\").css(\"display\", isBestFit ? \"none\" : \"\");\n      $rowsFixedTable.toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\n\n      that._toggleBestFitModeForView(that._columnHeadersView, \"dx-header\", isBestFit);\n\n      that._toggleBestFitModeForView(that._footerView, \"dx-footer\", isBestFit);\n\n      if (that._needStretch()) {\n        $rowsTable.get(0).style.width = isBestFit ? \"auto\" : \"\";\n      }\n\n      if (_browser2.default.msie && 11 === parseInt(_browser2.default.version)) {\n        $rowsTable.find(\".\" + this.addWidgetPrefix(TABLE_FIXED_CLASS)).each(function () {\n          this.style.width = isBestFit ? \"10px\" : \"\";\n        });\n      }\n    } else {\n      $element.find(\".\" + this.addWidgetPrefix(TABLE_CLASS)).toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\n      $element.find(EDITORS_INPUT_SELECTOR).toggleClass(HIDDEN_CLASS, isBestFit);\n      $element.find(\".dx-group-cell\").toggleClass(HIDDEN_CLASS, isBestFit);\n      $element.find(\".dx-header-row .\" + this.addWidgetPrefix(TEXT_CONTENT_CLASS)).css(\"maxWidth\", \"\");\n    }\n  },\n  _synchronizeColumns: function () {\n    var that = this;\n    var columnsController = that._columnsController;\n    var visibleColumns = columnsController.getVisibleColumns();\n    var columnAutoWidth = that.option(\"columnAutoWidth\");\n    var legacyRendering = that.option(\"legacyRendering\");\n\n    var needBestFit = that._needBestFit();\n\n    var hasMinWidth = false;\n    var resetBestFitMode;\n    var isColumnWidthsCorrected = false;\n    var resultWidths = [];\n    var focusedElement;\n    var selectionRange;\n\n    var normalizeWidthsByExpandColumns = function () {\n      var expandColumnWidth;\n      (0, _iterator.each)(visibleColumns, function (index, column) {\n        if (\"groupExpand\" === column.type) {\n          expandColumnWidth = resultWidths[index];\n        }\n      });\n      (0, _iterator.each)(visibleColumns, function (index, column) {\n        if (\"groupExpand\" === column.type && expandColumnWidth) {\n          resultWidths[index] = expandColumnWidth;\n        }\n      });\n    };\n\n    !needBestFit && (0, _iterator.each)(visibleColumns, function (index, column) {\n      if (\"auto\" === column.width || legacyRendering && column.fixed) {\n        needBestFit = true;\n        return false;\n      }\n    });\n    (0, _iterator.each)(visibleColumns, function (index, column) {\n      if (column.minWidth) {\n        hasMinWidth = true;\n        return false;\n      }\n    });\n\n    that._setVisibleWidths(visibleColumns, []);\n\n    if (needBestFit) {\n      focusedElement = _dom_adapter2.default.getActiveElement();\n      selectionRange = _uiGrid_core4.default.getSelectionRange(focusedElement);\n\n      that._toggleBestFitMode(true);\n\n      resetBestFitMode = true;\n    }\n\n    _common2.default.deferUpdate(function () {\n      if (needBestFit) {\n        resultWidths = that._getBestFitWidths();\n        (0, _iterator.each)(visibleColumns, function (index, column) {\n          var columnId = columnsController.getColumnId(column);\n          columnsController.columnOption(columnId, \"bestFitWidth\", resultWidths[index], true);\n        });\n      } else {\n        if (hasMinWidth) {\n          resultWidths = that._getBestFitWidths();\n        }\n      }\n\n      (0, _iterator.each)(visibleColumns, function (index) {\n        var width = this.width;\n\n        if (\"auto\" !== width) {\n          if (_type2.default.isDefined(width)) {\n            resultWidths[index] = _type2.default.isNumeric(width) || isPixelWidth(width) ? parseFloat(width) : width;\n          } else {\n            if (!columnAutoWidth) {\n              resultWidths[index] = void 0;\n            }\n          }\n        }\n      });\n\n      if (resetBestFitMode) {\n        that._toggleBestFitMode(false);\n\n        resetBestFitMode = false;\n\n        if (focusedElement && focusedElement !== _dom_adapter2.default.getActiveElement()) {\n          var isFocusOutsideWindow = (0, _position.getBoundingRect)(focusedElement).bottom < 0;\n\n          if (!isFocusOutsideWindow) {\n            if (_browser2.default.msie) {\n              setTimeout(function () {\n                restoreFocus(focusedElement, selectionRange);\n              });\n            } else {\n              restoreFocus(focusedElement, selectionRange);\n            }\n          }\n        }\n      }\n\n      isColumnWidthsCorrected = that._correctColumnWidths(resultWidths, visibleColumns);\n\n      if (columnAutoWidth) {\n        normalizeWidthsByExpandColumns();\n\n        if (that._needStretch()) {\n          that._processStretch(resultWidths, visibleColumns);\n        }\n      }\n\n      _common2.default.deferRender(function () {\n        if (needBestFit || isColumnWidthsCorrected) {\n          that._setVisibleWidths(visibleColumns, resultWidths);\n        }\n      });\n    });\n  },\n  _needBestFit: function () {\n    return this.option(\"columnAutoWidth\");\n  },\n  _needStretch: function () {\n    return this.option(\"legacyRendering\") || this._columnsController.getVisibleColumns().some(function (c) {\n      return \"auto\" === c.width && !c.command;\n    });\n  },\n  _getAverageColumnsWidth: function (resultWidths) {\n    var freeWidth = calculateFreeWidth(this, resultWidths);\n    var columnCountWithoutWidth = resultWidths.filter(function (width) {\n      return void 0 === width;\n    }).length;\n    return freeWidth / columnCountWithoutWidth;\n  },\n  _correctColumnWidths: function (resultWidths, visibleColumns) {\n    var that = this;\n    var i;\n    var hasPercentWidth = false;\n    var hasAutoWidth = false;\n    var isColumnWidthsCorrected = false;\n    var $element = that.component.$element();\n    var hasWidth = that._hasWidth;\n\n    for (i = 0; i < visibleColumns.length; i++) {\n      var index = i;\n      var column = visibleColumns[index];\n      var isHiddenColumn = resultWidths[index] === HIDDEN_COLUMNS_WIDTH;\n      var width = resultWidths[index];\n      var minWidth = column.minWidth;\n\n      if (minWidth) {\n        if (void 0 === width) {\n          var averageColumnsWidth = that._getAverageColumnsWidth(resultWidths);\n\n          width = averageColumnsWidth;\n        } else {\n          if (isPercentWidth(width)) {\n            var freeWidth = calculateFreeWidthWithCurrentMinWidth(that, index, minWidth, resultWidths);\n\n            if (freeWidth < 0) {\n              width = -1;\n            }\n          }\n        }\n      }\n\n      if (minWidth && that._getRealColumnWidth(width) < minWidth && !isHiddenColumn) {\n        resultWidths[index] = minWidth;\n        isColumnWidthsCorrected = true;\n        i = -1;\n      }\n\n      if (!_type2.default.isDefined(column.width)) {\n        hasAutoWidth = true;\n      }\n\n      if (isPercentWidth(column.width)) {\n        hasPercentWidth = true;\n      }\n    }\n\n    if ($element && that._maxWidth) {\n      delete that._maxWidth;\n      $element.css(\"maxWidth\", \"\");\n    }\n\n    if (!hasAutoWidth && resultWidths.length) {\n      var contentWidth = that._rowsView.contentWidth();\n\n      var scrollbarWidth = that._rowsView.getScrollbarWidth();\n\n      var totalWidth = that._getTotalWidth(resultWidths, contentWidth);\n\n      if (totalWidth < contentWidth) {\n        var lastColumnIndex = _uiGrid_core4.default.getLastResizableColumnIndex(visibleColumns, resultWidths);\n\n        if (lastColumnIndex >= 0) {\n          resultWidths[lastColumnIndex] = \"auto\";\n          isColumnWidthsCorrected = true;\n\n          if (false === hasWidth && !hasPercentWidth) {\n            that._maxWidth = totalWidth + scrollbarWidth + (that.option(\"showBorders\") ? 2 : 0);\n            $element.css(\"maxWidth\", that._maxWidth);\n          }\n        }\n      }\n    }\n\n    return isColumnWidthsCorrected;\n  },\n  _processStretch: function (resultSizes, visibleColumns) {\n    var groupSize = this._rowsView.contentWidth();\n\n    var tableSize = this._getTotalWidth(resultSizes, groupSize);\n\n    var unusedIndexes = {\n      length: 0\n    };\n\n    if (!resultSizes.length) {\n      return;\n    }\n\n    (0, _iterator.each)(visibleColumns, function (index) {\n      if (this.width || resultSizes[index] === HIDDEN_COLUMNS_WIDTH) {\n        unusedIndexes[index] = true;\n        unusedIndexes.length++;\n      }\n    });\n    var diff = groupSize - tableSize;\n    var diffElement = Math.floor(diff / (resultSizes.length - unusedIndexes.length));\n    var onePixelElementsCount = diff - diffElement * (resultSizes.length - unusedIndexes.length);\n\n    if (diff >= 0) {\n      for (var i = 0; i < resultSizes.length; i++) {\n        if (unusedIndexes[i]) {\n          continue;\n        }\n\n        resultSizes[i] += diffElement;\n\n        if (onePixelElementsCount > 0) {\n          if (onePixelElementsCount < 1) {\n            resultSizes[i] += onePixelElementsCount;\n            onePixelElementsCount = 0;\n          } else {\n            resultSizes[i]++;\n            onePixelElementsCount--;\n          }\n        }\n      }\n    }\n  },\n  _getRealColumnWidth: function (width, groupWidth) {\n    if (!isPercentWidth(width)) {\n      return parseFloat(width);\n    }\n\n    groupWidth = groupWidth || this._rowsView.contentWidth();\n    return parseFloat(width) * groupWidth / 100;\n  },\n  _getTotalWidth: function (widths, groupWidth) {\n    var result = 0;\n\n    for (var i = 0; i < widths.length; i++) {\n      var width = widths[i];\n\n      if (width && width !== HIDDEN_COLUMNS_WIDTH) {\n        result += this._getRealColumnWidth(width, groupWidth);\n      }\n    }\n\n    return result;\n  },\n  updateSize: function ($rootElement) {\n    var that = this;\n    var $groupElement;\n    var width;\n    var importantMarginClass = that.addWidgetPrefix(IMPORTANT_MARGIN_CLASS);\n\n    if (void 0 === that._hasHeight && $rootElement && $rootElement.is(\":visible\") && $rootElement.width()) {\n      $groupElement = $rootElement.children(\".\" + that.getWidgetContainerClass());\n\n      if ($groupElement.length) {\n        $groupElement.detach();\n      }\n\n      that._hasHeight = !!getContainerHeight($rootElement);\n      width = $rootElement.width();\n      $rootElement.addClass(importantMarginClass);\n      that._hasWidth = $rootElement.width() === width;\n      $rootElement.removeClass(importantMarginClass);\n\n      if ($groupElement.length) {\n        $groupElement.appendTo($rootElement);\n      }\n    }\n  },\n  publicMethods: function () {\n    return [\"resize\", \"updateDimensions\"];\n  },\n  resize: function () {\n    return !this.component._requireResize && this.updateDimensions();\n  },\n  updateDimensions: function (checkSize) {\n    var that = this;\n\n    that._initPostRenderHandlers();\n\n    if (!that._checkSize(checkSize)) {\n      return;\n    }\n\n    var prevResult = that._resizeDeferred;\n    var result = that._resizeDeferred = new _deferred.Deferred();\n    (0, _deferred.when)(prevResult).always(function () {\n      _common2.default.deferRender(function () {\n        if (that._dataController.isLoaded()) {\n          that._synchronizeColumns();\n        }\n\n        that._resetGroupElementHeight();\n\n        _common2.default.deferUpdate(function () {\n          _common2.default.deferRender(function () {\n            _common2.default.deferUpdate(function () {\n              that._updateDimensionsCore();\n            });\n          });\n        });\n      }).done(result.resolve).fail(result.reject);\n    });\n    return result.promise();\n  },\n  _resetGroupElementHeight: function () {\n    var groupElement = this.component.$element().children().get(0);\n\n    var scrollable = this._rowsView.getScrollable();\n\n    if (groupElement && groupElement.style.height && (!scrollable || !scrollable.scrollTop())) {\n      groupElement.style.height = \"\";\n    }\n  },\n  _checkSize: function (checkSize) {\n    var $rootElement = this.component.$element();\n\n    if (checkSize && (this._lastWidth === $rootElement.width() && this._lastHeight === $rootElement.height() || !$rootElement.is(\":visible\"))) {\n      return false;\n    }\n\n    return true;\n  },\n  _setScrollerSpacingCore: function (hasHeight) {\n    var that = this;\n    var vScrollbarWidth = hasHeight ? that._rowsView.getScrollbarWidth() : 0;\n\n    var hScrollbarWidth = that._rowsView.getScrollbarWidth(true);\n\n    _common2.default.deferRender(function () {\n      that._columnHeadersView && that._columnHeadersView.setScrollerSpacing(vScrollbarWidth);\n      that._footerView && that._footerView.setScrollerSpacing(vScrollbarWidth);\n\n      that._rowsView.setScrollerSpacing(vScrollbarWidth, hScrollbarWidth);\n    });\n  },\n  _setScrollerSpacing: function (hasHeight) {\n    var _this2 = this;\n\n    if (true === this.option(\"scrolling.useNative\")) {\n      _common2.default.deferRender(function () {\n        _common2.default.deferUpdate(function () {\n          _this2._setScrollerSpacingCore(hasHeight);\n        });\n      });\n    } else {\n      this._setScrollerSpacingCore(hasHeight);\n    }\n  },\n  _updateDimensionsCore: function () {\n    var that = this;\n    var dataController = that._dataController;\n    var rowsView = that._rowsView;\n    var $rootElement = that.component.$element();\n    var groupElement = $rootElement.children().get(0);\n    var rootElementHeight = $rootElement && ($rootElement.get(0).clientHeight || $rootElement.height());\n    var maxHeight = parseInt($rootElement.css(\"maxHeight\"));\n    var maxHeightHappened = maxHeight && rootElementHeight >= maxHeight;\n    var height = that.option(\"height\") || $rootElement.get(0).style.height;\n    var editorFactory = that.getController(\"editorFactory\");\n    var isMaxHeightApplied = maxHeightHappened && groupElement.scrollHeight === groupElement.offsetHeight;\n    var $testDiv;\n    that.updateSize($rootElement);\n    var hasHeight = that._hasHeight || maxHeightHappened;\n\n    if (height && that._hasHeight ^ \"auto\" !== height) {\n      $testDiv = (0, _renderer2.default)(\"<div>\").height(height).appendTo($rootElement);\n      that._hasHeight = !!$testDiv.height();\n      $testDiv.remove();\n    }\n\n    _common2.default.deferRender(function () {\n      rowsView.height(null, hasHeight);\n\n      if (maxHeightHappened && !isMaxHeightApplied) {\n        (0, _renderer2.default)(groupElement).css(\"height\", maxHeight);\n      }\n\n      if (!dataController.isLoaded()) {\n        rowsView.setLoading(dataController.isLoading());\n        return;\n      }\n\n      _common2.default.deferUpdate(function () {\n        that._updateLastSizes($rootElement);\n\n        that._setScrollerSpacing(hasHeight);\n\n        (0, _iterator.each)(VIEW_NAMES, function (index, viewName) {\n          var view = that.getView(viewName);\n\n          if (view) {\n            view.resize();\n          }\n        });\n        editorFactory && editorFactory.resize();\n      });\n    });\n  },\n  _updateLastSizes: function ($rootElement) {\n    this._lastWidth = $rootElement.width();\n    this._lastHeight = $rootElement.height();\n  },\n  optionChanged: function (args) {\n    switch (args.name) {\n      case \"width\":\n      case \"height\":\n        this.component._renderDimensions();\n\n        this.resize();\n\n      case \"legacyRendering\":\n      case \"renderAsync\":\n        args.handled = true;\n        return;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  init: function () {\n    var that = this;\n    that._dataController = that.getController(\"data\");\n    that._columnsController = that.getController(\"columns\");\n    that._columnHeadersView = that.getView(\"columnHeadersView\");\n    that._footerView = that.getView(\"footerView\");\n    that._rowsView = that.getView(\"rowsView\");\n  }\n});\n\nvar SynchronizeScrollingController = _uiGrid_core2.default.ViewController.inherit({\n  _scrollChangedHandler: function (views, pos, viewName) {\n    for (var j = 0; j < views.length; j++) {\n      if (views[j] && views[j].name !== viewName) {\n        views[j].scrollTo({\n          left: pos.left,\n          top: pos.top\n        });\n      }\n    }\n  },\n  init: function () {\n    var views = [this.getView(\"columnHeadersView\"), this.getView(\"footerView\"), this.getView(\"rowsView\")];\n\n    for (var i = 0; i < views.length; i++) {\n      var view = views[i];\n\n      if (view) {\n        view.scrollChanged.add(this._scrollChangedHandler.bind(this, views));\n      }\n    }\n  }\n});\n\nvar GridView = _uiGrid_core2.default.View.inherit({\n  _endUpdateCore: function () {\n    if (this.component._requireResize) {\n      this.component._requireResize = false;\n\n      this._resizingController.resize();\n    }\n  },\n  _getWidgetAriaLabel: function () {\n    return \"dxDataGrid-ariaDataGrid\";\n  },\n  init: function () {\n    var that = this;\n    that._resizingController = that.getController(\"resizing\");\n    that._dataController = that.getController(\"data\");\n  },\n  getView: function (name) {\n    return this.component._views[name];\n  },\n  element: function () {\n    return this._groupElement;\n  },\n  optionChanged: function (args) {\n    var that = this;\n\n    if (_type2.default.isDefined(that._groupElement) && \"showBorders\" === args.name) {\n      that._groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!args.value);\n\n      args.handled = true;\n    } else {\n      that.callBase(args);\n    }\n  },\n  _renderViews: function ($groupElement) {\n    var that = this;\n    (0, _iterator.each)(VIEW_NAMES, function (index, viewName) {\n      var view = that.getView(viewName);\n\n      if (view) {\n        view.render($groupElement);\n      }\n    });\n  },\n  _getTableRoleName: function () {\n    return \"grid\";\n  },\n  render: function ($rootElement) {\n    var that = this;\n    var isFirstRender = !that._groupElement;\n    var $groupElement = that._groupElement || (0, _renderer2.default)(\"<div>\").addClass(that.getWidgetContainerClass());\n    $groupElement.addClass(GRIDBASE_CONTAINER_CLASS);\n    $groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!that.option(\"showBorders\"));\n    that.setAria(\"role\", \"presentation\", $rootElement);\n    that.component.setAria({\n      role: this._getTableRoleName(),\n      label: _message2.default.format(that._getWidgetAriaLabel())\n    }, $groupElement);\n    that._rootElement = $rootElement || that._rootElement;\n\n    if (isFirstRender) {\n      that._groupElement = $groupElement;\n      _window2.default.hasWindow() && that.getController(\"resizing\").updateSize($rootElement);\n      $groupElement.appendTo($rootElement);\n    }\n\n    that._renderViews($groupElement);\n  },\n  update: function () {\n    var that = this;\n    var $rootElement = that._rootElement;\n    var $groupElement = that._groupElement;\n    var resizingController = that.getController(\"resizing\");\n\n    if ($rootElement && $groupElement) {\n      resizingController.resize();\n\n      if (that._dataController.isLoaded()) {\n        that._resizingController.fireContentReadyAction();\n      }\n    }\n  }\n});\n\nmodule.exports = {\n  defaultOptions: function () {\n    return {\n      showBorders: false,\n      renderAsync: false,\n      legacyRendering: false\n    };\n  },\n  controllers: {\n    resizing: ResizingController,\n    synchronizeScrolling: SynchronizeScrollingController\n  },\n  views: {\n    gridView: GridView\n  }\n};","map":null,"metadata":{},"sourceType":"script"}