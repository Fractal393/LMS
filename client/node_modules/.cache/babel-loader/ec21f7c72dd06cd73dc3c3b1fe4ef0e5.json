{"ast":null,"code":"import { TreeView as BaseTreeView } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined as isNOU, select, setValue, getValue, Draggable } from '@syncfusion/ej2-base';\nimport { KeyboardEvents, closest } from '@syncfusion/ej2-base';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport * as events from '../base/constant';\nimport * as CLS from '../base/classes';\nimport { read, Download, GetDetails, Delete } from '../common/operations';\nimport { createDialog } from '../pop-up/dialog';\nimport { updatePath, getPath, getDirectories } from '../common/utility';\nimport { createVirtualDragElement, dragStopHandler, dragStartHandler, draggingHandler, getDirectoryPath, getModule } from '../common/index';\nimport { copyFiles, cutFiles, removeActive, pasteHandler, getParentPath, readDropPath } from '../common/index';\nimport { hasEditAccess, createDeniedDialog, hasDownloadAccess, getAccessClass } from '../common/index';\n/**\n * NavigationPane module\n */\n\nvar NavigationPane =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the TreeView module\n   * @hidden\n   */\n  function NavigationPane(parent) {\n    this.removeNodes = [];\n    this.moveNames = [];\n    this.expandTree = false;\n    this.isDrag = false;\n    this.isPathDragged = false;\n    this.isRenameParent = false;\n    this.isRightClick = false;\n    this.renameParent = null;\n    this.parent = parent;\n    this.addEventListener();\n    this.keyConfigs = {\n      altEnter: 'alt+enter',\n      esc: 'escape',\n      del: 'delete',\n      ctrlX: 'ctrl+x',\n      ctrlC: 'ctrl+c',\n      ctrlV: 'ctrl+v',\n      ctrlShiftN: 'ctrl+shift+n',\n      shiftF10: 'shift+F10',\n      f2: 'f2'\n    };\n  }\n\n  NavigationPane.prototype.onInit = function () {\n    if (!isNOU(this.treeObj)) {\n      return;\n    }\n\n    var rootData = getValue(this.parent.pathId[0], this.parent.feParent);\n    setValue('_fm_icon', 'e-fe-folder', rootData);\n    var attr = {};\n    var id = getValue('id', rootData);\n\n    if (!isNOU(id)) {\n      setValue('data-id', id, attr);\n    }\n\n    if (!hasEditAccess(rootData)) {\n      setValue('class', getAccessClass(rootData), attr);\n    }\n\n    if (!isNOU(attr)) {\n      setValue('_fm_htmlAttr', attr, rootData);\n    }\n\n    this.treeObj = new BaseTreeView({\n      fields: {\n        dataSource: [rootData],\n        id: '_fm_id',\n        parentID: '_fm_pId',\n        expanded: '_fm_expanded',\n        selected: '_fm_selected',\n        text: 'name',\n        hasChildren: 'hasChild',\n        iconCss: '_fm_icon',\n        htmlAttributes: '_fm_htmlAttr',\n        tooltip: 'name'\n      },\n      enableHtmlSanitizer: this.parent.enableHtmlSanitizer,\n      nodeSelected: this.onNodeSelected.bind(this),\n      nodeExpanding: this.onNodeExpand.bind(this),\n      nodeClicked: this.onNodeClicked.bind(this),\n      allowEditing: true,\n      nodeEditing: this.onNodeEditing.bind(this),\n      drawNode: this.onDrowNode.bind(this),\n      enableRtl: this.parent.enableRtl,\n      dataBound: this.addDragDrop.bind(this)\n    });\n    this.treeObj.isStringTemplate = true;\n    this.treeObj.appendTo('#' + this.parent.element.id + CLS.TREE_ID);\n    this.wireEvents();\n  };\n\n  NavigationPane.prototype.addDragDrop = function () {\n    var _this = this;\n\n    if (!this.parent.isMobile && this.treeObj) {\n      if (this.parent.allowDragAndDrop) {\n        if (this.dragObj) {\n          this.dragObj.destroy();\n        }\n\n        this.dragObj = new Draggable(this.treeObj.element, {\n          cursorAt: this.parent.dragCursorPosition,\n          dragTarget: '.' + CLS.FULLROW,\n          dragArea: this.parent.element,\n          drag: draggingHandler.bind(this, this.parent),\n          dragStart: function (args) {\n            dragStartHandler(_this.parent, args, _this.dragObj);\n          },\n          dragStop: dragStopHandler.bind(this, this.parent),\n          enableTailMode: true,\n          enableAutoScroll: true,\n          helper: this.dragHelper.bind(this)\n        });\n      } else if (!this.parent.allowDragAndDrop && this.dragObj) {\n        this.dragObj.destroy();\n      }\n    }\n  };\n\n  NavigationPane.prototype.dragHelper = function (args) {\n    var dragTarget = args.sender.target;\n\n    if (!dragTarget.classList.contains(CLS.FULLROW)) {\n      return null;\n    }\n\n    var dragLi = closest(dragTarget, 'li');\n    this.parent.dragPath = '';\n    this.parent.dragData = [];\n    this.parent.activeElements = [];\n    this.parent.activeElements = [dragLi];\n    this.parent.dragNodes = [];\n    getModule(this.parent, dragLi);\n    this.parent.dragData = this.getTreeData(dragLi);\n    this.parent.dragPath = this.getDragPath(dragLi, this.parent.dragData[0].name);\n    this.parent.dragNodes.push(this.parent.dragData[0].name);\n    createVirtualDragElement(this.parent);\n    return this.parent.virtualDragElement;\n  };\n\n  NavigationPane.prototype.getDragPath = function (dragLi, text) {\n    var path = this.getDropPath(dragLi, text);\n    return getParentPath(path);\n  };\n\n  NavigationPane.prototype.getDropPath = function (node, text) {\n    var id = node.getAttribute('data-id');\n    var newText = this.parent.hasId ? id : text;\n    return getPath(node, newText, this.parent.hasId);\n  };\n\n  NavigationPane.prototype.onDrowNode = function (args) {\n    var eventArgs = {\n      element: args.node,\n      fileDetails: args.nodeData,\n      module: 'NavigationPane'\n    };\n    this.parent.trigger('fileLoad', eventArgs);\n  };\n\n  NavigationPane.prototype.addChild = function (files, target, prevent) {\n    var directories = getDirectories(files);\n\n    if (directories.length > 0) {\n      var length_1 = 0;\n      var folders = directories;\n\n      while (length_1 < directories.length) {\n        folders[length_1]._fm_icon = 'e-fe-folder';\n        var attr = {};\n        var id = getValue('id', folders[length_1]);\n\n        if (!isNOU(id)) {\n          setValue('data-id', id, attr);\n        }\n\n        if (!hasEditAccess(folders[length_1])) {\n          setValue('class', getAccessClass(folders[length_1]), attr);\n        }\n\n        if (!isNOU(attr)) {\n          setValue('_fm_htmlAttr', attr, folders[length_1]);\n        }\n\n        length_1++;\n      }\n\n      this.treeObj.addNodes(directories, target, null, prevent);\n    }\n  };\n\n  NavigationPane.prototype.onNodeSelected = function (args) {\n    if (this.parent.breadcrumbbarModule && this.parent.breadcrumbbarModule.searchObj && !this.renameParent) {\n      this.parent.breadcrumbbarModule.searchObj.element.value = '';\n      this.parent.isFiltered = false;\n    }\n\n    this.parent.searchedItems = [];\n\n    if (!args.isInteracted && !this.isRightClick && !this.isPathDragged && !this.isRenameParent) {\n      return;\n    }\n\n    this.activeNode = args.node;\n    this.parent.activeModule = 'navigationpane';\n    var nodeData = this.getTreeData(getValue('id', args.nodeData));\n\n    if (!this.renameParent) {\n      var eventArgs = {\n        cancel: false,\n        fileDetails: nodeData[0],\n        module: 'NavigationPane'\n      };\n      delete eventArgs.cancel;\n      this.parent.trigger('fileOpen', eventArgs);\n    }\n\n    this.parent.selectedItems = [];\n    this.parent.itemData = nodeData;\n    updatePath(args.node, this.parent.itemData[0], this.parent);\n    this.expandNodeTarget = null;\n\n    if (args.node.querySelector('.' + CLS.ICONS) && args.node.querySelector('.' + CLS.LIST_ITEM) === null) {\n      this.expandNodeTarget = 'add';\n    }\n\n    read(this.parent, this.isPathDragged ? events.pasteEnd : events.pathChanged, this.parent.path);\n    this.parent.visitedItem = args.node;\n    this.isPathDragged = this.isRenameParent = this.isRightClick = false;\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onPathDrag = function (args) {\n    this.isPathDragged = true;\n    this.selectResultNode(args[0]);\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onNodeExpand = function (args) {\n    if (!args.isInteracted && !this.isDrag) {\n      return;\n    }\n\n    if (args.node.querySelector('.' + CLS.LIST_ITEM) === null) {\n      var text = getValue('text', args.nodeData);\n      var id = args.node.getAttribute('data-id');\n      var isId = isNOU(id) ? false : true;\n      var newText = isNOU(id) ? text : id;\n      var path = getPath(args.node, newText, isId);\n      this.expandNodeTarget = args.node.getAttribute('data-uid');\n      this.parent.expandedId = this.expandNodeTarget;\n      this.parent.itemData = this.getTreeData(getValue('id', args.nodeData));\n      read(this.parent, events.nodeExpand, path);\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onNodeExpanded = function (args) {\n    this.addChild(args.files, this.expandNodeTarget, false);\n    this.parent.expandedId = null;\n  };\n\n  NavigationPane.prototype.onNodeClicked = function (args) {\n    this.parent.activeModule = 'navigationpane';\n    this.activeNode = args.node;\n\n    if (args.event.which === 3 && args.node.getAttribute('data-uid') !== this.treeObj.selectedNodes[0]) {\n      this.isRightClick = true;\n      this.treeObj.selectedNodes = [args.node.getAttribute('data-uid')];\n    } else if (args.node.getAttribute('data-uid') === this.treeObj.selectedNodes[0] && this.parent.selectedItems.length !== 0) {\n      this.parent.setProperties({\n        selectedItems: []\n      }, true);\n      var layout = this.parent.view === 'LargeIcons' ? 'largeiconsview' : 'detailsview';\n      this.parent.notify(events.modelChanged, {\n        module: layout,\n        newProp: {\n          selectedItems: []\n        }\n      });\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onNodeEditing = function (args) {\n    if (!isNOU(args.innerHtml)) {\n      args.cancel = true;\n    }\n  };\n\n  NavigationPane.prototype.onPathChanged = function (args) {\n    this.parent.isCut = false;\n    var currFiles = getValue(this.parent.pathId[this.parent.pathId.length - 1], this.parent.feFiles);\n\n    if (this.expandNodeTarget === 'add') {\n      var sNode = select('[data-uid=\"' + this.treeObj.selectedNodes[0] + '\"]', this.treeObj.element);\n      var ul = select('.' + CLS.LIST_PARENT, sNode);\n\n      if (isNOU(ul)) {\n        this.addChild(args.files, this.treeObj.selectedNodes[0], !this.expandTree);\n      }\n\n      this.expandNodeTarget = '';\n    }\n\n    this.expandTree = false;\n\n    if (isNOU(currFiles)) {\n      setValue(this.parent.pathId[this.parent.pathId.length - 1], args.files, this.parent.feFiles);\n    }\n  };\n\n  NavigationPane.prototype.updateTree = function (args) {\n    if (this.treeObj) {\n      var id = this.treeObj.selectedNodes[0];\n      this.updateTreeNode(args, id);\n    }\n  };\n\n  NavigationPane.prototype.updateTreeNode = function (args, id) {\n    var toExpand = this.treeObj.expandedNodes.indexOf(id) === -1 ? false : true;\n    this.removeChildNodes(id);\n    this.addChild(args.files, id, !toExpand);\n  };\n\n  NavigationPane.prototype.removeChildNodes = function (id) {\n    var sNode = select('[data-uid=\"' + id + '\"]', this.treeObj.element);\n    var parent = select('.' + CLS.LIST_PARENT, sNode);\n    var childs = parent ? Array.prototype.slice.call(parent.children) : null;\n\n    if (childs) {\n      this.treeObj.removeNodes(childs);\n    }\n  };\n\n  NavigationPane.prototype.onOpenEnd = function (args) {\n    var sleId = this.parent.pathId[this.parent.pathId.length - 1];\n    this.treeObj.expandAll(this.treeObj.selectedNodes);\n    this.treeObj.selectedNodes = [sleId];\n    this.expandNodeTarget = 'add';\n    this.onPathChanged(args);\n  };\n\n  NavigationPane.prototype.onOpenInit = function (args) {\n    if (this.parent.activeModule === 'navigationpane') {\n      if (args.target.querySelector('.' + CLS.ICONS)) {\n        this.treeObj.expandAll(this.treeObj.selectedNodes);\n      }\n    }\n  };\n\n  NavigationPane.prototype.onInitialEnd = function (args) {\n    this.onInit();\n    this.addChild(args.files, getValue('_fm_id', args.cwd), false);\n  };\n\n  NavigationPane.prototype.onFinalizeEnd = function (args) {\n    this.onInit();\n    var id = getValue('_fm_id', args.cwd);\n    this.removeChildNodes(id);\n    this.addChild(args.files, id, false);\n    this.treeObj.selectedNodes = [this.parent.pathId[this.parent.pathId.length - 1]];\n  };\n\n  NavigationPane.prototype.onCreateEnd = function (args) {\n    this.updateTree(args);\n  };\n\n  NavigationPane.prototype.onSelectedData = function () {\n    if (this.parent.activeModule === 'navigationpane') {\n      this.updateItemData();\n    }\n  };\n\n  NavigationPane.prototype.onDeleteInit = function () {\n    if (this.parent.activeModule === 'navigationpane') {\n      this.updateActionData();\n      var name_1 = getValue('name', this.parent.itemData[0]);\n      Delete(this.parent, [name_1], this.parent.path, 'delete');\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onDeleteEnd = function (args) {\n    if (this.parent.activeModule === 'navigationpane') {\n      var selectedNode = this.treeObj.selectedNodes[0];\n      var selcetedEle = select('[data-uid=\"' + selectedNode + '\"]', this.treeObj.element);\n      var selectedNodeEle = closest(selcetedEle, '.' + CLS.LIST_PARENT).parentElement;\n      this.treeObj.selectedNodes = [selectedNodeEle.getAttribute('data-uid')];\n      this.treeObj.dataBind();\n    }\n\n    this.updateTree(args);\n  };\n\n  NavigationPane.prototype.onRefreshEnd = function (args) {\n    this.updateTree(args);\n  };\n\n  NavigationPane.prototype.onRenameInit = function () {\n    if (this.parent.activeModule === 'navigationpane') {\n      this.updateRenameData();\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onRenameEndParent = function (args) {\n    var id = this.renameParent ? this.renameParent : this.parent.pathId[this.parent.pathId.length - 1];\n    this.expandTree = this.treeObj.expandedNodes.indexOf(this.treeObj.selectedNodes[0]) !== -1;\n    this.updateTreeNode(args, id);\n    this.parent.expandedId = null;\n\n    if (this.renameParent) {\n      this.renameParent = null;\n    } else {\n      var resultData = [];\n\n      if (this.parent.hasId) {\n        resultData = new DataManager(this.treeObj.getTreeData()).executeLocal(new Query().where('id', 'equal', this.parent.renamedId, false));\n      } else {\n        var nData = new DataManager(this.treeObj.getTreeData()).executeLocal(new Query().where(this.treeObj.fields.text, 'equal', this.parent.renameText, false));\n\n        if (nData.length > 0) {\n          resultData = new DataManager(nData).executeLocal(new Query().where('_fm_pId', 'equal', id, false));\n        }\n      }\n\n      if (resultData.length > 0) {\n        this.isRenameParent = true;\n        var id_1 = getValue(this.treeObj.fields.id, resultData[0]);\n        this.treeObj.selectedNodes = [id_1];\n        this.treeObj.dataBind();\n      }\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onRenameEnd = function (args) {\n    if (this.parent.breadcrumbbarModule.searchObj.element.value === '' && !this.parent.isFiltered) {\n      this.updateTree(args);\n    } else {\n      var data = this.treeObj.getTreeData();\n      var resultData = [];\n\n      if (this.parent.hasId) {\n        resultData = new DataManager(data).executeLocal(new Query().where('id', 'equal', this.parent.renamedId, false));\n      } else {\n        var nData = new DataManager(data).executeLocal(new Query().where(this.treeObj.fields.text, 'equal', this.parent.currentItemText, false));\n\n        if (nData.length > 0) {\n          resultData = new DataManager(nData).executeLocal(new Query().where('filterPath', 'equal', this.parent.filterPath, false));\n        }\n      }\n\n      if (resultData.length > 0) {\n        this.renameParent = getValue(this.treeObj.fields.parentID, resultData[0]);\n        this.parent.expandedId = this.renameParent;\n        this.parent.itemData = this.getTreeData(this.renameParent);\n        read(this.parent, events.renameEndParent, this.parent.filterPath.replace(/\\\\/g, '/'));\n      }\n    }\n  };\n\n  NavigationPane.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName() && e.module !== 'common') {\n      /* istanbul ignore next */\n      return;\n    }\n\n    for (var _i = 0, _a = Object.keys(e.newProp); _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      switch (prop) {\n        case 'allowDragAndDrop':\n          this.addDragDrop();\n          break;\n\n        case 'navigationPaneSettings':\n          read(this.parent, events.finalizeEnd, '/');\n          break;\n      }\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onDownLoadInit = function () {\n    this.doDownload();\n  };\n\n  NavigationPane.prototype.onSelectionChanged = function (e) {\n    this.treeObj.selectedNodes = [e.selectedNode];\n  };\n\n  NavigationPane.prototype.onClearPathInit = function (e) {\n    this.removeChildNodes(e.selectedNode);\n  };\n\n  NavigationPane.prototype.onDragEnd = function (args) {\n    var moveNames = [];\n\n    if (this.parent.isPasteError || this.parent.isSearchDrag) {\n      moveNames = this.getMoveNames(args.files, this.parent.isSearchDrag, this.parent.dragPath);\n    } else {\n      moveNames = this.moveNames;\n    }\n\n    this.treeObj.removeNodes(moveNames);\n  };\n\n  NavigationPane.prototype.getMoveNames = function (files, flag, path) {\n    var moveNames = [];\n\n    for (var i = 0; i < files.length; i++) {\n      if (!files[i].isFile) {\n        if (!this.parent.hasId) {\n          var name_2 = files[i].previousName;\n\n          if (flag) {\n            path = path + files[i].previousName;\n            var index = path.lastIndexOf('/');\n            name_2 = path.substring(index + 1);\n            path = path.substring(0, index + 1);\n          }\n\n          var resultData = new DataManager(this.treeObj.getTreeData()).executeLocal(new Query().where(this.treeObj.fields.text, 'equal', name_2, false));\n\n          for (var j = 0; j < resultData.length; j++) {\n            var fPath = getValue('filterPath', resultData[j]);\n            fPath = fPath.replace(/\\\\/g, '/');\n\n            if (fPath === path) {\n              moveNames.push(getValue(this.treeObj.fields.id, resultData[j]));\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    return moveNames;\n  };\n\n  NavigationPane.prototype.onCutEnd = function (args) {\n    var moveNames = [];\n\n    if (this.parent.isPasteError || this.parent.isSearchCut) {\n      this.moveNames = this.getMoveNames(args.files, this.parent.isSearchCut, this.parent.targetPath);\n    } else {\n      moveNames = this.moveNames;\n    }\n\n    this.treeObj.removeNodes(moveNames);\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.selectResultNode = function (resultObj) {\n    if (!this.parent.hasId) {\n      var path = getValue('filterPath', resultObj);\n      var itemname = getValue('name', resultObj);\n      var data = new DataManager(this.treeObj.getTreeData()).executeLocal(new Query().where(this.treeObj.fields.text, 'equal', itemname, false));\n\n      if (data.length > 0) {\n        var resultData = new DataManager(data).executeLocal(new Query().where('filterPath', 'equal', path, false));\n\n        if (resultData.length > 0) {\n          var id = getValue(this.treeObj.fields.id, resultData[0]);\n          this.treeObj.selectedNodes = [id];\n          this.treeObj.dataBind();\n        }\n      }\n    } else {\n      this.treeObj.selectedNodes = [getValue('_fm_id', resultObj)];\n      this.treeObj.dataBind();\n    }\n  };\n\n  NavigationPane.prototype.onDropPath = function (args) {\n    this.onpasteEnd(args);\n    this.selectResultNode(this.parent.dropData);\n    this.parent.isDropEnd = !this.parent.isPasteError;\n  };\n\n  NavigationPane.prototype.onpasteEnd = function (args) {\n    var resultData = [];\n\n    if (this.parent.hasId) {\n      resultData = new DataManager(this.treeObj.getTreeData()).executeLocal(new Query().where('id', 'equal', getValue('id', args.cwd), false));\n    } else {\n      var nData = new DataManager(this.treeObj.getTreeData()).executeLocal(new Query().where(this.treeObj.fields.text, 'equal', getValue('name', args.cwd), false));\n\n      if (nData.length > 0) {\n        resultData = new DataManager(nData).executeLocal(new Query().where('filterPath', 'equal', getValue('filterPath', args.cwd), false));\n      }\n    }\n\n    if (resultData.length > 0) {\n      var id = getValue(this.treeObj.fields.id, resultData[0]);\n      var toExpand = this.treeObj.expandedNodes.indexOf(id) === -1;\n      this.removeChildNodes(id);\n      this.addChild(args.files, id, toExpand);\n    }\n\n    this.parent.expandedId = null;\n    this.onPathChanged(args);\n\n    if (this.parent.isDragDrop) {\n      this.checkDropPath(args);\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.checkDropPath = function (args) {\n    if (this.parent.hasId) {\n      this.parent.isDropEnd = !this.parent.isPasteError;\n      return;\n    }\n\n    if (this.parent.dropPath.indexOf(getDirectoryPath(this.parent, args)) === -1) {\n      this.parent.isDropEnd = false;\n      readDropPath(this.parent);\n    } else {\n      this.parent.isDropEnd = !this.parent.isPasteError;\n    }\n  };\n\n  NavigationPane.prototype.onpasteInit = function () {\n    if (this.parent.activeModule === this.getModuleName()) {\n      this.updateItemData();\n    }\n\n    this.moveNames = [];\n    var obj = this.parent.isDragDrop ? this.parent.dragData : this.parent.actionRecords;\n\n    for (var i = 0; i < obj.length; i++) {\n      if (getValue('isFile', obj[i]) === false) {\n        this.moveNames.push(getValue('_fm_id', obj[i]));\n      }\n    }\n  };\n\n  NavigationPane.prototype.oncutCopyInit = function () {\n    if (this.parent.activeModule === this.getModuleName()) {\n      this.parent.activeRecords = this.getTreeData(this.treeObj.selectedNodes[0]);\n      this.parent.activeElements = [this.activeNode];\n    }\n  };\n\n  NavigationPane.prototype.addEventListener = function () {\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.downloadInit, this.onDownLoadInit, this);\n    this.parent.on(events.initialEnd, this.onInitialEnd, this);\n    this.parent.on(events.finalizeEnd, this.onFinalizeEnd, this);\n    this.parent.on(events.pathChanged, this.onPathChanged, this);\n    this.parent.on(events.pasteEnd, this.onpasteEnd, this);\n    this.parent.on(events.cutEnd, this.onCutEnd, this);\n    this.parent.on(events.pasteInit, this.onpasteInit, this);\n    this.parent.on(events.nodeExpand, this.onNodeExpanded, this);\n    this.parent.on(events.createEnd, this.onCreateEnd, this);\n    this.parent.on(events.selectedData, this.onSelectedData, this);\n    this.parent.on(events.deleteInit, this.onDeleteInit, this);\n    this.parent.on(events.deleteEnd, this.onDeleteEnd, this);\n    this.parent.on(events.refreshEnd, this.onRefreshEnd, this);\n    this.parent.on(events.updateTreeSelection, this.onSelectionChanged, this);\n    this.parent.on(events.openInit, this.onOpenInit, this);\n    this.parent.on(events.openEnd, this.onOpenEnd, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.renameInit, this.onRenameInit, this);\n    this.parent.on(events.renameEnd, this.onRenameEnd, this);\n    this.parent.on(events.renameEndParent, this.onRenameEndParent, this);\n    this.parent.on(events.clearPathInit, this.onClearPathInit, this);\n    this.parent.on(events.cutCopyInit, this.oncutCopyInit, this);\n    this.parent.on(events.dropInit, this.onDropInit, this);\n    this.parent.on(events.menuItemData, this.onMenuItemData, this);\n    this.parent.on(events.dragEnd, this.onDragEnd, this);\n    this.parent.on(events.dragging, this.onDragging, this);\n    this.parent.on(events.dropPath, this.onDropPath, this);\n    this.parent.on(events.detailsInit, this.onDetailsInit, this);\n    this.parent.on(events.pathDrag, this.onPathDrag, this);\n  };\n\n  NavigationPane.prototype.removeEventListener = function () {\n    this.parent.off(events.initialEnd, this.onInitialEnd);\n    this.parent.off(events.downloadInit, this.onDownLoadInit);\n    this.parent.off(events.finalizeEnd, this.onFinalizeEnd);\n    this.parent.off(events.selectedData, this.onSelectedData);\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n    this.parent.off(events.pathChanged, this.onPathChanged);\n    this.parent.off(events.pasteEnd, this.onpasteEnd);\n    this.parent.off(events.cutEnd, this.onCutEnd);\n    this.parent.off(events.pasteInit, this.onpasteInit);\n    this.parent.off(events.updateTreeSelection, this.onSelectionChanged);\n    this.parent.off(events.nodeExpand, this.onNodeExpanded);\n    this.parent.off(events.createEnd, this.onCreateEnd);\n    this.parent.off(events.refreshEnd, this.onRefreshEnd);\n    this.parent.off(events.openInit, this.onOpenInit);\n    this.parent.off(events.openEnd, this.onOpenEnd);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.renameInit, this.onRenameInit);\n    this.parent.off(events.renameEnd, this.onRenameEnd);\n    this.parent.off(events.renameEndParent, this.onRenameEndParent);\n    this.parent.off(events.clearPathInit, this.onClearPathInit);\n    this.parent.off(events.deleteInit, this.onDeleteInit);\n    this.parent.off(events.deleteEnd, this.onDeleteEnd);\n    this.parent.off(events.cutCopyInit, this.oncutCopyInit);\n    this.parent.off(events.dropInit, this.onDropInit);\n    this.parent.off(events.dragEnd, this.onDragEnd);\n    this.parent.off(events.dragging, this.onDragging);\n    this.parent.off(events.dropPath, this.onDropPath);\n    this.parent.off(events.detailsInit, this.onDetailsInit);\n    this.parent.off(events.menuItemData, this.onMenuItemData);\n    this.parent.off(events.pathDrag, this.onPathDrag);\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onDetailsInit = function () {\n    if (this.parent.activeModule === this.getModuleName()) {\n      var dataobj = this.getTreeData(this.treeObj.selectedNodes[0]);\n      this.parent.itemData = dataobj;\n    }\n  };\n\n  NavigationPane.prototype.onMenuItemData = function (args) {\n    if (this.parent.activeModule === this.getModuleName()) {\n      var liEle = closest(args.target, 'li');\n      this.parent.itemData = this.getTreeData(liEle.getAttribute('data-uid'));\n    }\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.onDragging = function (args) {\n    var ele = closest(args.target, 'li');\n\n    if (ele.classList.contains('e-node-collapsed')) {\n      this.isDrag = true;\n      var level = parseInt(ele.getAttribute('aria-level'), 10);\n      this.treeObj.expandAll([ele.getAttribute('data-uid')], level + 1);\n      this.isDrag = false;\n    }\n  };\n\n  NavigationPane.prototype.onDropInit = function (args) {\n    if (this.parent.targetModule === this.getModuleName()) {\n      var dropLi = closest(args.target, 'li');\n      this.parent.dropData = this.getTreeData(dropLi)[0];\n      this.parent.dropPath = this.getDropPath(dropLi, getValue('name', this.parent.dropData));\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  NavigationPane.prototype.getModuleName = function () {\n    return 'navigationpane';\n  };\n\n  NavigationPane.prototype.destroy = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.removeEventListener();\n\n    if (this.treeObj) {\n      this.unWireEvents();\n      this.treeObj.destroy();\n    }\n  };\n\n  NavigationPane.prototype.wireEvents = function () {\n    this.keyboardModule = new KeyboardEvents(this.treeObj.element, {\n      keyAction: this.keyDown.bind(this),\n      keyConfigs: this.keyConfigs,\n      eventName: 'keydown'\n    });\n  };\n\n  NavigationPane.prototype.unWireEvents = function () {\n    this.keyboardModule.destroy();\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.keyDown = function (e) {\n    var action = e.action;\n\n    switch (action) {\n      case 'altEnter':\n        this.parent.notify(events.detailsInit, {});\n        GetDetails(this.parent, [], this.parent.path, 'details');\n        break;\n\n      case 'esc':\n        removeActive(this.parent);\n        break;\n\n      case 'del':\n        this.updateItemData();\n\n        if (!hasEditAccess(this.parent.itemData[0])) {\n          createDeniedDialog(this.parent, this.parent.itemData[0], events.permissionEdit);\n        } else {\n          this.removeNodes = [];\n          createDialog(this.parent, 'Delete');\n        }\n\n        break;\n\n      case 'ctrlC':\n        copyFiles(this.parent);\n        break;\n\n      case 'ctrlV':\n        this.parent.folderPath = '';\n        pasteHandler(this.parent);\n        break;\n\n      case 'ctrlX':\n        cutFiles(this.parent);\n        break;\n\n      case 'shiftF10':\n        this.updateItemData();\n\n        if (!hasDownloadAccess(this.parent.itemData[0])) {\n          createDeniedDialog(this.parent, this.parent.itemData[0], events.permissionDownload);\n          return;\n        }\n\n        if (this.parent.selectedItems.length !== 0) {\n          this.doDownload();\n        }\n\n        break;\n\n      case 'f2':\n        if (this.parent.selectedItems.length === 0) {\n          var data = this.getTreeData(this.treeObj.selectedNodes[0])[0];\n\n          if (!hasEditAccess(data)) {\n            createDeniedDialog(this.parent, data, events.permissionEdit);\n          } else {\n            this.updateRenameData();\n            createDialog(this.parent, 'Rename');\n          }\n        }\n\n        break;\n    }\n  };\n\n  NavigationPane.prototype.getTreeData = function (args) {\n    var data = this.treeObj.getTreeData(args);\n\n    for (var i = 0; i < data.length; i++) {\n      if (isNOU(getValue('hasChild', data[i]))) {\n        setValue('hasChild', false, data[i]);\n      }\n    }\n\n    return data;\n  };\n\n  NavigationPane.prototype.updateRenameData = function () {\n    this.updateItemData();\n    this.parent.currentItemText = getValue('name', this.parent.itemData[0]);\n  };\n\n  NavigationPane.prototype.updateItemData = function () {\n    var data = this.getTreeData(this.treeObj.selectedNodes[0])[0];\n    this.parent.itemData = [data];\n    this.parent.isFile = false;\n  };\n\n  NavigationPane.prototype.updateActionData = function () {\n    this.updateItemData();\n    var newPath = getParentPath(this.parent.path);\n    this.parent.setProperties({\n      path: newPath\n    }, true);\n    this.parent.pathId.pop();\n    this.parent.pathNames.pop();\n  };\n  /* istanbul ignore next */\n\n\n  NavigationPane.prototype.doDownload = function () {\n    var newPath = getParentPath(this.parent.path);\n    var itemId = this.treeObj.selectedNodes[0];\n    var name = itemId === this.parent.pathId[0] ? '' : getValue('name', this.parent.itemData[0]);\n    Download(this.parent, newPath, [name]);\n  };\n\n  return NavigationPane;\n}();\n\nexport { NavigationPane };","map":null,"metadata":{},"sourceType":"module"}