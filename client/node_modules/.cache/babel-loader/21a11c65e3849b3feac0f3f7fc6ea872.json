{"ast":null,"code":"import { Dialog } from '@syncfusion/ej2-popups';\nimport { select, isNullOrUndefined as isNOU, createElement, Internationalization } from '@syncfusion/ej2-base';\nimport { getValue, remove, selectAll, isBlazor } from '@syncfusion/ej2-base';\nimport { createFolder } from '../common/operations';\nimport * as CLS from '../base/classes';\nimport * as events from '../base/constant';\nimport { paste, rename } from '../common/operations';\nimport { getLocaleText, getDuplicateData, getParentPath, objectToString, getCssClass } from '../common/utility';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { CheckBox } from '@syncfusion/ej2-buttons'; // tslint:disable-next-line\n\nexport function createDialog(parent, text, e, details, replaceItems) {\n  var options = getOptions(parent, text, e, details, replaceItems);\n\n  if (isNOU(parent.dialogObj)) {\n    parent.dialogObj = new Dialog({\n      beforeOpen: keydownAction.bind(this, parent, options.dialogName),\n      beforeClose: function (args) {\n        triggerPopupBeforeClose(parent, parent.dialogObj, args, options.dialogName);\n      },\n      header: options.header,\n      content: options.content,\n      buttons: options.buttons,\n      animationSettings: {\n        effect: 'None'\n      },\n      showCloseIcon: true,\n      closeOnEscape: true,\n      visible: true,\n      allowDragging: true,\n      isModal: true,\n      target: parent.popupTarget ? parent.popupTarget : '#' + parent.element.id,\n      cssClass: getCssClass(parent, parent.isMobile ? CLS.MOB_POPUP : CLS.ROOT_POPUP),\n      width: '350px',\n      open: options.open,\n      close: options.close,\n      enableRtl: parent.enableRtl,\n      enableHtmlSanitizer: parent.enableHtmlSanitizer,\n      locale: parent.locale\n    });\n    parent.dialogObj.isStringTemplate = true;\n    parent.dialogObj.appendTo('#' + parent.element.id + CLS.DIALOG_ID);\n  } else {\n    changeOptions(parent, options);\n  }\n}\nexport function createExtDialog(parent, text, replaceItems, newPath) {\n  var extOptions = getExtOptions(parent, text, replaceItems, newPath);\n  parent.isApplySame = false;\n\n  if (isNOU(parent.extDialogObj)) {\n    parent.extDialogObj = new Dialog({\n      beforeOpen: beforeExtOpen.bind(this, parent, extOptions.dialogName),\n      beforeClose: function (args) {\n        triggerPopupBeforeClose(parent, parent.extDialogObj, args, extOptions.dialogName);\n      },\n      content: extOptions.content,\n      header: extOptions.header,\n      closeOnEscape: true,\n      allowDragging: true,\n      animationSettings: {\n        effect: 'None'\n      },\n      target: parent.popupTarget ? parent.popupTarget : '#' + parent.element.id,\n      cssClass: getCssClass(parent, parent.isMobile ? CLS.MOB_POPUP : CLS.ROOT_POPUP),\n      enableRtl: parent.enableRtl,\n      showCloseIcon: true,\n      isModal: true,\n      width: 350,\n      buttons: extOptions.buttons,\n      open: extOptions.open,\n      close: extOptions.close,\n      enableHtmlSanitizer: parent.enableHtmlSanitizer,\n      locale: parent.locale\n    });\n    parent.extDialogObj.isStringTemplate = true;\n    parent.extDialogObj.appendTo('#' + parent.element.id + CLS.EXTN_DIALOG_ID);\n  } else {\n    parent.extDialogObj.header = extOptions.header;\n    parent.extDialogObj.close = extOptions.close;\n    parent.extDialogObj.open = extOptions.open;\n    parent.extDialogObj.close = extOptions.close;\n    parent.extDialogObj.content = extOptions.content;\n    parent.extDialogObj.buttons = extOptions.buttons;\n    parent.extDialogObj.enableRtl = parent.enableRtl;\n    parent.extDialogObj.locale = parent.locale;\n    parent.extDialogObj.beforeOpen = beforeExtOpen.bind(this, parent, extOptions.dialogName);\n\n    parent.extDialogObj.beforeClose = function (args) {\n      triggerPopupBeforeClose(parent, parent.extDialogObj, args, extOptions.dialogName);\n    };\n\n    parent.extDialogObj.dataBind();\n    parent.extDialogObj.show();\n  }\n}\n\nfunction triggerPopupBeforeOpen(parent, dlgModule, args, dialogName) {\n  var eventArgs = {\n    cancel: args.cancel,\n    popupName: dialogName,\n    popupModule: dlgModule\n  };\n  /* istanbul ignore next */\n\n  if (isBlazor()) {\n    delete eventArgs.popupModule;\n  }\n\n  parent.trigger('beforePopupOpen', eventArgs, function (eventargs) {\n    args.cancel = eventargs.cancel;\n  });\n}\n\nfunction triggerPopupBeforeClose(parent, dlgModule, args, dialogName) {\n  var eventArgs = {\n    cancel: args.cancel,\n    popupModule: dlgModule,\n    popupName: dialogName\n  };\n  /* istanbul ignore next */\n\n  if (isBlazor()) {\n    delete eventArgs.popupModule;\n  }\n\n  parent.trigger('beforePopupClose', eventArgs, function (eventargs) {\n    args.cancel = eventargs.cancel;\n\n    if (!args.cancel && args.isInteracted && (dialogName === 'Rename' || dialogName === 'Create Folder')) {\n      parent.trigger(events.actionFailure, {});\n    }\n  });\n}\n\nfunction triggerPopupOpen(parent, dlgModule, dialogName) {\n  var args = {\n    popupModule: dlgModule,\n    element: dlgModule.element,\n    popupName: dialogName\n  };\n  /* istanbul ignore next */\n\n  if (isBlazor()) {\n    delete args.popupModule;\n  }\n\n  parent.trigger('popupOpen', args);\n}\n\nfunction triggerPopupClose(parent, dlgModule, dialogName) {\n  var args = {\n    popupModule: dlgModule,\n    element: dlgModule.element,\n    popupName: dialogName\n  };\n  /* istanbul ignore next */\n\n  if (isBlazor()) {\n    delete args.popupModule;\n  }\n\n  parent.trigger('popupClose', args);\n} // tslint:disable-next-line:max-func-body-length\n\n\nfunction getExtOptions(parent, text, replaceItems, newPath) {\n  var options = {\n    header: '',\n    content: '',\n    buttons: [],\n    dialogName: ''\n  };\n\n  options.open = function () {\n    triggerPopupOpen(parent, parent.extDialogObj, options.dialogName);\n  };\n\n  options.close = function () {\n    triggerPopupClose(parent, parent.extDialogObj, options.dialogName);\n  };\n\n  switch (text) {\n    case 'Extension':\n      options.header = getLocaleText(parent, 'Header-Rename-Confirmation');\n      options.content = '<div>' + getLocaleText(parent, 'Content-Rename-Confirmation') + '</div>';\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Yes')\n        },\n        click: function () {\n          parent.extDialogObj.hide();\n          rename(parent, newPath, parent.renameText);\n        }\n      }, {\n        buttonModel: {\n          content: getLocaleText(parent, 'Button-No')\n        },\n        click: function () {\n          parent.extDialogObj.hide();\n          parent.dialogObj.hide();\n        }\n      }];\n      options.dialogName = 'Extension Change';\n      break;\n\n    case 'DuplicateItems':\n      options.dialogName = 'Duplicate Items';\n      parent.replaceItems = replaceItems;\n      var item = parent.replaceItems[parent.fileLength];\n      var index = item.lastIndexOf('/');\n      item = index === -1 ? item : item.substring(index);\n      options.header = getLocaleText(parent, 'Header-Duplicate');\n      var duplicateContent_1 = '<div>' + getLocaleText(parent, 'Content-Duplicate') + '</div>';\n      options.content = duplicateContent_1.replace('{0}', item);\n\n      options.close = function () {\n        if (!parent.isDropEnd && parent.duplicateItems.length === 0) {\n          var args = {\n            fileDetails: parent.droppedObjects\n          };\n          parent.trigger('fileDropped', args);\n          parent.isDropEnd = parent.isDragDrop = false;\n        }\n\n        triggerPopupClose(parent, parent.extDialogObj, options.dialogName);\n      };\n\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Yes')\n        },\n        click: function () {\n          parent.duplicateItems.push(parent.replaceItems[parent.fileLength]);\n          parent.duplicateRecords.push(getDuplicateData(parent, parent.replaceItems[parent.fileLength]));\n          parent.fileLength++;\n\n          if (replaceItems[parent.fileLength]) {\n            var item_1 = parent.replaceItems[parent.fileLength];\n            var indexval = item_1.lastIndexOf('/');\n            item_1 = indexval === -1 ? item_1 : item_1.substring(indexval);\n            parent.extDialogObj.content = duplicateContent_1.replace('{0}', item_1);\n            parent.extDialogObj.show();\n          } else {\n            parent.extDialogObj.hide();\n            var targetPath = parent.isDragDrop ? parent.dragPath : parent.targetPath;\n            var path = parent.isDragDrop ? parent.dropPath : parent.folderPath === '' ? parent.path : parent.folderPath;\n            var action = parent.isDragDrop ? 'move' : parent.fileAction;\n            paste(parent, targetPath, parent.duplicateItems, path, action, parent.duplicateItems, parent.duplicateRecords);\n          }\n        }\n      }, {\n        buttonModel: {\n          content: getLocaleText(parent, 'Button-No')\n        },\n        click: function () {\n          parent.fileLength++;\n\n          if (replaceItems[parent.fileLength]) {\n            var item_2 = parent.replaceItems[parent.fileLength];\n            var ind = item_2.lastIndexOf('/');\n            item_2 = ind === -1 ? item_2 : item_2.substring(ind);\n            parent.extDialogObj.content = duplicateContent_1.replace('{0}', item_2);\n            parent.extDialogObj.show();\n          } else {\n            parent.extDialogObj.hide();\n\n            if (parent.duplicateItems.length !== 0) {\n              var action = parent.isDragDrop ? 'move' : parent.fileAction;\n              var targetPath = parent.isDragDrop ? parent.dragPath : parent.targetPath;\n              var path = parent.isDragDrop ? parent.dropPath : parent.folderPath === '' ? parent.path : parent.folderPath;\n              paste(parent, targetPath, parent.duplicateItems, path, action, parent.duplicateItems, parent.duplicateRecords);\n            }\n          }\n        }\n      }];\n      break;\n\n    case 'UploadRetry':\n      options.dialogName = 'Retry Upload';\n      options.header = getLocaleText(parent, 'Header-Retry');\n      options.content = parent.retryFiles[0].name + '<div class=\"e-fe-retrycontent\">' + getLocaleText(parent, 'Content-Retry') + '</div>';\n      options.open = onRetryOpen.bind(this, parent);\n\n      options.close = function () {\n        parent.isRetryOpened = false;\n        retryDlgClose(parent);\n        triggerPopupClose(parent, parent.extDialogObj, options.dialogName);\n      };\n\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Keep-Both')\n        },\n        click: function () {\n          retryDlgUpdate(parent, true);\n        }\n      }, {\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Replace')\n        },\n        click: function () {\n          retryDlgUpdate(parent, false);\n        }\n      }, {\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Skip')\n        },\n        click: function () {\n          var count = 0;\n\n          if (parent.isApplySame) {\n            count = parent.retryFiles.length;\n            parent.retryFiles = [];\n            retryDlgClose(parent);\n          } else {\n            count = 1;\n            parent.retryFiles.splice(0, 1);\n            parent.retryFiles.length !== 0 ? createExtDialog(parent, 'UploadRetry') : retryDlgClose(parent);\n          }\n\n          parent.notify(events.skipUpload, {\n            count: count\n          });\n        }\n      }];\n      break;\n  }\n\n  return options;\n}\n\nfunction retryDlgUpdate(parent, isKeepBoth) {\n  if (parent.isApplySame) {\n    isKeepBoth ? onKeepBothAll(parent) : onReplaceAll(parent);\n    retryDlgClose(parent);\n  } else {\n    parent.retryArgs.push({\n      action: isKeepBoth ? 'keepboth' : 'replace',\n      file: parent.retryFiles[0]\n    });\n    parent.uploadObj.retry(parent.retryFiles[0]);\n    parent.retryFiles.splice(0, 1);\n    parent.retryFiles.length !== 0 ? createExtDialog(parent, 'UploadRetry') : retryDlgClose(parent);\n  }\n}\n\nfunction retryDlgClose(parent) {\n  var flag = true;\n\n  if (parent.isRetryOpened) {\n    parent.isRetryOpened = false;\n  } else {\n    flag = false;\n  }\n\n  var ele = select('.e-dlg-checkbox', parent.extDialogObj.element);\n\n  if (ele) {\n    remove(ele);\n  }\n\n  if (flag) {\n    parent.extDialogObj.hide();\n  } else {\n    parent.retryFiles = [];\n  }\n}\n\nfunction onRetryOpen(parent, args) {\n  parent.isRetryOpened = true;\n  var dialogEle = getValue('element', args);\n  var container = select('.e-dlg-content', dialogEle);\n  var checkContainer = parent.createElement('div', {\n    className: 'e-dlg-checkbox'\n  });\n  var checkbox = parent.createElement('input', {\n    id: parent.element.id + '_applyall'\n  });\n  checkContainer.appendChild(checkbox);\n  container.appendChild(checkContainer);\n  var checkBoxObj = new CheckBox({\n    label: getLocaleText(parent, 'ApplyAll-Label'),\n    change: function (args) {\n      parent.isApplySame = args.checked;\n    }\n  });\n  checkBoxObj.appendTo('#' + parent.element.id + '_applyall');\n  triggerPopupOpen(parent, parent.extDialogObj, 'Retry Upload');\n}\n\nfunction onKeepBothAll(parent) {\n  while (parent.retryFiles.length !== 0) {\n    parent.retryArgs.push({\n      action: 'keepboth',\n      file: parent.retryFiles[0]\n    });\n    parent.uploadObj.retry(parent.retryFiles[0]);\n    parent.retryFiles.splice(0, 1);\n  }\n}\n\nfunction onReplaceAll(parent) {\n  while (parent.retryFiles.length !== 0) {\n    parent.retryArgs.push({\n      action: 'replace',\n      file: parent.retryFiles[0]\n    });\n    parent.uploadObj.retry(parent.retryFiles[0]);\n    parent.retryFiles.splice(0, 1);\n  }\n}\n\nfunction focusInput(parent) {\n  var ele = select('#newname', parent.dialogObj.element);\n  ele.focus();\n  ele.value = '';\n  var len = ele.value.length;\n  ele.setSelectionRange(0, len);\n}\n\nfunction onFolderDialogOpen(parent) {\n  var ele = select('#newname', parent.dialogObj.element);\n\n  if (!ele.parentElement.classList.contains('e-control-wrapper')) {\n    createInput(ele, getLocaleText(parent, 'Content-NewFolder'));\n  }\n\n  ele.parentElement.nextElementSibling.innerHTML = '';\n\n  ele.oninput = function () {\n    onValidate(parent, ele);\n  };\n\n  ele.onkeyup = function (e) {\n    var code = getKeyCode(e);\n\n    if (code === 13) {\n      onSubmit(parent);\n    }\n  };\n\n  focusInput(parent);\n  triggerPopupOpen(parent, parent.dialogObj, 'Create Folder');\n}\n\nfunction onRenameDialogOpen(parent) {\n  var inputEle = select('#rename', parent.dialogObj.element);\n\n  if (!inputEle.parentElement.classList.contains('e-control-wrapper')) {\n    createInput(inputEle, getLocaleText(parent, 'Content-Rename'));\n  }\n\n  inputEle.parentElement.nextElementSibling.innerHTML = '';\n\n  inputEle.oninput = function () {\n    onValidate(parent, inputEle);\n  };\n\n  inputEle.onkeyup = function (e) {\n    var code = getKeyCode(e);\n\n    if (code === 13) {\n      onReSubmit(parent);\n    }\n  };\n\n  onFocusRenameInput(parent, inputEle);\n  triggerPopupOpen(parent, parent.dialogObj, 'Rename');\n}\n\nfunction onFocusRenameInput(parent, inputEle) {\n  inputEle.focus();\n  var txt = '';\n\n  if (parent.isFile && !parent.showFileExtension) {\n    var index = parent.currentItemText.lastIndexOf('.');\n    txt = index === -1 ? parent.currentItemText : parent.currentItemText.substring(0, index);\n  } else {\n    txt = parent.currentItemText;\n  }\n\n  inputEle.value = txt;\n\n  if (parent.isFile && parent.showFileExtension && inputEle.value.indexOf('.') !== -1) {\n    inputEle.setSelectionRange(0, inputEle.value.lastIndexOf('.'));\n  } else {\n    inputEle.setSelectionRange(0, inputEle.value.length);\n  }\n}\n\nfunction createInput(ele, placeholder) {\n  Input.createInput({\n    element: ele,\n    properties: {\n      placeholder: placeholder\n    }\n  });\n} // tslint:disable-next-line\n\n/* istanbul ignore next */\n\n\nfunction getOptions(parent, text, e, details, replaceItems) {\n  var options = {\n    header: '',\n    content: '',\n    buttons: [],\n    dialogName: ''\n  };\n\n  options.open = function () {\n    triggerPopupOpen(parent, parent.dialogObj, options.dialogName);\n  };\n\n  options.close = function () {\n    triggerPopupClose(parent, parent.dialogObj, options.dialogName);\n  };\n\n  text = details && details.multipleFiles === true ? 'MultipleFileDetails' : text;\n\n  switch (text) {\n    case 'NewFolder':\n      options.dialogName = 'Create Folder';\n      options.header = getLocaleText(parent, 'Header-NewFolder');\n      options.content = '<input type=\"text\" value=\"New folder\" id=\"newname\"><div class=\"e-fe-error\"></div>';\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Create')\n        },\n        click: function (e) {\n          if (e.type === 'keydown') {\n            return;\n          }\n\n          onSubmit(parent);\n        }\n      }];\n      options.open = onFolderDialogOpen.bind(this, parent);\n      break;\n\n    case 'Delete':\n      options.dialogName = 'Delete';\n\n      if (parent.selectedItems.length > 1) {\n        options.content = ('<div>' + getLocaleText(parent, 'Content-Multiple-Delete') + '</div>').replace('{0}', parent.selectedItems.length.toString());\n        options.header = getLocaleText(parent, 'Header-Multiple-Delete');\n      } else {\n        options.content = '<div>' + getLocaleText(parent, parent.isFile ? 'Content-Delete' : 'Content-Folder-Delete') + '</div>';\n        options.header = getLocaleText(parent, parent.isFile ? 'Header-Delete' : 'Header-Folder-Delete');\n      }\n\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Yes')\n        },\n        click: function (e) {\n          onDeleteSubmit(parent);\n        }\n      }, {\n        buttonModel: {\n          content: getLocaleText(parent, 'Button-No')\n        },\n        click: function () {\n          parent.dialogObj.hide();\n        }\n      }];\n      break;\n\n    case 'Rename':\n      options.dialogName = 'Rename';\n      options.header = getLocaleText(parent, 'Header-Rename');\n      options.content = '<input type=\"text\" class=\"e-input\" id=\"rename\"><div class=\"e-fe-error\"></div>';\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Save')\n        },\n        click: function (e) {\n          if (e.type === 'keydown') {\n            return;\n          }\n\n          onReSubmit(parent);\n        }\n      }];\n      options.open = onRenameDialogOpen.bind(this, parent);\n      break;\n\n    case 'details':\n      options.dialogName = 'File Details';\n      var intl = new Internationalization(parent.locale);\n      var formattedString = intl.formatDate(new Date(details.modified), {\n        format: 'MMMM dd, yyyy HH:mm:ss'\n      });\n      var permission = '';\n\n      if (!isNOU(details.permission)) {\n        permission = '<tr><td>' + getLocaleText(parent, 'Permission') + '</td><td class=\"' + CLS.VALUE + '\" >' + objectToString(details.permission) + '</td></tr>';\n      }\n\n      options.header = details.name;\n      options.content = '<table>' + '<tr><td>' + getLocaleText(parent, 'Type') + '</td><td class=\"' + CLS.VALUE + '\" title=\"' + (details.isFile ? 'File' : 'Folder') + '\">' + (details.isFile ? 'File' : 'Folder') + '</td></tr>' + '<tr><td>' + getLocaleText(parent, 'Size') + '</td><td><span class=\"' + CLS.VALUE + '\" title =\"' + details.size + '\">' + details.size + '</span></td></tr>' + '<tr><td>' + getLocaleText(parent, 'Location') + '</td><td class=\"' + CLS.VALUE + '\" title=\"' + details.location + '\">' + details.location + '</td></tr>' + '<tr><td>' + getLocaleText(parent, 'Modified') + '</td><td class=\"' + CLS.VALUE + '\" >' + formattedString + '</td></tr>' + permission + '</table>';\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Ok')\n        },\n        click: function (e) {\n          parent.dialogObj.hide();\n        }\n      }];\n      break;\n\n    case 'MultipleFileDetails':\n      options.dialogName = 'File Details';\n      var strArr = details.name.split(',').map(function (val) {\n        var index = val.indexOf('.') + 1;\n        return index === 0 ? 'Folder' : val.substr(index).replace(' ', '');\n      });\n      var fileType = strArr.every(function (val, i, arr) {\n        return val === arr[0];\n      }) ? strArr[0] === 'Folder' ? 'Folder' : strArr[0].toLocaleUpperCase() + ' Type' : 'Multiple Types';\n      var location_1 = details.location;\n      options.header = details.name;\n      options.content = '<table><tr><td>' + getLocaleText(parent, 'Type') + ':</td><td class=\"' + CLS.VALUE + '\">' + fileType + '</td></tr>' + '<tr><td>' + getLocaleText(parent, 'Size') + ':</td><td>' + details.size + '<span class=\"' + CLS.VALUE + '\" title =\"' + details.size + '\"></span></td></tr>' + '<tr><td>' + getLocaleText(parent, 'Location') + ':</td><td class=\"' + CLS.VALUE + '\" title=\"' + location_1 + '\">' + location_1 + '</td></tr>' + '</table>';\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Ok')\n        },\n        click: function (e) {\n          if (e.type === 'keydown') {\n            return;\n          }\n\n          parent.dialogObj.hide();\n        }\n      }];\n      break;\n\n    case 'Error':\n      parent.notify(events.actionFailure, {});\n      options.dialogName = 'Error';\n      var event_1 = e;\n\n      if (event_1.error.code === '401') {\n        options.header = '<span class=\"e-fe-icon e-fe-access-error\"></span><div class=\"e-fe-access-header\">' + getLocaleText(parent, 'Access-Denied') + '</div>';\n      } else {\n        options.header = getLocaleText(parent, 'Error');\n      }\n\n      options.content = '<div class=\"' + CLS.ERROR_CONTENT + '\">' + event_1.error.message + '</div>';\n      options.buttons = [{\n        buttonModel: {\n          isPrimary: true,\n          content: getLocaleText(parent, 'Button-Ok')\n        },\n        click: function (e) {\n          parent.dialogObj.hide();\n        }\n      }];\n      break;\n  }\n\n  return options;\n}\n\nfunction keydownAction(parent, dialogName, args) {\n  var btnElement = selectAll('.e-btn', parent.dialogObj.element);\n  preventKeydown(btnElement);\n  triggerPopupBeforeOpen(parent, parent.dialogObj, args, dialogName);\n}\n\nfunction beforeExtOpen(parent, dlgName, args) {\n  var btnElement = selectAll('.e-btn', parent.extDialogObj.element);\n  preventKeydown(btnElement);\n  triggerPopupBeforeOpen(parent, parent.extDialogObj, args, dlgName);\n}\n\nfunction preventKeydown(btnElement) {\n  var _loop_1 = function (btnCount) {\n    btnElement[btnCount].onkeydown = function (e) {\n      if (e.keyCode === 13) {\n        e.preventDefault();\n      }\n    };\n\n    btnElement[btnCount].onkeyup = function (e) {\n      if (e.keyCode === 13) {\n        btnElement[btnCount].click();\n      }\n    };\n  };\n\n  for (var btnCount = 0; btnCount < btnElement.length; btnCount++) {\n    _loop_1(btnCount);\n  }\n}\n/* istanbul ignore next */\n\n\nfunction getFilesName(data) {\n  var parent = createElement('div', {\n    id: 'uploadDialog'\n  });\n  var ulElement = createElement('ul');\n  var filesData = data.isModified ? data.modifiedFilesData : data.filesData;\n\n  for (var fileCount = 0; fileCount < filesData.length; fileCount++) {\n    var liElement = createElement('li', {\n      className: 'dialogFiles'\n    });\n    liElement.innerHTML = filesData[fileCount].name;\n    ulElement.appendChild(liElement);\n  }\n\n  parent.appendChild(ulElement);\n  var errorTag = createElement('div', {\n    className: 'e-fe-error'\n  });\n  parent.appendChild(errorTag);\n  return parent;\n}\n\nfunction changeOptions(parent, options) {\n  parent.dialogObj.header = options.header;\n  parent.dialogObj.content = options.content;\n  parent.dialogObj.buttons = options.buttons;\n  parent.dialogObj.enableRtl = parent.enableRtl;\n  parent.dialogObj.open = options.open;\n  parent.dialogObj.close = options.close;\n  parent.dialogObj.beforeOpen = keydownAction.bind(this, parent, options.dialogName);\n\n  parent.dialogObj.beforeClose = function (args) {\n    triggerPopupBeforeClose(parent, parent.dialogObj, args, options.dialogName);\n  };\n\n  parent.dialogObj.dataBind();\n  parent.dialogObj.show();\n}\n\nfunction onSubmit(parent) {\n  var ele = select('#newname', parent.dialogObj.element);\n  onSubmitValidate(parent, ele);\n\n  if (ele.parentElement.nextElementSibling.innerHTML !== '') {\n    return;\n  }\n\n  createFolder(parent, ele.value);\n}\n/* istanbul ignore next */\n\n\nfunction onReSubmit(parent) {\n  var ele = select('#rename', parent.dialogObj.element);\n  onSubmitValidate(parent, ele);\n\n  if (ele.parentElement.nextElementSibling.innerHTML !== '') {\n    return;\n  }\n\n  var text = ele.value;\n  var oIndex = parent.currentItemText.lastIndexOf('.');\n\n  if (parent.isFile && !parent.showFileExtension) {\n    var extn = oIndex === -1 ? '' : parent.currentItemText.substr(oIndex);\n    text += extn;\n  }\n\n  parent.renameText = text;\n\n  if (parent.currentItemText === text) {\n    parent.dialogObj.hide();\n    return;\n  }\n\n  var newPath = parent.activeModule === 'navigationpane' ? getParentPath(parent.path) : parent.path;\n  parent.renamedId = getValue('id', parent.itemData[0]);\n\n  if (parent.isFile) {\n    var oldExtension = oIndex === -1 ? '' : parent.currentItemText.substr(oIndex);\n    var nIndex = text.lastIndexOf('.');\n    var newExtension = nIndex === -1 ? '' : text.substr(nIndex);\n\n    if (parent.showFileExtension && oldExtension !== newExtension) {\n      createExtDialog(parent, 'Extension', null, newPath);\n    } else {\n      rename(parent, newPath, text);\n    }\n  } else {\n    rename(parent, newPath, text);\n  }\n}\n\nfunction onDeleteSubmit(parent) {\n  parent.dialogObj.hide();\n  parent.notify(events.deleteInit, {});\n}\n\nfunction onValidate(parent, ele) {\n  if (/[/\\\\|*?\"<>:]/.test(ele.value)) {\n    addInvalid(parent, ele);\n  } else if (ele.value === '') {\n    ele.parentElement.nextElementSibling.innerHTML = getLocaleText(parent, 'Validation-Empty');\n  } else {\n    ele.parentElement.nextElementSibling.innerHTML = '';\n  }\n}\n\nfunction onSubmitValidate(parent, ele) {\n  onValidate(parent, ele);\n  var len = ele.value.length - 1;\n\n  if (ele.value !== '' && (ele.value.lastIndexOf('.') === len || ele.value.lastIndexOf(' ') === len) && (parent.showFileExtension || parent.currentItemText.lastIndexOf('.') === -1)) {\n    addInvalid(parent, ele);\n  }\n}\n\nfunction addInvalid(parent, ele) {\n  var error = getLocaleText(parent, 'Validation-Invalid').replace('{0}', '\"' + ele.value + '\"');\n  ele.parentElement.nextElementSibling.innerHTML = error;\n}\n\nfunction getKeyCode(e) {\n  var code;\n\n  if (e.keyCode) {\n    code = e.keyCode;\n  } else if (e.which) {\n    code = e.which;\n  } else {\n    code = e.charCode;\n  }\n\n  return code;\n}\n\nexport function createImageDialog(parent, header, imageUrl) {\n  var content = createElement('div', {\n    className: 'e-image-wrap'\n  });\n  var image = createElement('img', {\n    className: 'e-image',\n    attrs: {\n      src: imageUrl,\n      alt: header\n    }\n  });\n  content.appendChild(image);\n\n  if (isNOU(parent.viewerObj)) {\n    parent.viewerObj = new Dialog({\n      header: header,\n      content: content,\n      animationSettings: {\n        effect: 'None'\n      },\n      showCloseIcon: true,\n      closeOnEscape: true,\n      visible: true,\n      isModal: true,\n      width: '350px',\n      height: '350px',\n      target: parent.popupTarget ? parent.popupTarget : '#' + parent.element.id,\n      cssClass: getCssClass(parent, parent.isMobile ? CLS.MOB_POPUP : CLS.ROOT_POPUP),\n      locale: parent.locale,\n      enableResize: true,\n      allowDragging: true,\n      enableHtmlSanitizer: parent.enableHtmlSanitizer,\n      position: {\n        X: 'center',\n        Y: 'center'\n      },\n      enableRtl: parent.enableRtl,\n      open: openImage.bind(this, parent),\n      close: function () {\n        triggerPopupClose(parent, parent.viewerObj, 'Image Preview');\n      },\n      beforeOpen: function (args) {\n        triggerPopupBeforeOpen(parent, parent.viewerObj, args, 'Image Preview');\n      },\n      beforeClose: function (args) {\n        triggerPopupBeforeClose(parent, parent.viewerObj, args, 'Image Preview');\n      },\n      resizing: updateImage.bind(this, parent),\n      resizeStop: updateImage.bind(this, parent)\n    });\n    parent.viewerObj.isStringTemplate = true;\n    parent.viewerObj.appendTo('#' + parent.element.id + CLS.IMG_DIALOG_ID);\n  } else {\n    parent.viewerObj.refresh();\n    parent.viewerObj.header = header;\n    parent.viewerObj.content = content;\n    parent.viewerObj.enableRtl = parent.enableRtl;\n    parent.viewerObj.dataBind();\n    parent.viewerObj.show();\n  }\n}\n\nfunction openImage(parent) {\n  setTimeout(function () {\n    if (parent.viewerObj) {\n      parent.viewerObj.element.focus();\n    }\n  });\n  updateImage(parent);\n  triggerPopupOpen(parent, parent.viewerObj, 'Image Preview');\n}\n\nfunction updateImage(parent) {\n  var content = select('.e-dlg-content', parent.viewerObj.element);\n  var imgWrap = select('.e-image-wrap', parent.viewerObj.element);\n  var cssObj = window.getComputedStyle(content, null);\n  var paddingWidth = cssObj ? 2 * parseFloat(cssObj.paddingRight) : 36;\n  var paddingHeight = cssObj ? 2 * parseFloat(cssObj.paddingBottom) : 20;\n  imgWrap.style.width = content.offsetWidth - paddingWidth + 'px';\n  imgWrap.style.height = content.offsetHeight - paddingHeight + 'px';\n}","map":null,"metadata":{},"sourceType":"module"}